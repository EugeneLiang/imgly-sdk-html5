(function webpackUniversalModuleDefinition(a,b){if(typeof exports==="object"&&typeof module==="object"){module.exports=b(require("canvas"))}else{if(typeof define==="function"&&define.amd){define(["canvas"],b)}else{if(typeof exports==="object"){exports.ImglyKit=b(require("canvas"))}else{a.ImglyKit=b(a.canvas)}}}})(this,function(a){return(function(b){var c={};function d(f){if(c[f]){return c[f].exports}var e=c[f]={exports:{},id:f,loaded:false};b[f].call(e.exports,e,e.exports,d);e.loaded=true;return e.exports}d.m=b;d.c=c;d.p="";return d(0)})([function(e,w,f){
/*!
	 * Photo Editor SDK - photoeditorsdk.com
	 * Copyright (c) 2013-2015 9elements GmbH
	 *
	 * Released under Attribution-NonCommercial 3.0 Unported
	 * http://creativecommons.org/licenses/by-nc/3.0/
	 *
	 * For commercial use, please contact us at contact@9elements.com
	 */
"use strict";Object.defineProperty(w,"__esModule",{value:true});var p=(function(){function y(C,A){for(var z=0;z<A.length;z++){var B=A[z];B.enumerable=B.enumerable||false;B.configurable=true;if("value" in B){B.writable=true}Object.defineProperty(C,B.key,B)}}return function(B,z,A){if(z){y(B.prototype,z)}if(A){y(B,A)}return B}})();function d(y){return y&&y.__esModule?y:{"default":y}}function h(y,z){if(!(y instanceof z)){throw new TypeError("Cannot call a class as a function")}}var j=f(1);var c=d(j);var l=f(2);var m=d(l);var n=f(3);var g=d(n);var r=f(4);var u=f(5);var o=d(u);var k=f(6);var x=d(k);var i=f(7);var t=d(i);var b=f(8);var s=d(b);var q="2.0.0-8";var v=(function(){function B(M){h(this,B);if(typeof M==="undefined"){throw new Error("No options given.")}M=o["default"].defaults(M,{assetsUrl:"assets",container:null,renderOnWindowResize:false,versionCheck:true});M.ui=M.ui||{};M.ui=o["default"].defaults(M.ui,{enabled:true});if(typeof M.image==="undefined"&&!M.ui.enabled){throw new Error("`options.image` needs to be set when UI is disabled.")}this._options=M;this.operationsStack=[];this._registeredUIs={};this._registerUIs();this._registeredOperations={};this._registerOperations();if(typeof window!=="undefined"&&this._options.versionCheck){this._versionChecker=new g["default"](q)}if(this._options.ui.enabled){this._initUI();if(this._options.renderOnWindowResize){this._handleWindowResize()}}if(this._options.image){this._parseExif(this._options.image)}}p(B,[{key:"render",value:function y(N,R,M,U){var T=this;var P=m["default"].validateSettings(N,R);N=P.renderType;R=P.imageFormat;var O=new c["default"](this._options.image,this.operationsStack,M,this._options.renderer);for(var S=0;S<this.operationsStack.length;S++){var Q=this.operationsStack[S];if(!Q){continue}Q.dirty=true}return O.render().then(function(){var V=O.getRenderer().getCanvas();return m["default"]["export"](T,T._options.image,V,N,R,U)})}},{key:"setImage",value:function H(M){this._options.image=M;this._parseExif(M)}},{key:"_parseExif",value:function F(Q){if(x["default"].isJPEG(Q.src)){this._exif=null;try{this._exif=x["default"].fromBase64String(Q.src)}catch(P){}if(!this._exif){return}var O=this._exif.getTags();if(O&&O.Orientation){if(O.Orientation!==1&&O.Orientation!==2){var R=0;switch(O.Orientation){case 7:case 8:R=-90;break;case 3:case 4:R=-180;break;case 5:case 6:R=90;break}var N=new t["default"](this,{degrees:R});this.operationsStack.push(N)}if([2,4,5,7].indexOf(O.Orientation)!==-1){var M=new s["default"](this,{horizontal:true});this.operationsStack.push(M)}this._exif.setOrientation(1)}}}},{key:"reset",value:function E(){}},{key:"getAssetPath",value:function D(N){var M=typeof window!=="undefined";if(M){return this._options.assetsUrl+"/"+N}else{var O=f(52);return O.resolve(this._options.assetsUrl,N)}}},{key:"_handleWindowResize",value:function C(){var M=this;var N=null;window.addEventListener("resize",function(){if(N!==null){clearTimeout(N)}N=setTimeout(function(){N=null;M.ui.render()},300)})}},{key:"_registerUIs",value:function K(){this.registerUI(B.NightUI)}},{key:"_registerOperations",value:function J(){for(var M in B.Operations){this.registerOperation(B.Operations[M])}}},{key:"registerOperation",value:function G(M){this._registeredOperations[M.prototype.identifier]=M;if(this.ui){this.ui.addOperation(M)}}},{key:"registerUI",value:function L(M){this._registeredUIs[M.prototype.identifier]=M}},{key:"_initUI",value:function z(){var M;if(this._options.ui.enabled===true){M=o["default"].values(this._registeredUIs)[0]}if(!M){return}this.ui=new M(this,this._options)}},{key:"getOperationFromStack",value:function I(N){var M=this.operationsStack.filter(function(O){return O.identifier===N})[0];return M}},{key:"run",value:function A(){if(typeof this.ui!=="undefined"){this.ui.run()}}},{key:"exif",get:function(){return this._exif}},{key:"registeredOperations",get:function(){return this._registeredOperations}}]);return B})();v.version=q;v.RenderImage=c["default"];v.Color=f(9);v.Filter=f(10);v.Operation=f(11);v.Operations={};v.Operations.Filters=f(12);v.Operations.Crop=f(13);v.Operations.Rotation=f(7);v.Operations.Saturation=f(14);v.Operations.Contrast=f(15);v.Operations.Brightness=f(16);v.Operations.Flip=f(8);v.Operations.TiltShift=f(17);v.Operations.RadialBlur=f(18);v.Operations.Text=f(19);v.Operations.Stickers=f(20);v.Operations.Frames=f(21);v.Filters={};v.Filters.A15=f(22);v.Filters.Breeze=f(23);v.Filters.BW=f(24);v.Filters.BWHard=f(25);v.Filters.Celsius=f(26);v.Filters.Chest=f(27);v.Filters.Fixie=f(28);v.Filters.Food=f(29);v.Filters.Fridge=f(30);v.Filters.Front=f(31);v.Filters.Glam=f(32);v.Filters.Gobblin=f(33);v.Filters.K1=f(34);v.Filters.K2=f(35);v.Filters.K6=f(36);v.Filters.KDynamic=f(37);v.Filters.Lenin=f(38);v.Filters.Lomo=f(39);v.Filters.Mellow=f(40);v.Filters.Morning=f(41);v.Filters.Orchid=f(42);v.Filters.Pola=f(43);v.Filters.Pola669=f(44);v.Filters.Quozi=f(45);v.Filters.Semired=f(46);v.Filters.Sunny=f(47);v.Filters.Texas=f(48);v.Filters.X400=f(49);v.RenderType=r.RenderType;v.ImageFormat=r.ImageFormat;v.Vector2=f(50);v.NightUI=f(51);w["default"]=v;e.exports=w["default"]},function(f,k,e){Object.defineProperty(k,"__esModule",{value:true});var i=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();function p(q){return q&&q.__esModule?q:{"default":q}}function l(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}var g=e(54);var m=p(g);var c=e(50);var o=p(c);var b=e(55);var j=p(b);var d=e(56);var h=p(d);var n=(function(){function s(x,v,u,w){l(this,s);this._options={preferredRenderer:w};this._webglEnabled=false;this._renderer=null;this._image=x;this._stack=v;this._dimensions=new m["default"](u);this._initialDimensions=new o["default"](this._image.width,this._image.height);this._initRenderer()}i(s,[{key:"_initRenderer",value:function q(){if(h["default"].isSupported()&&this._options.preferredRenderer!=="canvas"){this._renderer=new h["default"](this._initialDimensions);this._webglEnabled=true}else{if(j["default"].isSupported()){this._renderer=new j["default"](this._initialDimensions);this._webglEnabled=false}}if(this._renderer===null){throw new Error("Neither Canvas nor WebGL renderer are supported.")}this._renderer.drawImage(this._image)}},{key:"render",value:function t(){var y=this;var u=this.sanitizedStack;var x=[];for(var w=0;w<u.length;w++){var v=u[w];x.push(v.validateSettings())}return Promise.all(x).then(function(){var B=[];for(var A=0;A<u.length;A++){var z=u[A];B.push(z.render(y._renderer))}return Promise.all(B)}).then(function(){return y._renderer.renderFinal()}).then(function(){var A=y._renderer.getSize();var z=y._dimensions.calculateFinalDimensions(A);if(z.equals(A)){return}return y._renderer.resizeTo(z)})}},{key:"getRenderer",value:function r(){return this._renderer}},{key:"sanitizedStack",get:function(){var w=[];for(var v=0;v<this._stack.length;v++){var u=this._stack[v];if(!u){continue}w.push(u)}return w}}]);return s})();k["default"]=n;f.exports=k["default"]},function(c,b,d){(function(e){Object.defineProperty(b,"__esModule",{value:true});var j=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();function o(q){return q&&q.__esModule?q:{"default":q}}function l(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}var f=d(4);var p=d(5);var g=o(p);var n=d(57);var h=o(n);var m=d(6);var i=o(m);var k=(function(){function s(){l(this,s)}j(s,null,[{key:"validateSettings",value:function r(u,v){var t={renderType:u,imageFormat:v};if(typeof t.renderType!=="undefined"&&t.renderType!==null&&g["default"].values(f.RenderType).indexOf(t.renderType)===-1){throw new Error("Invalid render type: "+t.renderType)}else{if(typeof u==="undefined"){t.renderType=f.RenderType.DATAURL}}if(typeof t.imageFormat!=="undefined"&&t.imageFormat!==null&&g["default"].values(f.ImageFormat).indexOf(t.imageFormat)===-1){throw new Error("Invalid image format: "+t.imageFormat)}else{if(typeof v==="undefined"){t.imageFormat=f.ImageFormat.PNG}}if(t.renderType===f.RenderType.BUFFER&&typeof e==="undefined"){throw new Error("Render type 'buffer' is only available when using node.js")}return t}},{key:"export",value:function q(v,x,t,u,w){var y=arguments[5]===undefined?0.8:arguments[5];return new h["default"](function(E,D){var z=undefined;if(u===f.RenderType.IMAGE||u===f.RenderType.DATAURL){if(typeof window==="undefined"){z=t.toDataURL(w)}else{z=t.toDataURL(w,y)}if(i["default"].isJPEG(x.src)&&i["default"].isJPEG(z)){var C=v.exif;if(C){z=C.restoreExifTags(z)}}}if(u===f.RenderType.IMAGE){var A=undefined;if(typeof window==="undefined"){var B=d(53).Image;A=new B()}else{A=new Image()}A.src=z;E(A)}else{if(u===f.RenderType.DATAURL){E(z)}else{if(u===f.RenderType.BUFFER){E(t.toBuffer())}else{if(u===f.RenderType.MSBLOB){E(t.msToBlob())}else{if(u===f.RenderType.BLOB){t.toBlob(function(F){E(F)},w,y)}}}}}})}}]);return s})();b["default"]=k;c.exports=b["default"]}.call(b,d(76)))},function(e,b,h){Object.defineProperty(b,"__esModule",{value:true});var d=(function(){function j(n,l){for(var k=0;k<l.length;k++){var m=l[k];m.enumerable=m.enumerable||false;m.configurable=true;if("value" in m){m.writable=true}Object.defineProperty(n,m.key,m)}}return function(m,k,l){if(k){j(m.prototype,k)}if(l){j(m,l)}return m}})();function g(j,k){if(!(j instanceof k)){throw new TypeError("Cannot call a class as a function")}}var c="imglySDKVersionCallback";var i="http://sdk.img.ly/version.json?sdk=html5&jsoncallback="+c;var f=(function(){function k(l){g(this,k);this._version=l;this._check()}d(k,[{key:"_check",value:function j(){var m=this;window[c]=function(n){if(n.outdated){console.warn("imgly-sdk-html5: Your version "+m._version+" is outdated.");console.warn("imgly-sdk-html5: Current version is "+n.version+".")}};var l=document.createElement("script");l.src=i+"&version="+this._version;l.async=true;document.getElementsByTagName("head")[0].appendChild(l)}}]);return k})();b["default"]=f;e.exports=b["default"]},function(e,d,f){Object.defineProperty(d,"__esModule",{value:true});var c={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"};d.RenderType=c;var b={PNG:"image/png",JPEG:"image/jpeg"};d.ImageFormat=b},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function k(o,m){for(var l=0;l<m.length;l++){var n=m[l];n.enumerable=n.enumerable||false;n.configurable=true;if("value" in n){n.writable=true}Object.defineProperty(o,n.key,n)}}return function(n,l,m){if(l){k(n.prototype,l)}if(m){k(n,m)}return n}})();function j(k){return k&&k.__esModule?k:{"default":k}}function g(k,l){if(!(k instanceof l)){throw new TypeError("Cannot call a class as a function")}}var b=c(50);var i=j(b);var h=(function(){function p(){g(this,p)}e(p,null,[{key:"isArray",value:function n(u){return Object.prototype.toString.call(u)==="[object Array]"}},{key:"select",value:function s(v){var u=arguments[1]===undefined?null:arguments[1];if(u===null){return v}if(typeof u==="string"){u=u.split(",").map(function(w){return w.trim()})}if(p.isArray(u)){u={only:u}}if(typeof u.only!=="undefined"){if(typeof u.only==="string"){u.only=u.only.split(",").map(function(w){return w.trim()})}return v.filter(function(w){return u.only.indexOf(w)!==-1})}else{if(typeof u.except!=="undefined"){if(typeof u.except==="string"){u.except=u.except.split(",").map(function(w){return w.trim()})}return v.filter(function(w){return u.except.indexOf(w)===-1})}}throw new Error("Utils#select failed to filter items.")}},{key:"values",value:function t(v){var u=[];for(var w in v){u.push(v[w])}return u}},{key:"isDOMElement",value:function l(u){return typeof HTMLElement==="object"?u instanceof HTMLElement:u&&typeof u==="object"&&u!==null&&u.nodeType===1&&typeof u.nodeName==="string"}},{key:"getEventPosition",value:function r(v){var u=v.pageX;var w=v.pageY;if(v.type.indexOf("touch")!==-1){u=v.touches[0].pageX;w=v.touches[0].pageY}return new i["default"](u,w)}},{key:"resizeVectorToFit",value:function o(v,u){var x=Math.min(u.x/v.x,u.y/v.y);var w=v.clone().multiply(x);return w}},{key:"defaults",value:function m(w){for(var u=arguments.length,v=Array(u>1?u-1:0),A=1;A<u;A++){v[A-1]=arguments[A]}var z={};for(var y in w){z[y]=w[y]}for(var x=0;x<v.length;x++){var B=v[x];for(var y in B){if(typeof z[y]==="undefined"){z[y]=B[y]}}}return z}},{key:"extend",value:function q(x){for(var u=arguments.length,w=Array(u>1?u-1:0),v=1;v<u;v++){w[v-1]=arguments[v]}var A={};for(var z in x){A[z]=x[z]}for(var y=0;y<w.length;y++){var B=w[y];for(var z in B){A[z]=B[z]}}return A}},{key:"fetch",value:function k(v,z,u){z=z.replace(/\[(\w+)\]/g,".$1");z=z.replace(/^\./,"");var y=z.split(".");for(var w=0;w<y.length;w++){var x=y[w];v=v[x];if(!v){break}}if(typeof v==="undefined"){v=u}return v}}]);return p})();f["default"]=h;d.exports=f["default"]},function(e,h,d){
/*!
	 * Based on https://github.com/exif-js/exif-js by Jacob Seidelin
	 * Licensed under MIT
	 */
"use strict";Object.defineProperty(h,"__esModule",{value:true});var g=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();function p(q){return q&&q.__esModule?q:{"default":q}}function n(u,t){if(Array.isArray(u)){return u}else{if(Symbol.iterator in Object(u)){var x=[];var q=true;var w=false;var v=undefined;try{for(var s=u[Symbol.iterator](),y;!(q=(y=s.next()).done);q=true){x.push(y.value);if(t&&x.length===t){break}}}catch(r){w=true;v=r}finally{try{if(!q&&s["return"]){s["return"]()}}finally{if(w){throw v}}}return x}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}function i(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}var b=d(72);var m=p(b);var f=d(73);var j=p(f);var l={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};var o="data:image/jpeg;base64,";var k=new RegExp("^"+o,"i");var c=(function(){function r(B){i(this,r);this._buf=B;this._stream=new j["default"](this._buf);this._stream.setHead(0);this._segments=this._sliceIntoSegments(this._buf);this._exifBuffer=this._getExifBuffer();this._exifStream=new j["default"](this._exifBuffer);this._parseExif()}g(r,[{key:"getTags",value:function A(){return this._tags}},{key:"getTagData",value:function u(){return this._tagData}},{key:"restoreExifTags",value:function q(F){var I=F.replace(o,"");var E=m["default"].decode(I);var G=this._sliceIntoSegments(E);var D=n(G[1],2);var J=D[0];var B=D[1];var H=E.slice(0,J);var C=E.slice(J);var K=H.concat(this._exifBuffer);K=K.concat(C);return o+m["default"].encode(K)}},{key:"setOrientation",value:function z(B){if(this._tagData.Orientation){var C=this._tagData.Orientation.entryOffset;this._exifStream.setHead(C+8);this._exifStream.writeInt16(B)}}},{key:"_parseExif",value:function w(){this._exifStream.setHead(0);this._exifStream.readInt16();this._exifStream.readInt16();var H=this._exifStream.readString(4);if(H!=="Exif"){return}this._exifStream.readInt16();var F=this._exifStream.getHead();var G=false;var B=this._exifStream.readInt16();if(B===18761){G=false}else{if(B===19789){G=true}else{throw new Error("Invalid TIFF data: No endian type found")}}if(this._exifStream.readInt16(!G)!==42){throw new Error("Invalid TIFF data: No 0x002A")}var C=this._exifStream.readInt32(!G);if(C<8){throw new Error("Invalid TIFF data: First IFD offset < 8")}var E=F+C;var D=this._readTags(this._exifStream,F,E,G);this._tags=D.tags;this._tagData=D.tagData}},{key:"_readTags",value:function x(K,C,O,Q){K.setHead(O);var M=K.readInt16(!Q);var N={};var E=[];for(var R=0;R<M;R++){var D=O+R*12+2;K.setHead(D);var V=K.readInt16(!Q);var H=undefined;var L=undefined;var S=undefined;if(l[V]){V=l[V];H=K.readInt16(!Q);L=K.readInt32(!Q);S=K.readInt32(!Q)+C;var P=null;switch(H){case 1:case 7:if(L===1){P=K.readInt8(!Q)}else{P=[];for(var J=0;J<L;J++){P.push(K.readInt8(!Q))}}break;case 2:K.setHead(L>4?S:D+8);P=K.readString(L);break;case 3:K.setHead(L>2?S:D+8);if(L===1){P=K.readInt16(!Q)}else{P=[];for(var I=0;I<L;I++){P.push(K.readInt16(!Q))}}break;case 4:case 9:K.setHead(L>1?S:D+8);if(L===1){P=K.readInt32(!Q)}else{P=[];for(var G=0;G<L;G++){P.push(K.readInt32(!Q))}}break;case 5:case 10:K.setHead(S);if(L===1){var T=K.readInt32(!Q);var B=K.readInt32(!Q);P=T/B}else{P=[];for(var F=0;F<L;F++){var T=K.readInt32(!Q);var B=K.readInt32(!Q);var U=T/B;P.push(U)}}break}N[V]=P;E[V]={value:P,numValues:L,entryOffset:D,valueOffset:S,type:H}}}return{tags:N,tagData:E}}},{key:"_getExifBuffer",value:function v(){var E=this._segments;for(var F=0;F<E.length;F++){var B=n(E[F],2);var G=B[0];var D=B[1];this._stream.setHead(G);var C=this._stream.peekInt16();if(C===65505){return this._buf.slice(G,D)}}return false}},{key:"_sliceIntoSegments",value:function y(E){var F=new j["default"](E);var D=[];while(F.getHead()<E.length){var C=F.readInt16();if(C===65496){continue}if(C===65498){break}if(C>=65280&&C<=65535){var G=F.readInt16();var B=F.getHead()+G-2;D.push([F.getHead()-4,B]);F.setHead(B)}else{throw new Error("Invalid marker: 0x"+C.toString(16))}}this._stream.setHead(0);return D}}],[{key:"isJPEG",value:function t(B){return k.test(B)}},{key:"fromBase64String",value:function s(D){var B=D.replace(o,"");var C=m["default"].decode(B);return new r(C)}}]);return r})();h["default"]=c;e.exports=h["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();var j=function d(x,w,v){var t=true;_function:while(t){var r=x,z=w,q=v;s=y=u=undefined;t=false;var s=Object.getOwnPropertyDescriptor(r,z);if(s===undefined){var y=Object.getPrototypeOf(r);if(y===null){return undefined}else{x=y;w=z;v=q;t=true;continue _function}}else{if("value" in s){return s.value}else{var u=s.get;if(u===undefined){return undefined}return u.call(q)}}}};function o(q){return q&&q.__esModule?q:{"default":q}}function i(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}function n(r,q){if(typeof q!=="function"&&q!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof q)}r.prototype=Object.create(q&&q.prototype,{constructor:{value:r,enumerable:false,writable:true,configurable:true}});if(q){r.__proto__=q}}var l=b(11);var m=o(l);var g=b(50);var k=o(g);var p=(function(t){function s(){for(var v=arguments.length,w=Array(v),x=0;x<v;x++){w[x]=arguments[x]}i(this,s);j(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,w);this.vertexShader="\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n      uniform mat3 u_matrix;\n\n      void main() {\n        gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1);\n        v_texCoord = a_texCoord;\n      }\n    "}n(s,t);f(s,[{key:"_renderWebGL",value:function q(A){var x=A.getCanvas();var v=this._options.degrees%360;if(v%180!==0){var w=this.getNewDimensions(A);x.width=w.x;x.height=w.y}var B=v*(Math.PI/180);var C=Math.cos(B);var z=Math.sin(B);var y=[C,-z,0,z,C,0,0,0,1];A.runShader(this.vertexShader,null,{uniforms:{u_matrix:{type:"mat3fv",value:y}}})}},{key:"_renderCanvas",value:function r(A){var x=A.getCanvas();var v=this._options.degrees%360;var w=this.getNewDimensions(A);var y=A.createCanvas();y.width=w.x;y.height=w.y;var B=y.getContext("2d");B.save();B.translate(y.width/2,y.height/2);B.rotate(v*(Math.PI/180));var z=A.cloneCanvas();B.drawImage(z,-x.width/2,-x.height/2);B.restore();A.setCanvas(y)}},{key:"getNewDimensions",value:function u(z,y){var w=z.getCanvas();y=y||new k["default"](w.width,w.height);var v=this._options.degrees%360;if(v%180!==0){var x=y.x;y.x=y.y;y.y=x}return y}}]);return s})(m["default"]);p.prototype.identifier="rotation";p.prototype.availableOptions={degrees:{type:"number","default":0,validation:function e(q){if(q%90!==0){throw new Error("RotationOperation: `rotation` has to be a multiple of 90.")}}}};h["default"]=p;c.exports=h["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var i=b(11);var k=m(i);var j=(function(p){function q(){for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}g(this,q);h(Object.getPrototypeOf(q.prototype),"constructor",this).apply(this,s);this.fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n      uniform bool u_flipVertical;\n      uniform bool u_flipHorizontal;\n\n      void main() {\n        vec2 texCoord = vec2(v_texCoord);\n        if (u_flipVertical) {\n          texCoord.y = 1.0 - texCoord.y;\n        }\n        if (u_flipHorizontal) {\n          texCoord.x = 1.0 - texCoord.x;\n        }\n        gl_FragColor = texture2D(u_image, texCoord);\n      }\n    "}l(q,p);e(q,[{key:"_renderWebGL",value:function n(r){r.runShader(null,this.fragmentShader,{uniforms:{u_flipVertical:{type:"f",value:this._options.vertical},u_flipHorizontal:{type:"f",value:this._options.horizontal}}})}},{key:"_renderCanvas",value:function o(w){var t=w.getCanvas();var u=w.getContext();var s=1,r=1;var y=0,x=0;if(this._options.horizontal){s=-1;y=t.width}if(this._options.vertical){r=-1;x=t.height}u.save();u.translate(y,x);u.scale(s,r);var v=w.cloneCanvas();u.drawImage(v,0,0);u.restore()}}]);return q})(k["default"]);j.prototype.identifier="flip";j.prototype.availableOptions={horizontal:{type:"boolean","default":false},vertical:{type:"boolean","default":false}};f["default"]=j;c.exports=f["default"]},function(d,b,g){Object.defineProperty(b,"__esModule",{value:true});var c=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var e=(function(){function k(v,u,s,t){f(this,k);if(typeof t==="undefined"){t=1}this.r=v;this.g=u;this.b=s;this.a=t}c(k,[{key:"toRGBA",value:function m(){var r=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255),this.a];return"rgba("+r.join(",")+")"}},{key:"toHex",value:function o(){var r=[this._componentToHex(Math.round(this.r*255)),this._componentToHex(Math.round(this.g*255)),this._componentToHex(Math.round(this.b*255))];return"#"+r.join("")}},{key:"toGLColor",value:function j(){return[this.r,this.g,this.b,this.a]}},{key:"toRGBGLColor",value:function i(){return[this.r,this.g,this.b]}},{key:"toHSV",value:function q(){var r=Math.max(this.r,this.g,this.b);var u=Math.min(this.r,this.g,this.b);var x=undefined;var w=undefined;var t=r;var y=r-u;w=r===0?0:y/r;if(r===u){x=0}else{switch(r){case this.r:x=(this.g-this.b)/y+(this.g<this.b?6:0);break;case this.g:x=(this.b-this.r)/y+2;break;case this.b:x=(this.r-this.g)/y+4;break}x/=6}return[x,w,t]}},{key:"fromHSV",value:function n(z,F,D){var u=this.r;var A=this.g;var C=this.b;var y=Math.floor(z*6);var B=z*6-y;var x=D*(1-F);var w=D*(1-B*F);var E=D*(1-(1-B)*F);switch(y%6){case 0:u=D;A=E;C=x;break;case 1:u=w;A=D;C=x;break;case 2:u=x;A=D;C=E;break;case 3:u=x;A=w;C=D;break;case 4:u=E;A=x;C=D;break;case 5:u=D;A=x;C=w;break}this.r=u;this.g=A;this.b=C}},{key:"clone",value:function p(){return new k(this.r,this.g,this.b,this.a)}},{key:"_componentToHex",value:function h(r){var s=r.toString(16);return s.length===1?"0"+s:s}},{key:"toString",value:function l(){return"Color("+this.r+", "+this.g+", "+this.b+", "+this.a+")"}}]);return k})();b["default"]=e;d.exports=b["default"]},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function h(){f(this,h)}d(h,[{key:"render",value:function i(j){throw new Error("Filter#render is abstract and not implemented in inherited class.")}}],[{key:"identifier",get:function(){return null}}]);return h})();b.extend=g(58);b.PrimitivesStack=g(59);b.Primitives={};b.Primitives.Saturation=g(60);b.Primitives.LookupTable=g(61);b.Primitives.ToneCurve=g(62);b.Primitives.SoftColorOverlay=g(63);b.Primitives.Desaturation=g(64);b.Primitives.X400=g(65);b.Primitives.Grayscale=g(66);b.Primitives.Contrast=g(67);b.Primitives.Glow=g(68);b.Primitives.Gobblin=g(69);b.Primitives.Brightness=g(70);c["default"]=b;e.exports=c["default"]},function(d,w,g){Object.defineProperty(w,"__esModule",{value:true});var r=(function(){function x(B,z){for(var y=0;y<z.length;y++){var A=z[y];A.enumerable=A.enumerable||false;A.configurable=true;if("value" in A){A.writable=true}Object.defineProperty(B,A.key,A)}}return function(A,y,z){if(y){x(A.prototype,y)}if(z){x(A,z)}return A}})();var b=function u(E,D,A){var B=true;_function:while(B){var y=E,G=D,x=A;z=F=C=undefined;B=false;var z=Object.getOwnPropertyDescriptor(y,G);if(z===undefined){var F=Object.getPrototypeOf(y);if(F===null){return undefined}else{E=F;D=G;A=x;B=true;continue _function}}else{if("value" in z){return z.value}else{var C=z.get;if(C===undefined){return undefined}return C.call(x)}}}};function c(x){return x&&x.__esModule?x:{"default":x}}function j(x,y){if(!(x instanceof y)){throw new TypeError("Cannot call a class as a function")}}function o(y,x){if(typeof x!=="function"&&x!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof x)}y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,enumerable:false,writable:true,configurable:true}});if(x){y.__proto__=x}}var m=g(50);var e=c(m);var t=g(9);var h=c(t);var v=g(5);var q=c(v);var s=g(74);var k=c(s);var l=g(57);var f=c(l);var i=g(58);var p=c(i);var n=(function(x){function D(J,I){j(this,D);b(Object.getPrototypeOf(D.prototype),"constructor",this).call(this);this._kit=J;this.availableOptions=q["default"].extend(this.availableOptions||{},{numberFormat:{type:"string","default":"relative",available:["absolute","relative"]}});this._dirty=true;this._glslPrograms={};this._uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(M){var L=Math.random()*16|0;var K=M==="x"?L:L&3|8;return K.toString(16)});this._initOptions(I||{})}o(D,x);r(D,[{key:"validateSettings",value:function E(){var J=this;var I=this.identifier;return new f["default"](function(N,M){for(var L in J.availableOptions){var K=J.availableOptions[L];if(K.required&&typeof J._options[L]==="undefined"){return M(new Error("Operation `"+I+"`: Option `"+L+"` is required."))}}N()})}},{key:"render",value:function z(J){var I=undefined;if(J.identifier==="webgl"){I=this._renderWebGL.bind(this)}else{I=this._renderCanvas.bind(this)}if(this._dirty){I(J);J.cache(this._uuid);this._dirty=false}else{J.drawCached(this._uuid)}}},{key:"_renderWebGL",value:function B(){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}},{key:"_renderCanvas",value:function y(){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}},{key:"_initOptions",value:function G(N){this._options={};var J,L,M;var I=this;for(J in this.availableOptions){M=J.charAt(0).toUpperCase()+J.slice(1);L=this.availableOptions[J];var K=function K(O,P){I["set"+M]=function(Q){I._setOption(O,Q)};I["get"+M]=function(){return I._getOption(O)}};K(J,L);if(typeof L["default"]!=="undefined"){this["set"+M](L["default"])}}for(J in N){if(typeof this.availableOptions[J]==="undefined"){throw new Error("Invalid option: "+J)}M=J.charAt(0).toUpperCase()+J.slice(1);this["set"+M](N[J])}}},{key:"set",value:function F(I){for(var J in I){this._setOption(J,I[J],false)}this.emit("update")}},{key:"_getOption",value:function H(I){return this._options[I]}},{key:"_setOption",value:function A(K,M){var N=arguments[2]===undefined?true:arguments[2];var I=this.availableOptions[K];var J=this.identifier;if(typeof I.setter!=="undefined"){M=I.setter.call(this,M)}if(typeof I.validation!=="undefined"){I.validation(M)}switch(I.type){case"string":if(typeof M!=="string"){throw new Error("Operation `"+J+"`: Option `"+K+"` has to be a string.")}var L=I.available;if(typeof L!=="undefined"&&L.indexOf(M)===-1){throw new Error("Operation `"+J+"`: Invalid value for `"+K+"` (valid values are: "+I.available.join(", ")+")")}this._options[K]=M;break;case"number":if(typeof M!=="number"){throw new Error("Operation `"+J+"`: Option `"+K+"` has to be a number.")}this._options[K]=M;break;case"boolean":if(typeof M!=="boolean"){throw new Error("Operation `"+J+"`: Option `"+K+"` has to be a boolean.")}this._options[K]=M;break;case"vector2":if(!(M instanceof e["default"])){throw new Error("Operation `"+J+"`: Option `"+K+"` has to be an instance of ImglyKit.Vector2.")}this._options[K]=M.clone();break;case"color":if(!(M instanceof h["default"])){throw new Error("Operation `"+J+"`: Option `"+K+"` has to be an instance of ImglyKit.Color.")}this._options[K]=M;break;case"object":this._options[K]=M;break}this._dirty=true;if(N){this.emit("update")}}},{key:"getNewDimensions",value:function C(K,J){var I=K.getCanvas();J=J||new e["default"](I.width,I.height);return J}},{key:"dirty",set:function(I){this._dirty=I},get:function(){return this._dirty}}]);return D})(k["default"]);n.prototype.identifier=null;n.extend=p["default"];w["default"]=n;d.exports=w["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var d=(function(){function o(s,q){for(var p=0;p<q.length;p++){var r=q[p];r.enumerable=r.enumerable||false;r.configurable=true;if("value" in r){r.writable=true}Object.defineProperty(s,r.key,r)}}return function(r,p,q){if(p){o(r.prototype,p)}if(q){o(r,q)}return r}})();function m(o){return o&&o.__esModule?o:{"default":o}}function g(o,p){if(!(o instanceof p)){throw new TypeError("Cannot call a class as a function")}}function l(p,o){if(typeof o!=="function"&&o!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof o)}p.prototype=Object.create(o&&o.prototype,{constructor:{value:p,enumerable:false,writable:true,configurable:true}});if(o){p.__proto__=o}}var h=b(11);var k=m(h);var n=b(71);var j=m(n);var i=(function(q){function r(){g(this,r);if(q!=null){q.apply(this,arguments)}}l(r,q);d(r,[{key:"_renderWebGL",value:function o(t){this._render(t)}},{key:"_renderCanvas",value:function p(t){this._render(t)}},{key:"_render",value:function s(t){this._selectedFilter.render(t)}}]);return r})(k["default"]);i.prototype.identifier="filters";i.prototype.availableOptions={filter:{type:"object","default":j["default"],setter:function e(o){this._selectedFilter=new o();return o}}};f["default"]=i;c.exports=f["default"]},function(d,h,c){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var j=function e(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var l=c(11);var m=o(l);var g=c(50);var k=o(g);var b=(function(r){function s(){for(var u=arguments.length,v=Array(u),w=0;w<u;w++){v[w]=arguments[w]}i(this,s);j(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,v);this.fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n      uniform vec2 u_cropStart;\n      uniform vec2 u_cropEnd;\n\n      void main() {\n        vec2 size = u_cropEnd - u_cropStart;\n        gl_FragColor = texture2D(u_image, v_texCoord * size + u_cropStart);\n      }\n    "}n(s,r);f(s,[{key:"_renderWebGL",value:function p(z){var x=z.getCanvas();var u=new k["default"](x.width,x.height);var A=this._options.start.clone();var v=this._options.end.clone();if(this._options.numberFormat==="absolute"){A.divide(u);v.divide(u)}var y=A.y;A.y=1-v.y;v.y=1-y;var w=this.getNewDimensions(z);x.width=w.x;x.height=w.y;z.runShader(null,this.fragmentShader,{uniforms:{u_cropStart:{type:"2f",value:[A.x,A.y]},u_cropEnd:{type:"2f",value:[v.x,v.y]}}})}},{key:"_renderCanvas",value:function q(z){var v=z.getCanvas();var y=new k["default"](v.width,v.height);var u=this.getNewDimensions(z);var w=z.createCanvas();w.width=u.x;w.height=u.y;var A=w.getContext("2d");var x=this._options.start.clone();if(this._options.numberFormat==="relative"){x.multiply(y)}A.drawImage(v,x.x,x.y,u.x,u.y,0,0,u.x,u.y);z.setCanvas(w)}},{key:"getNewDimensions",value:function t(x,w){var v=x.getCanvas();w=w||new k["default"](v.width,v.height);var u=this._options.end.clone().subtract(this._options.start);if(this._options.numberFormat==="relative"){u.multiply(w)}return u}}]);return s})(m["default"]);b.prototype.identifier="crop";b.prototype.availableOptions={start:{type:"vector2",required:true,"default":new k["default"](0,0)},end:{type:"vector2",required:true,"default":new k["default"](1,1)}};h["default"]=b;d.exports=h["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();function o(p){return p&&p.__esModule?p:{"default":p}}function g(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function k(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var i=c(11);var j=o(i);var h=c(59);var l=o(h);var n=c(60);var m=o(n);var b=(function(r){function t(){g(this,t);if(r!=null){r.apply(this,arguments)}}k(t,r);e(t,[{key:"_renderWebGL",value:function p(u){this._render(u)}},{key:"_renderCanvas",value:function q(u){this._render(u)}},{key:"_render",value:function s(u){if(!this._stack){this._stack=new l["default"]();this._primitive=new m["default"]({saturation:this._options.saturation});this._stack.add(this._primitive)}this._primitive.options.saturation=this._options.saturation;this._stack.render(u)}}]);return t})(j["default"]);b.prototype.identifier="saturation";b.prototype.availableOptions={saturation:{type:"number","default":1}};f["default"]=b;d.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();function n(p){return p&&p.__esModule?p:{"default":p}}function g(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var i=b(11);var k=n(i);var h=b(59);var m=n(h);var d=b(67);var j=n(d);var o=(function(s){function q(){g(this,q);if(s!=null){s.apply(this,arguments)}}l(q,s);e(q,[{key:"_renderWebGL",value:function p(u){this._render(u)}},{key:"_renderCanvas",value:function r(u){this._render(u)}},{key:"_render",value:function t(u){if(!this._stack){this._stack=new m["default"]();this._primitive=new j["default"]({contrast:this._options.contrast});this._stack.add(this._primitive)}this._primitive.options.contrast=this._options.contrast;this._stack.render(u)}}]);return q})(k["default"]);o.prototype.identifier="contrast";o.prototype.availableOptions={contrast:{type:"number","default":1}};f["default"]=o;c.exports=f["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();function n(p){return p&&p.__esModule?p:{"default":p}}function h(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var j=c(11);var k=n(j);var i=c(59);var m=n(i);var e=c(70);var b=n(e);var o=(function(r){function s(){h(this,s);if(r!=null){r.apply(this,arguments)}}l(s,r);f(s,[{key:"_renderWebGL",value:function p(u){this._render(u)}},{key:"_renderCanvas",value:function q(u){this._render(u)}},{key:"_render",value:function t(u){if(!this._stack){this._stack=new m["default"]();this._primitive=new b["default"]({brightness:this._options.brightness});this._stack.add(this._primitive)}this._primitive.options.brightness=this._options.brightness;this._stack.render(u)}}]);return s})(k["default"]);o.prototype.identifier="brightness";o.prototype.availableOptions={brightness:{type:"number","default":0}};g["default"]=o;d.exports=g["default"]},function(f,s,h){Object.defineProperty(s,"__esModule",{value:true});var p=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var o=function k(t,x,w,v){var y=Object.getOwnPropertyDescriptor(t,x);if(y===undefined){var u=Object.getPrototypeOf(t);if(u!==null){k(u,x,w,v)}}else{if("value" in y&&y.writable){y.value=w}else{var z=y.set;if(z!==undefined){z.call(v,w)}}}return w};var c=function q(A,z,y){var w=true;_function:while(w){var u=A,C=z,t=y;v=B=x=undefined;w=false;var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;y=t;w=true;continue _function}}else{if("value" in v){return v.value}else{var x=v.get;if(x===undefined){return undefined}return x.call(t)}}}};function d(t){return t&&t.__esModule?t:{"default":t}}function i(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function n(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){u.__proto__=t}}var j=h(11);var e=d(j);var l=h(50);var g=d(l);var r=h(75);var b=d(r);var m=(function(y){function x(){for(var A=arguments.length,B=Array(A),C=0;C<A;C++){B[C]=arguments[C]}i(this,x);c(Object.getPrototypeOf(x.prototype),"constructor",this).apply(this,B);this._fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      uniform float blurRadius;\n      uniform float gradientRadius;\n      uniform vec2 start;\n      uniform vec2 end;\n      uniform vec2 delta;\n      uniform vec2 texSize;\n      varying vec2 v_texCoord;\n\n      float random(vec3 scale, float seed) {\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n      }\n\n      void main() {\n          vec4 color = vec4(0.0);\n          float total = 0.0;\n\n          float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n          vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n          float radius = smoothstep(0.0, 1.0, abs(dot(v_texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;\n          for (float t = -30.0; t <= 30.0; t++) {\n              float percent = (t + offset - 0.5) / 30.0;\n              float weight = 1.0 - abs(percent);\n              vec4 sample = texture2D(u_image, v_texCoord + delta * percent * radius / texSize);\n\n              sample.rgb *= sample.a;\n\n              color += sample * weight;\n              total += weight;\n          }\n\n          gl_FragColor = color / total;\n          gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n      }\n    ";this._cachedBlurredCanvas=null;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}n(x,y);p(x,[{key:"_renderWebGL",value:function v(E){var D=E.getCanvas();var B=new g["default"](D.width,D.height);var H=this._options.start.clone();var C=this._options.end.clone();if(this._options.numberFormat==="relative"){H.multiply(B);C.multiply(B)}H.y=B.y-H.y;C.y=B.y-C.y;var G=C.clone().subtract(H);var F=Math.sqrt(G.x*G.x+G.y*G.y);var A={blurRadius:{type:"f",value:this._options.blurRadius},gradientRadius:{type:"f",value:this._options.gradientRadius},start:{type:"2f",value:[H.x,H.y]},end:{type:"2f",value:[C.x,C.y]},delta:{type:"2f",value:[G.x/F,G.y/F]},texSize:{type:"2f",value:[D.width,D.height]}};if(!this._glslPrograms[E.id]){this._glslPrograms[E.id]=E.setupGLSLProgram(null,this._fragmentShader)}E.runProgram(this._glslPrograms[E.id],{uniforms:A});A.delta.value=[-G.y/F,G.x/F];E.runProgram(this._glslPrograms[E.id],{uniforms:A})}},{key:"_renderCanvas",value:function w(E){var C=E.getCanvas();var A=this._options.blurRadius!==this._lastBlurRadius||this._options.gradientRadius!==this._lastGradientRadius;var B=undefined;if(A||this._cachedBlurredCanvas===null){B=this._blurCanvas(E);this._cachedBlurredCanvas=B;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}else{B=this._cachedBlurredCanvas}var D=this._createMask(E);this._applyMask(C,B,D)}},{key:"_blurCanvas",value:function z(D){var C=D.cloneCanvas();var B=C.getContext("2d");var A=B.getImageData(0,0,C.width,C.height);b["default"].stackBlurCanvasRGBA(A,0,0,C.width,C.height,this._options.blurRadius);B.putImageData(A,0,0);return C}},{key:"_createMask",value:function t(H){var B=H.getCanvas();var N=new g["default"](B.width,B.height);var C=this._options.gradientRadius;var E=H.createCanvas(B.width,B.height);var K=E.getContext("2d");var A=this._options.start.clone();var F=this._options.end.clone();if(this._options.numberFormat==="relative"){A.multiply(N);F.multiply(N)}var J=F.clone().subtract(A);var O=A.clone().add(J.clone().divide(2));var G=Math.sqrt(Math.pow(J.x,2)+Math.pow(J.y,2));var I=J.clone().divide(G);var M=O.clone().add(C*I.y,-C*I.x);var D=O.clone().add(-C*I.y,C*I.x);var L=K.createLinearGradient(M.x,M.y,D.x,D.y);L.addColorStop(0,"#000000");L.addColorStop(0.5,"#FFFFFF");L.addColorStop(1,"#000000");K.fillStyle=L;K.fillRect(0,0,B.width,B.height);return E}},{key:"_applyMask",value:function u(C,E,D){var H=C.getContext("2d");var I=E.getContext("2d");var J=D.getContext("2d");var K=H.getImageData(0,0,C.width,C.height);var A=K.data;var G=I.getImageData(0,0,C.width,C.height).data;var L=J.getImageData(0,0,C.width,C.height).data;for(var F=0;F<L.length;F++){var B=L[F]/255;A[F]=B*A[F]+(1-B)*G[F]}H.putImageData(K,0,0)}},{key:"dirty",set:function(A){o(Object.getPrototypeOf(x.prototype),"dirty",A,this);this._cachedBlurredCanvas=null},get:function(){return c(Object.getPrototypeOf(x.prototype),"dirty",this)}}]);return x})(e["default"]);m.prototype.identifier="tilt-shift";m.prototype.availableOptions={start:{type:"vector2","default":new g["default"](0,0.5)},end:{type:"vector2","default":new g["default"](1,0.5)},blurRadius:{type:"number","default":30},gradientRadius:{type:"number","default":50}};s["default"]=m;f.exports=s["default"]},function(f,s,h){Object.defineProperty(s,"__esModule",{value:true});var p=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var n=function k(t,x,w,v){var y=Object.getOwnPropertyDescriptor(t,x);if(y===undefined){var u=Object.getPrototypeOf(t);if(u!==null){k(u,x,w,v)}}else{if("value" in y&&y.writable){y.value=w}else{var z=y.set;if(z!==undefined){z.call(v,w)}}}return w};var c=function q(A,z,y){var w=true;_function:while(w){var u=A,C=z,t=y;v=B=x=undefined;w=false;var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;y=t;w=true;continue _function}}else{if("value" in v){return v.value}else{var x=v.get;if(x===undefined){return undefined}return x.call(t)}}}};function d(t){return t&&t.__esModule?t:{"default":t}}function i(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function m(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){u.__proto__=t}}var j=h(11);var e=d(j);var l=h(50);var g=d(l);var r=h(75);var b=d(r);var o=(function(x){function z(){for(var A=arguments.length,B=Array(A),C=0;C<A;C++){B[C]=arguments[C]}i(this,z);c(Object.getPrototypeOf(z.prototype),"constructor",this).apply(this,B);this._fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      uniform float blurRadius;\n      uniform float gradientRadius;\n      uniform vec2 position;\n      uniform vec2 delta;\n      uniform vec2 texSize;\n      varying vec2 v_texCoord;\n\n      float random(vec3 scale, float seed) {\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n      }\n\n      void main() {\n          vec4 color = vec4(0.0);\n          float total = 0.0;\n\n          float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n          float radius = smoothstep(0.0, 1.0, abs(distance(v_texCoord * texSize, position)) / (gradientRadius * 2.0)) * blurRadius;\n          for (float t = -30.0; t <= 30.0; t++) {\n              float percent = (t + offset - 0.5) / 30.0;\n              float weight = 1.0 - abs(percent);\n              vec4 sample = texture2D(u_image, v_texCoord + delta * percent * radius / texSize);\n\n              sample.rgb *= sample.a;\n\n              color += sample * weight;\n              total += weight;\n          }\n\n          gl_FragColor = color / total;\n          gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n      }\n    ";this._cachedBlurredCanvas=null;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}m(z,x);p(z,[{key:"_renderWebGL",value:function v(E){var D=E.getCanvas();var C=new g["default"](D.width,D.height);var B=this._options.position.clone();B.y=1-B.y;if(this._options.numberFormat==="relative"){B.multiply(C)}var A={blurRadius:{type:"f",value:this._options.blurRadius},gradientRadius:{type:"f",value:this._options.gradientRadius},position:{type:"2f",value:[B.x,B.y]},texSize:{type:"2f",value:[D.width,D.height]},delta:{type:"2f",value:[1,1]}};if(!this._glslPrograms[E.id]){this._glslPrograms[E.id]=E.setupGLSLProgram(null,this._fragmentShader)}E.runProgram(this._glslPrograms[E.id],{uniforms:A});A.delta.value=[-1,1];E.runProgram(this._glslPrograms[E.id],{uniforms:A})}},{key:"_renderCanvas",value:function w(D){var B=D.getCanvas();var E=this._options.blurRadius!==this._lastBlurRadius;var A=undefined;if(E||this._cachedBlurredCanvas===null){A=this._blurCanvas(D);this._cachedBlurredCanvas=A;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}else{A=this._cachedBlurredCanvas}var C=this._createMask(D);this._applyMask(B,A,C)}},{key:"_blurCanvas",value:function y(D){var C=D.cloneCanvas();var B=C.getContext("2d");var A=B.getImageData(0,0,C.width,C.height);b["default"].stackBlurCanvasRGBA(A,0,0,C.width,C.height,this._options.blurRadius);B.putImageData(A,0,0);return C}},{key:"_createMask",value:function t(G){var C=G.getCanvas();var B=new g["default"](C.width,C.height);var D=this._options.gradientRadius;var F=G.createCanvas(C.width,C.height);var E=F.getContext("2d");var A=this._options.position.clone();if(this._options.numberFormat==="relative"){A.multiply(B)}var H=E.createRadialGradient(A.x,A.y,0,A.x,A.y,D);H.addColorStop(0,"#FFFFFF");H.addColorStop(1,"#000000");E.fillStyle=H;E.fillRect(0,0,C.width,C.height);return F}},{key:"_applyMask",value:function u(C,E,D){var H=C.getContext("2d");var I=E.getContext("2d");var J=D.getContext("2d");var K=H.getImageData(0,0,C.width,C.height);var A=K.data;var F=I.getImageData(0,0,C.width,C.height).data;var M=J.getImageData(0,0,C.width,C.height).data;var G,B;for(var L=0;L<C.height;L++){for(var N=0;N<C.width;N++){G=(L*C.width+N)*4;B=M[G]/255;A[G]=B*A[G]+(1-B)*F[G];A[G+1]=B*A[G+1]+(1-B)*F[G+1];A[G+2]=B*A[G+2]+(1-B)*F[G+2]}}H.putImageData(K,0,0)}},{key:"dirty",set:function(A){n(Object.getPrototypeOf(z.prototype),"dirty",A,this);this._cachedBlurredCanvas=null},get:function(){return c(Object.getPrototypeOf(z.prototype),"dirty",this)}}]);return z})(e["default"]);o.prototype.identifier="radial-blur";o.prototype.availableOptions={position:{type:"vector2","default":new g["default"](0.5,0.5)},gradientRadius:{type:"number","default":50},blurRadius:{type:"number","default":20}};s["default"]=o;f.exports=s["default"]},function(d,h,c){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var j=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function i(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function p(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var m=c(11);var o=q(m);var g=c(50);var l=q(g);var n=c(9);var b=q(n);var k=(function(v){function u(){for(var z=arguments.length,A=Array(z),B=0;B<z;B++){A[B]=arguments[B]}i(this,u);j(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,A);this._textureIndex=1;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textImage;\n      uniform vec2 u_position;\n      uniform vec2 u_size;\n\n      void main() {\n        vec4 color0 = texture2D(u_image, v_texCoord);\n        vec2 relative = (v_texCoord - u_position) / u_size;\n\n        if (relative.x >= 0.0 && relative.x <= 1.0 &&\n          relative.y >= 0.0 && relative.y <= 1.0) {\n\n            vec4 color1 = texture2D(u_textImage, relative);\n\n            // GL_SOURCE_ALPHA, GL_ONE_MINUS_SOURCE_ALPHA\n            gl_FragColor = color1 + color0 * (1.0 - color1.a);\n\n        } else {\n\n          gl_FragColor = color0;\n\n        }\n      }\n    "}p(u,v);f(u,[{key:"_renderWebGL",value:function s(E){var B=this._renderTextCanvas(E);var C=E.getCanvas();var F=E.getContext();var A=this._options.position.clone();var z=new l["default"](C.width,C.height);var D=new l["default"](B.width,B.height).divide(z);if(this._options.numberFormat==="absolute"){A.divide(z)}A.y=1-A.y;A.y-=D.y;if(this._options.verticalAlignment==="center"){A.y+=D.y/2}else{if(this._options.verticalAlignment==="bottom"){A.y+=D.y}}if(this._options.alignment==="center"){A.x-=D.x/2}else{if(this._options.alignment==="right"){A.x-=D.x}}F.activeTexture(F.TEXTURE0+this._textureIndex);this._texture=F.createTexture();F.bindTexture(F.TEXTURE_2D,this._texture);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,F.LINEAR);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,F.LINEAR);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_S,F.CLAMP_TO_EDGE);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_T,F.CLAMP_TO_EDGE);F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);F.texImage2D(F.TEXTURE_2D,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,B);F.activeTexture(F.TEXTURE0);E.runShader(null,this._fragmentShader,{uniforms:{u_textImage:{type:"i",value:this._textureIndex},u_position:{type:"2f",value:[A.x,A.y]},u_size:{type:"2f",value:[D.x,D.y]}}})}},{key:"_renderCanvas",value:function t(D){var A=this._renderTextCanvas(D);var B=D.getCanvas();var C=D.getContext();var z=new l["default"](B.width,B.height);var E=this._options.position.clone();if(this._options.numberFormat==="relative"){E.multiply(z)}if(this._options.verticalAlignment==="center"){E.y-=A.height/2}else{if(this._options.verticalAlignment==="bottom"){E.y-=A.height}}if(this._options.alignment==="center"){E.x-=A.width/2}else{if(this._options.alignment==="right"){E.x-=A.width}}C.drawImage(A,E.x,E.y)}},{key:"_renderTextCanvas",value:function r(E){var K=undefined,D=undefined;var B=E.createCanvas();var z=B.getContext("2d");var H=E.getCanvas();var I=new l["default"](H.width,H.height);var G=this._options.maxWidth;var A=this._options.fontSize*I.y;var F=this._options.lineHeight*A;if(this._options.numberFormat==="relative"){G*=E.getCanvas().width}this._applyTextOptions(E,z);var C=new l["default"]();var J=this._options.text.split("\n");if(typeof G!=="undefined"){C.x=G;J=this._buildOutputLines(z,G)}else{for(D=0;D<J.length;D++){K=J[D];C.x=Math.max(C.x,z.measureText(K).width)}}C.y=F*J.length;B.width=C.x;B.height=C.y;z=B.getContext("2d");z.fillStyle=this._options.backgroundColor.toRGBA();z.fillRect(0,0,B.width,B.height);this._applyTextOptions(E,z);for(D=0;D<J.length;D++){K=J[D];this._drawText(z,K,F*D)}return B}},{key:"_applyTextOptions",value:function x(D,B){var A=D.getCanvas();var z=new l["default"](A.width,A.height);var C=this._options.fontSize*z.y;B.font=this._options.fontWeight+" "+C+"px "+this._options.fontFamily;B.textBaseline="top";B.textAlign=this._options.alignment;B.fillStyle=this._options.color.toRGBA()}},{key:"_buildOutputLines",value:function w(A,H){var B=this._options.text.split("\n");var J=[];var F=[];for(var D=0;D<B.length;D++){var E=B[D];var z=E.split("");if(z.length===0){J.push("")}for(var L=0;L<z.length;L++){var K=z[L];F.push(K);var G=F.join("");var C=A.measureText(G).width;if(C>H&&F.length===1){J.push(F[0]);F=[]}else{if(C>H){var I=F.pop();J.push(F.join(""));F=[];F=[I]}else{if(L===z.length-1){J.push(F.join(""));F=[]}}}}if(F.length){J.push(F.join(""));F=[]}}return J}},{key:"_drawText",value:function y(A,B,C){var z=A.canvas;if(this._options.alignment==="center"){A.fillText(B,z.width/2,C)}else{if(this._options.alignment==="left"){A.fillText(B,0,C)}else{if(this._options.alignment==="right"){A.fillText(B,z.width,C)}}}}}]);return u})(o["default"]);k.prototype.identifier="text";k.prototype.availableOptions={fontSize:{type:"number","default":0.1},lineHeight:{type:"number","default":1.1},fontFamily:{type:"string","default":"Times New Roman"},fontWeight:{type:"string","default":"normal"},alignment:{type:"string","default":"left",available:["left","center","right"]},verticalAlignment:{type:"string","default":"top",available:["top","center","bottom"]},color:{type:"color","default":new b["default"](1,1,1,1)},backgroundColor:{type:"color","default":new b["default"](0,0,0,0)},position:{type:"vector2","default":new l["default"](0,0)},text:{type:"string",required:true},maxWidth:{type:"number","default":1}};h["default"]=k;d.exports=h["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var j=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function i(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function p(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var l=b(11);var o=q(l);var g=b(50);var k=q(g);var n=b(57);var d=q(n);var m=(function(w){function v(){for(var z=arguments.length,A=Array(z),B=0;B<z;B++){A[B]=arguments[B]}i(this,v);j(Object.getPrototypeOf(v.prototype),"constructor",this).apply(this,A);this._textureIndex=1;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_stickerImage;\n      uniform vec2 u_position;\n      uniform vec2 u_size;\n\n      void main() {\n        vec4 color0 = texture2D(u_image, v_texCoord);\n        vec2 relative = (v_texCoord - u_position) / u_size;\n\n        if (relative.x >= 0.0 && relative.x <= 1.0 &&\n          relative.y >= 0.0 && relative.y <= 1.0) {\n\n            vec4 color1 = texture2D(u_stickerImage, relative);\n\n            // GL_SOURCE_ALPHA, GL_ONE_MINUS_SOURCE_ALPHA\n            gl_FragColor = color1 + color0 * (1.0 - color1.a);\n\n        } else {\n\n          gl_FragColor = color0;\n\n        }\n      }\n    ";this._loadedStickers={}}p(v,w);f(v,[{key:"render",value:function x(A){var z=this;return this._loadSticker().then(function(B){if(A.identifier==="webgl"){return z._renderWebGL(A,B)}else{return z._renderCanvas(A,B)}})}},{key:"_renderWebGL",value:function s(E,F){var B=E.getCanvas();var G=E.getContext();var A=this._options.position.clone();var z=new k["default"](B.width,B.height);if(this._options.numberFormat==="absolute"){A.divide(z)}var C=new k["default"](F.width,F.height);if(typeof this._options.size!=="undefined"){C.copy(this._options.size);if(this._options.numberFormat==="relative"){C.multiply(z)}var D=F.height/F.width;C.y=C.x*D}C.divide(z);A.y=1-A.y;A.y-=C.y;G.activeTexture(G.TEXTURE0+this._textureIndex);this._texture=G.createTexture();G.bindTexture(G.TEXTURE_2D,this._texture);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.LINEAR);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.LINEAR);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE);G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);G.texImage2D(G.TEXTURE_2D,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,F);G.activeTexture(G.TEXTURE0);E.runShader(null,this._fragmentShader,{uniforms:{u_stickerImage:{type:"i",value:this._textureIndex},u_position:{type:"2f",value:[A.x,A.y]},u_size:{type:"2f",value:[C.x,C.y]}}})}},{key:"_renderCanvas",value:function u(D,E){var A=D.getCanvas();var C=D.getContext();var z=new k["default"](A.width,A.height);var F=this._options.position.clone();if(this._options.numberFormat==="relative"){F.multiply(z)}var B=new k["default"](E.width,E.height);if(typeof this._options.size!=="undefined"){B.copy(this._options.size);if(this._options.numberFormat==="relative"){B.multiply(z)}}C.drawImage(E,0,0,E.width,E.height,F.x,F.y,B.x,B.y)}},{key:"_loadSticker",value:function t(){var z=typeof window!=="undefined";if(z){return this._loadImageBrowser(this._options.sticker)}else{return this._loadImageNode(this._options.sticker)}}},{key:"_loadImageBrowser",value:function y(A){var z=this;return new d["default"](function(C,B){if(z._loadedStickers[A]){return C(z._loadedStickers[A])}var D=new Image();D.addEventListener("load",function(){z._loadedStickers[A]=D;C(D)});D.addEventListener("error",function(){B(new Error("Could not load sticker: "+A))});D.src=z._kit.getAssetPath(A)})}},{key:"_loadImageNode",value:function r(E){var A=b(53);var z=b(52);var B=this;var D=new A.Image();var C=B._kit.getAssetPath(E);return new d["default"](function(G,F){z.readFile(C,function(I,H){if(I){return F(I)}D.src=H;G(D)})})}},{key:"stickers",get:function(){return this._stickers}}]);return v})(o["default"]);m.prototype.identifier="stickers";m.prototype.availableOptions={sticker:{type:"string"},position:{type:"vector2","default":new k["default"](0,0)},size:{type:"vector2","default":new k["default"](0,0)}};h["default"]=m;c.exports=h["default"]},function(e,h,d){Object.defineProperty(h,"__esModule",{value:true});var g=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var j=function f(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var k=d(11);var m=o(k);var l=d(9);var c=o(l);var b=(function(r){function s(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}i(this,s);j(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,u);this._textureIndex=1;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_frameImage;\n      uniform vec4 u_color;\n      uniform vec2 u_thickness;\n\n      void main() {\n        vec4 fragColor = texture2D(u_image, v_texCoord);\n        if (v_texCoord.x < u_thickness.x || v_texCoord.x > 1.0 - u_thickness.x ||\n          v_texCoord.y < u_thickness.y || v_texCoord.y > 1.0 - u_thickness.y) {\n            fragColor = mix(fragColor, u_color, u_color.a);\n          }\n\n        gl_FragColor = fragColor;\n      }\n    "}n(s,r);g(s,[{key:"_renderWebGL",value:function p(y){var w=y.getCanvas();var u=this._options.color;var x=this._options.thickness*w.height;var v=[x/w.width,x/w.height];var t={u_color:{type:"4f",value:u.toGLColor()},u_thickness:{type:"2f",value:v}};if(!this._glslPrograms[y.id]){this._glslPrograms[y.id]=y.setupGLSLProgram(null,this._fragmentShader)}y.runProgram(this._glslPrograms[y.id],{uniforms:t})}},{key:"_renderCanvas",value:function q(x){var u=x.getCanvas();var w=x.getContext();var t=this._options.color;var v=this._options.thickness*u.height;w.save();w.beginPath();w.lineWidth=v*2;w.strokeStyle=t.toRGBA();w.rect(0,0,u.width,u.height);w.stroke();w.restore()}}]);return s})(m["default"]);b.prototype.identifier="frames";b.prototype.availableOptions={color:{type:"color","default":new c["default"](0,0,0,1)},thickness:{type:"number","default":0.02}};h["default"]=b;e.exports=h["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var d=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Contrast({contrast:0.63}));o.add(new j["default"].Primitives.Brightness({brightness:0.12}));o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}}));o.render(p)}},{key:"name",get:function(){return"15"}}],[{key:"identifier",get:function(){return"a15"}}]);return l})(j["default"]);f["default"]=d;c.exports=f["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(10);var j=k(h);var b=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);e(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Desaturation({desaturation:0.5}));o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}}));o.render(p)}},{key:"name",get:function(){return"Breeze"}}],[{key:"identifier",get:function(){return"breeze"}}]);return m})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var g=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);d(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Grayscale());o.render(p)}},{key:"name",get:function(){return"B&W"}}],[{key:"identifier",get:function(){return"bw"}}]);return l})(j["default"]);e["default"]=g;c.exports=e["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(10);var j=k(h);var b=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Grayscale());o.add(new j["default"].Primitives.Contrast({contrast:1.5}));o.render(p)}},{key:"name",get:function(){return"1920"}}],[{key:"identifier",get:function(){return"bwhard"}}]);return l})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var d=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}}));o.render(p)}},{key:"name",get:function(){return"Celsius"}}],[{key:"identifier",get:function(){return"celsius"}}]);return l})(j["default"]);f["default"]=d;c.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var e=(function(m){function n(){g(this,n);if(m!=null){m.apply(this,arguments)}}i(n,m);d(n,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}}));o.render(p)}},{key:"name",get:function(){return"Chest"}}],[{key:"identifier",get:function(){return"chest"}}]);return n})(j["default"]);f["default"]=e;c.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var g=b(10);var j=k(g);var h=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);d(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}}));o.render(p)}},{key:"name",get:function(){return"Fixie"}}],[{key:"identifier",get:function(){return"fixie"}}]);return l})(j["default"]);e["default"]=h;c.exports=e["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var e=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);d(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Saturation({saturation:1.35}));o.add(new j["default"].Primitives.Contrast({contrast:1.1}));o.render(p)}},{key:"name",get:function(){return"Food"}}],[{key:"identifier",get:function(){return"food"}}]);return m})(j["default"]);f["default"]=e;c.exports=f["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(10);var j=k(h);var b=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}}));o.render(p)}},{key:"name",get:function(){return"Fridge"}}],[{key:"identifier",get:function(){return"fridge"}}]);return l})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function h(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var g=b(10);var j=k(g);var i=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}h(l,n);d(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}}));o.render(p)}},{key:"name",get:function(){return"Front"}}],[{key:"identifier",get:function(){return"front"}}]);return l})(j["default"]);e["default"]=i;c.exports=e["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function h(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var g=b(10);var j=k(g);var i=(function(n){function m(){f(this,m);if(n!=null){n.apply(this,arguments)}}h(m,n);d(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Contrast({contrast:1.1}));o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}));o.render(p)}},{key:"name",get:function(){return"Glam"}}],[{key:"identifier",get:function(){return"glam"}}]);return m})(j["default"]);e["default"]=i;c.exports=e["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(10);var j=k(h);var b=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Gobblin());o.render(p)}},{key:"name",get:function(){return"Gobblin"}}],[{key:"identifier",get:function(){return"gobblin"}}]);return l})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var g=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);d(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]}));o.add(new j["default"].Primitives.Saturation({saturation:0.9}));o.render(p)}},{key:"name",get:function(){return"K1"}}],[{key:"identifier",get:function(){return"k1"}}]);return l})(j["default"]);e["default"]=g;c.exports=e["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function j(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var h=c(10);var l=m(h);var i=c(9);var b=m(i);var k=(function(p){function o(){g(this,o);if(p!=null){p.apply(this,arguments)}}j(o,p);e(o,[{key:"render",value:function n(r){var q=new l["default"].PrimitivesStack();q.add(new l["default"].Primitives.ToneCurve({controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]}));q.add(new l["default"].Primitives.SoftColorOverlay({color:new b["default"](40/255,40/255,40/255)}));q.render(r)}},{key:"name",get:function(){return"K2"}}],[{key:"identifier",get:function(){return"k2"}}]);return o})(l["default"]);f["default"]=k;d.exports=f["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(10);var j=k(h);var b=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);e(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Saturation({saturation:0.5}));o.render(p)}},{key:"name",get:function(){return"K6"}}],[{key:"identifier",get:function(){return"k6"}}]);return m})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var g=(function(n){function m(){f(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);d(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]}));o.add(new j["default"].Primitives.Saturation({saturation:0.7}));o.render(p)}},{key:"name",get:function(){return"KDynamic"}}],[{key:"identifier",get:function(){return"kdynamic"}}]);return m})(j["default"]);e["default"]=g;c.exports=e["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var e=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);d(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Desaturation({desaturation:0.4}));o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}}));o.render(p)}},{key:"name",get:function(){return"Lenin"}}],[{key:"identifier",get:function(){return"lenin"}}]);return m})(j["default"]);f["default"]=e;c.exports=f["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(10);var j=k(h);var b=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);e(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]}));o.render(p)}},{key:"name",get:function(){return"Lomo"}}],[{key:"identifier",get:function(){return"lomo"}}]);return m})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var g=b(10);var j=k(g);var h=(function(n){function m(){f(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);d(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}}));o.render(p)}},{key:"name",get:function(){return"Mellow"}}],[{key:"identifier",get:function(){return"mellow"}}]);return m})(j["default"]);e["default"]=h;c.exports=e["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var g=(function(m){function n(){f(this,n);if(m!=null){m.apply(this,arguments)}}i(n,m);d(n,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}}));o.add(new j["default"].Primitives.Glow());o.render(p)}},{key:"name",get:function(){return"Morning"}}],[{key:"identifier",get:function(){return"morning"}}]);return n})(j["default"]);e["default"]=g;c.exports=e["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var g=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);d(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]}}));o.add(new j["default"].Primitives.ToneCurve({controlPoints:[[0,0],[117,151],[189,217],[255,255]]}));o.add(new j["default"].Primitives.Desaturation({desaturation:0.65}));o.render(p)}},{key:"name",get:function(){return"Orchid"}}],[{key:"identifier",get:function(){return"orchid"}}]);return l})(j["default"]);e["default"]=g;c.exports=e["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var d=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);e(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}));o.add(new j["default"].Primitives.Saturation({saturation:0.8}));o.add(new j["default"].Primitives.Contrast({contrast:1.5}));o.render(p)}},{key:"name",get:function(){return"Pola SX"}}],[{key:"identifier",get:function(){return"pola"}}]);return m})(j["default"]);f["default"]=d;c.exports=f["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(10);var j=k(h);var b=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}}));o.add(new j["default"].Primitives.Saturation({saturation:0.8}));o.add(new j["default"].Primitives.Contrast({contrast:1.5}));o.render(p)}},{key:"name",get:function(){return"Pola 669"}}],[{key:"identifier",get:function(){return"pola669"}}]);return l})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var d=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Desaturation({desaturation:0.65}));o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}}));o.render(p)}},{key:"name",get:function(){return"Quozi"}}],[{key:"identifier",get:function(){return"quozi"}}]);return l})(j["default"]);f["default"]=d;c.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var g=(function(m){function n(){f(this,n);if(m!=null){m.apply(this,arguments)}}i(n,m);d(n,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}}));o.add(new j["default"].Primitives.Glow());o.render(p)}},{key:"name",get:function(){return"Semi Red"}}],[{key:"identifier",get:function(){return"semired"}}]);return n})(j["default"]);e["default"]=g;c.exports=e["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(10);var j=k(h);var b=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);e(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]}}));o.add(new j["default"].Primitives.ToneCurve({controlPoints:[[0,0],[55,20],[158,191],[255,255]]}));o.render(p)}},{key:"name",get:function(){return"Sunny"}}],[{key:"identifier",get:function(){return"sunny"}}]);return m})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var g=(function(m){function n(){f(this,n);if(m!=null){m.apply(this,arguments)}}i(n,m);d(n,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}}));o.render(p)}},{key:"name",get:function(){return"Texas"}}],[{key:"identifier",get:function(){return"texas"}}]);return n})(j["default"]);e["default"]=g;c.exports=e["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(10);var j=k(h);var d=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.X400());o.render(p)}},{key:"name",get:function(){return"X400"}}],[{key:"identifier",get:function(){return"x400"}}]);return l})(j["default"]);f["default"]=d;c.exports=f["default"]},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function s(t,u){f(this,s);this.x=t;this.y=u;if(typeof this.x==="undefined"){this.x=0}if(typeof this.y==="undefined"){this.y=0}}d(s,[{key:"set",value:function q(t,u){this.x=t;this.y=u;return this}},{key:"clone",value:function o(){return new s(this.x,this.y)}},{key:"copy",value:function h(t){this.x=t.x;this.y=t.y;return this}},{key:"clamp",value:function n(u,w){var t=u!==null&&typeof u!=="undefined";var v=w!==null&&typeof w!=="undefined";if(!(u instanceof s)&&t){u=new s(u,u)}if(!(w instanceof s)&&v){w=new s(w,w)}if(t){this.x=Math.max(u.x,this.x);this.y=Math.max(u.y,this.y)}if(v){this.x=Math.min(w.x,this.x);this.y=Math.min(w.y,this.y)}return this}},{key:"divide",value:function l(u,t){if(u instanceof s){this.x/=u.x;this.y/=u.y}else{this.x/=u;this.y/=typeof t==="undefined"?u:t}return this}},{key:"subtract",value:function p(t,u){if(t instanceof s){this.x-=t.x;this.y-=t.y}else{this.x-=t;this.y-=typeof u==="undefined"?t:u}return this}},{key:"multiply",value:function i(t,u){if(t instanceof s){this.x*=t.x;this.y*=t.y}else{this.x*=t;this.y*=typeof u==="undefined"?t:u}return this}},{key:"add",value:function r(t,u){if(t instanceof s){this.x+=t.x;this.y+=t.y}else{this.x+=t;this.y+=typeof u==="undefined"?t:u}return this}},{key:"equals",value:function k(t,u){if(t instanceof s){return t.x===this.x&&t.y===this.y}else{return t===this.x&&u===this.y}}},{key:"flip",value:function m(){var t=this.x;this.x=this.y;this.y=t;return this}},{key:"toString",value:function j(){return"Vector2({ x: "+this.x+", y: "+this.y+" })"}}]);return s})();c["default"]=b;e.exports=c["default"]},function(e,z,f){Object.defineProperty(z,"__esModule",{value:true});var t=(function(){function A(E,C){for(var B=0;B<C.length;B++){var D=C[B];D.enumerable=D.enumerable||false;D.configurable=true;if("value" in D){D.writable=true}Object.defineProperty(E,D.key,D)}}return function(D,B,C){if(B){A(D.prototype,B)}if(C){A(D,C)}return D}})();var b=function x(H,G,D){var E=true;_function:while(E){var B=H,J=G,A=D;C=I=F=undefined;E=false;var C=Object.getOwnPropertyDescriptor(B,J);if(C===undefined){var I=Object.getPrototypeOf(B);if(I===null){return undefined}else{H=I;G=J;D=A;E=true;continue _function}}else{if("value" in C){return C.value}else{var F=C.get;if(F===undefined){return undefined}return F.call(A)}}}};function d(A){return A&&A.__esModule?A:{"default":A}}function h(A,B){if(!(A instanceof B)){throw new TypeError("Cannot call a class as a function")}}function q(B,A){if(typeof A!=="function"&&A!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof A)}B.prototype=Object.create(A&&A.prototype,{constructor:{value:B,enumerable:false,writable:true,configurable:true}});if(A){B.__proto__=A}}var y=f(5);var s=d(y);var w=f(77);var r=d(w);var p=f(78);var g=d(p);var i=f(79);var n=d(i);var j=f(80);var l=d(j);var m=f(81);var c=d(m);var v=f(82);var o=d(v);var u=f(4);var k=(function(W){function ai(){for(var ak=arguments.length,al=Array(ak),am=0;am<ak;am++){al[am]=arguments[am]}h(this,ai);b(Object.getPrototypeOf(ai.prototype),"constructor",this).apply(this,al);this._operationsMap={};this._template=function(ap){var ao='<div class="imglykit"> <div class="imglykit-loadingOverlay"> <div class="imglykit-loadingOverlay-content"> <img src="'+(ap.helpers.assetPath("ui/night/loading.gif"))+'" /> <span>'+(ap.helpers.translate("generic.loading"))+'...</span> </div> </div> <div class="imglykit-container"> ';if(!ap.options.ui.hideHeader){ao+=' <div class="imglykit-header-row"> <div class="imglykit-header"> img.ly Photo Editor SDK ';if(ap.options.ui.showCloseButton){ao+=' <div class="imglykit-close-button"> <img src="'+(ap.helpers.assetPath("ui/night/close.png"))+'" /> </div> '}ao+=" </div> </div> "}ao+=" ";if(ap.renderControls){ao+=' <div class="imglykit-top-controls-row"> <div class="imglykit-top-controls"> <div class="imglykit-top-controls-left"> ';if(ap.options.ui.showNewButton){ao+=' <div class="imglykit-new"> <img src="'+(ap.helpers.assetPath("ui/night/top/new.png"))+'" /> '+(ap.helpers.translate("top-controls.new"))+" </div> "}ao+=" ";if(ap.options.ui.showExportButton){ao+=' <div class="imglykit-export"> <img src="'+(ap.helpers.assetPath("ui/night/top/export.png"))+'" /> '+(ap.helpers.translate("top-controls.export"))+" </div> "}ao+=' <div class="imglykit-undo"> <img src="'+(ap.helpers.assetPath("ui/night/top/undo.png"))+'" /> '+(ap.helpers.translate("top-controls.undo"))+' </div> </div> <div class="imglykit-top-controls-right"> <div class="imglykit-zoom-fit"></div> <div class="imglykit-zoom-level">'+(ap.helpers.translate("top-controls.zoom"))+': <span class="imglykit-zoom-level-num">100</span>%</div> <div class="imglykit-zoom-in"> <img src="'+(ap.helpers.assetPath("ui/night/top/zoom-in.png"))+'" /> </div> <div class="imglykit-zoom-out"> <img src="'+(ap.helpers.assetPath("ui/night/top/zoom-out.png"))+'" /> </div> </div> </div> </div> '}ao+=' <div class="imglykit-canvas-container-row"> <div class="imglykit-canvas-container"> ';if(ap.renderWebcam){ao+=' <div class="imglykit-canvas-inner-container"> <video class="imglykit-webcam-video" autoplay></video> </div> '}ao+=" ";if(!(ap.renderSplashScreen||ap.renderWebcam)){ao+=' <div class="imglykit-canvas-inner-container"> <canvas class="imglykit-canvas-draggable"></canvas> <div class="imglykit-canvas-controls imglykit-canvas-controls-disabled"></div> </div> '}ao+=" ";if(ap.renderSplashScreen){ao+=' <div class="imglykit-splash-container"> ';if(ap.options.ui.showUploadButton){ao+=' <div class="imglykit-splash-row imglykit-splash-row--upload"> <div class="imglykit-splash-cell"> <input type="file" class="imglykit-upload-hidden-input" /> <img src="'+(ap.helpers.assetPath("ui/night/upload.png"))+'" /> <div class="imglykit-splash-content"> <div class="imglykit-splash-button">'+(ap.helpers.translate("splash.upload.headline"))+'</div> <div class="imglykit-splash-text">'+(ap.helpers.translate("splash.upload.description"))+"</div> </div> </div> </div> "}ao+=" ";if(ap.options.ui.showUploadButton&&ap.options.ui.showWebcamButton){ao+=' <div class="imglykit-splash-row imglykit-splash-row--or"> <div class="imglykit-splash-or"> <div class="imglykit-splash-or-line"></div> <div class="imglykit-splash-or-word">'+(ap.helpers.translate("splash.or"))+'</div> <div class="imglykit-splash-or-line"></div> </div> </div> '}ao+=" ";if(ap.options.ui.showWebcamButton){ao+=' <div class="imglykit-splash-row imglykit-splash-row--camera"> <div class="imglykit-splash-cell"> <img src="'+(ap.helpers.assetPath("ui/night/shutter.png"))+'" /> <div class="imglykit-splash-content"> <div class="imglykit-splash-button">'+(ap.helpers.translate("splash.webcam.headline"))+'</div> <div class="imglykit-splash-text">'+(ap.helpers.translate("splash.webcam.description"))+"</div> </div> </div> </div> "}ao+=" </div> "}ao+=" </div> </div> ";if(ap.renderWebcam){ao+=' <div class="imglykit-controls-row"> <div class="imglykit-controls-container"> <div class="imglykit-controls"> <div class="imglykit-webcam-button"> <img src="'+(ap.helpers.assetPath("ui/night/shutter-button.png"))+'" /> </div> </div> </div> </div> '}ao+=" ";if(ap.renderControls){ao+=' <div class="imglykit-controls-row"> <div class="imglykit-controls-container"> <div class="imglykit-controls"> <div> <div class="imglykit-controls-overview"> <ul class="imglykit-controls-list"> ';for(var an in ap.controls){ao+=" ";var aq=ap.controls[an];ao+=' <li class="imglykit-controls-item--with-label" data-identifier="'+(aq.identifier)+'"';if(ap.controlsDisabled){ao+=" data-disabled"}ao+='> <img src="'+(ap.helpers.assetPath("ui/night/operations/"+aq.identifier+".png"))+'" /> <div class="imglykit-controls-label">'+(ap.helpers.translate("operations."+aq.identifier))+"</div> </li> "}ao+=" </ul> </div> </div> </div> </div> </div> "}ao+=" </div></div>";return ao};this._registeredControls={};this._history=[];this._preferredOperationOrder=["rotation","crop","flip","filters","contrast","brightness","saturation","radial-blur","tilt-shift","frames","stickers","text"];this._paused=false;this._options.ui=s["default"].defaults(this._options.ui,{showNewButton:!this._options.image,showUploadButton:true,showWebcamButton:true,showHeader:true,showCloseButton:false,showExportButton:false,language:"en","export":{}});this._options.ui["export"]=s["default"].defaults(this._options.ui["export"],{type:u.ImageFormat.JPEG,quality:0.8})}q(ai,W);t(ai,[{key:"run",value:function T(){this._fixOperationsStack();this._registerControls();this._registerLanguages();this._loadLanguage();b(Object.getPrototypeOf(ai.prototype),"run",this).call(this);var ak=this._options.container;this._controlsContainer=ak.querySelector(".imglykit-controls");this._canvasControlsContainer=ak.querySelector(".imglykit-canvas-controls");this._overviewControlsContainer=ak.querySelector(".imglykit-controls-overview");this._loadingOverlay=ak.querySelector(".imglykit-loadingOverlay");this._loadingSpan=ak.querySelector(".imglykit-loadingOverlay span");this._handleOverview();if(this._options.image){this._initCanvas()}if(this.context.renderSplashScreen){this._initFileLoader();if(this._options.ui.showWebcamButton){this._handleWebcamButton()}}if(this.context.renderWebcam){this._initWebcam()}this._initTopControls();this._initControls();if(this._options.image){this.showZoom()}if(this._options.ui.showCloseButton){this._handleCloseButton()}if(this._topControls){this._topControls.updateExportButton()}}},{key:"_loadLanguage",value:function af(){this._language=this._languages[this._options.ui.language];if(!this._language){var ak=Object.keys(this._languages).join(", ");throw new Error("Unknown language '"+this._options.ui.language+"'. Available languages are: "+ak)}}},{key:"_fixOperationsStack",value:function Y(){var ap=this._kit.operationsStack;var ak=[];for(var ao=0;ao<ap.length;ao++){var am=ap[ao];var an=am.identifier;var al=this._preferredOperationOrder.indexOf(an);ak[al]=am;this._operationsMap[an]=am}this._kit.operationsStack=ak}},{key:"_initWebcam",value:function ag(){this._webcam=new l["default"](this._kit,this);this._webcam.on("image",this._onWebcamImageTaken.bind(this))}},{key:"_onWebcamImageTaken",value:function F(ak){this._options.ui.startWithWebcam=false;this._setImage(ak)}},{key:"_handleWebcamButton",value:function X(){var am=this;var ak=this._options.container;var al=ak.querySelector(".imglykit-splash-row--camera");al.addEventListener("click",function(){am._options.ui.startWithWebcam=true;am.run()})}},{key:"_initFileLoader",value:function ah(){this._fileLoader=new n["default"](this._kit,this);this._fileLoader.on("file",this._onFileLoaded.bind(this))}},{key:"_onFileLoaded",value:function U(al){var am=this;var ak=new FileReader();ak.onload=(function(){return function(ap){var an=ap.target.result;var ao=new Image();ao.addEventListener("load",function(){am._setImage(ao)});ao.src=an}})(al);ak.readAsDataURL(al)}},{key:"_setImage",value:function S(ak){this._kit.setImage(ak);this.run()}},{key:"_initTopControls",value:function M(){var ak=this;if(!this.context.renderControls){return}this._topControls=new c["default"](this._kit,this);this._topControls.run();this._topControls.on("new",function(){ak._options.image=null;ak.run()});this._topControls.on("undo",function(){ak.undo()});this._topControls.on("export",function(){ak["export"]()});this._topControls.on("zoom-in",function(){ak._canvas.zoomIn().then(function(){if(ak._currentControl){ak._currentControl.onZoom()}})});this._topControls.on("zoom-out",function(){ak._canvas.zoomOut().then(function(){if(ak._currentControl){ak._currentControl.onZoom()}})})}},{key:"_initCanvas",value:function N(){var ak=this;this._canvas=new g["default"](this._kit,this,this._options);this._canvas.run();this._canvas.on("zoom",function(){ak._topControls.updateZoomLevel()})}},{key:"selectOperations",value:function aa(ak){b(Object.getPrototypeOf(ai.prototype),"selectOperations",this).call(this,ak)}},{key:"getOrCreateOperation",value:function O(am){var ap=this._kit;var ao=ap.operationsStack;var aq=ap.registeredOperations;var ak=aq[am];if(typeof this._operationsMap[am]==="undefined"){var an=new ak(this._kit);this._operationsMap[am]=an;var al=this._preferredOperationOrder.indexOf(am);if(al===-1){al=this._preferredOperationOrder.length}ao[al]=an;return an}else{return this._operationsMap[am]}}},{key:"removeOperation",value:function G(am){if(!this._operationsMap[am]){return}var ak=this._operationsMap[am];delete this._operationsMap[am];var al=this._kit.operationsStack.indexOf(ak);this._kit.operationsStack[al]=null}},{key:"_registerControls",value:function E(){this.registerControl("filters","filters",f(83));this.registerControl("rotation","rotation",f(84));this.registerControl("flip","flip",f(85));this.registerControl("brightness","brightness",f(86));this.registerControl("contrast","contrast",f(87));this.registerControl("saturation","saturation",f(88));this.registerControl("crop","crop",f(89));this.registerControl("radial-blur","radial-blur",f(90));this.registerControl("tilt-shift","tilt-shift",f(91));this.registerControl("frames","frames",f(92));this.registerControl("stickers","stickers",f(93));this.registerControl("text","text",f(94))}},{key:"_registerLanguages",value:function D(){this.registerLanguage("en",f(96));this.registerLanguage("de",f(97))}},{key:"_handleOverview",value:function ad(){var ak=this;if(!this.context.renderControls){return}var ao=this._overviewControlsContainer.querySelector("ul");if(!ao.parentNode===this._overviewControlsContainer){return}var am=[].filter.call(ao.querySelectorAll("li"),function(ap){return ap.parentNode===ao});var an=function(aq){var ar=am[aq];var ap=ar.getAttribute("data-identifier");ar.addEventListener("click",function(){ak.switchToControl(ap)})};for(var al=0;al<am.length;al++){an(al)}}},{key:"_enableControls",value:function Q(){var an=this._overviewControlsContainer.querySelector("ul");if(!an.parentNode===this._overviewControlsContainer){return}var am=[].filter.call(an.querySelectorAll("li"),function(ao){return ao.parentNode===an});for(var ak=0;ak<am.length;ak++){var al=am[ak];al.removeAttribute("data-disabled")}}},{key:"switchToControl",value:function aj(ak){if(this.context.controlsDisabled){return}this._overviewControlsContainer.style.display="none";this._scrollbar.remove();if(this._currentControl){this._currentControl.leave()}this._currentControl=this._registeredControls[ak];this._currentControl.enter();this._currentControl.once("back",this._switchToOverview.bind(this))}},{key:"_switchToOverview",value:function B(){if(this._currentControl){this._currentControl.leave()}this._currentControl=null;this._overviewControlsContainer.style.display="";this._initScrollbar()}},{key:"registerControl",value:function ae(am,al,an){if(!this.isOperationSelected(al)){return}var ak=new an(this._kit,this);this._registeredControls[am]=ak}},{key:"_initControls",value:function R(){for(var ak in this._registeredControls){var al=this._registeredControls[ak];al.setContainers(this._controlsContainer,this._canvasControlsContainer);al.init()}this._initScrollbar()}},{key:"_initScrollbar",value:function P(){if(!this.context.renderControls){return}var ak=this._controlsContainer.querySelector(".imglykit-controls-list").parentNode;this._scrollbar=new o["default"](ak)}},{key:"_handleCloseButton",value:function I(){var al=this;var ak=this._options.container.querySelector(".imglykit-close-button");ak.addEventListener("click",function(am){am.preventDefault();al.emit("close")})}},{key:"render",value:function Z(){if(this._canvas){this._canvas.render()}}},{key:"pause",value:function A(){this._paused=true}},{key:"resume",value:function K(){var ak=arguments[0]===undefined?true:arguments[0];this._paused=false;if(ak){this.render()}}},{key:"addHistory",value:function ac(ak,al,an){var am={operation:ak,options:al,existent:an};this._history.push(am);this._topControls.updateUndoButton();return am}},{key:"hideZoom",value:function C(){this._topControls.hideZoom()}},{key:"showZoom",value:function ab(){this._topControls.showZoom()}},{key:"undo",value:function V(){var am=this._history.pop();if(am){var ak=am.operation;var an=am.existent;var al=am.options;if(!an){this.removeOperation(ak.identifier)}else{ak=this.getOrCreateOperation(ak.identifier);ak.set(al)}this.canvas.zoomToFit(true)}this._topControls.updateUndoButton();if(this._currentControl){this._currentControl.update()}}},{key:"export",value:function J(){var ak=this;this.displayLoadingMessage(this.translate("generic.exporting")+"...");var am=u.RenderType.DATAURL;var al=document.createElement("canvas");if(typeof al.msToBlob!=="undefined"){am=u.RenderType.MSBLOB}setTimeout(function(){ak._kit.render(am,ak._options.ui["export"].type,ak._options.ui["export"].dimensions,ak._options.ui["export"].quality).then(function(ao){switch(am){case u.RenderType.DATAURL:var an=document.createElement("a");var ap=ak._options.ui["export"].type.split("/").pop();an.download="imglykit-export."+ap;an.href=ao;document.body.appendChild(an);an.click();document.body.removeChild(an);break;case u.RenderType.MSBLOB:navigator.msSaveBlob(ao,"imglykit-export.png");break}ak.hideLoadingMessage()})},1000)}},{key:"displayLoadingMessage",value:function H(ak){this._loadingSpan.innerText=ak;this._loadingOverlay.style.display="block"}},{key:"hideLoadingMessage",value:function L(){this._loadingOverlay.style.display="none"}},{key:"identifier",get:function(){return"night"}},{key:"operations",get:function(){return this._operationsMap}},{key:"controls",get:function(){return this._registeredControls}},{key:"context",get:function(){var ak=b(Object.getPrototypeOf(ai.prototype),"context",this);ak.controls=this._registeredControls;ak.renderSplashScreen=!this._options.image&&!this._options.ui.startWithWebcam;ak.renderControls=!!this._options.image;ak.renderWebcam=this._options.ui.startWithWebcam;return ak}},{key:"history",get:function(){return this._history}},{key:"fileLoader",get:function(){return this._fileLoader}}]);return ai})(r["default"]);k.Control=f(95);z["default"]=k;e.exports=z["default"]},function(c,b,d){},function(c,b,d){c.exports=a},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function h(l){f(this,h);this._modifiers={FIXED:"!"};this._dimensionsString=l;this._rules=this._parse();this._validateRules()}d(h,[{key:"_parse",value:function i(){if(typeof this._dimensionsString==="undefined"||this._dimensionsString===null){return null}var l=this._dimensionsString.match(/^([0-9]+)?x([0-9]+)?([\!])?$/i);if(!l){throw new Error("Invalid size option: "+this._dimensionsString)}return{x:isNaN(l[1])?null:parseInt(l[1],10),y:isNaN(l[2])?null:parseInt(l[2],10),modifier:l[3]}}},{key:"_validateRules",value:function j(){if(this._rules===null){return}var l=this._rules.x!==null;var m=this._rules.y!==null;if(this._rules.modifier===this._modifiers.FIXED&&!(l&&m)){throw new Error("Both `x` and `y` have to be set when using the fixed (!) modifier.")}if(!l&&!m){throw new Error("Neither `x` nor `y` are given.")}}},{key:"calculateFinalDimensions",value:function k(n){var m=n.clone(),l;if(this._rules===null){return m}if(this._rules.modifier===this._modifiers.FIXED){m.set(this._rules.x,this._rules.y)}else{if(this._rules.x!==null&&this._rules.y!==null){l=Math.min(this._rules.x/m.x,this._rules.y/m.y);m.multiply(l)}else{if(this._rules.x!==null){l=n.y/n.x;m.x=this._rules.x;m.y=m.x*l}else{if(this._rules.y!==null){l=n.x/n.y;m.y=this._rules.y;m.x=m.y*l}}}}return m}}]);return h})();c["default"]=b;e.exports=c["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();function o(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var l=b(98);var e=o(l);var g=b(50);var j=o(g);var m=b(57);var d=o(m);var k=(function(t){function w(){i(this,w);if(t!=null){t.apply(this,arguments)}}n(w,t);f(w,[{key:"cache",value:function p(z){this._cache[z]={data:this._context.getImageData(0,0,this._canvas.width,this._canvas.height),size:new j["default"](this._canvas.width,this._canvas.height)}}},{key:"drawCached",value:function y(z){var B=this._cache[z];var C=B.data;var A=B.size;this._canvas.width=A.x;this._canvas.height=A.y;this._context.putImageData(C,0,0)}},{key:"_getContext",value:function q(){return this._canvas.getContext("2d")}},{key:"drawImage",value:function s(z){var A=this;return new d["default"](function(C,B){A._context.drawImage(z,0,0,z.width,z.height,0,0,A._canvas.width,A._canvas.height);C()})}},{key:"resizeTo",value:function u(A){var z=this.createCanvas();z.width=A.x;z.height=A.y;var B=z.getContext("2d");B.drawImage(this._canvas,0,0,this._canvas.width,this._canvas.height,0,0,z.width,z.height);this.setCanvas(z)}},{key:"cloneCanvas",value:function x(){var z=this.createCanvas();var A=z.getContext("2d");z.width=this._canvas.width;z.height=this._canvas.height;A.drawImage(this._canvas,0,0);return z}},{key:"reset",value:function v(){var z=arguments[0]===undefined?false:arguments[0];if(z){this._cache=[]}}}],[{key:"isSupported",value:function r(){var z=this.prototype.createCanvas();return !!(z.getContext&&z.getContext("2d"))}},{key:"identifier",get:function(){return"canvas"}}]);return w})(e["default"]);h["default"]=k;c.exports=h["default"]},function(c,i,b){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function e(y,x,u){var v=true;_function:while(v){var s=y,A=x,r=u;t=z=w=undefined;v=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;u=r;v=true;continue _function}}else{if("value" in t){return t.value}else{var w=t.get;if(w===undefined){return undefined}return w.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function p(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var m=b(98);var f=q(m);var h=b(50);var l=q(h);var o=b(57);var d=q(o);var n=(function(N){function D(){for(var S=arguments.length,T=Array(S),U=0;U<S;U++){T[U]=arguments[U]}j(this,D);k(Object.getPrototypeOf(D.prototype),"constructor",this).apply(this,T);this._defaultProgram=this.setupGLSLProgram();this.reset();this.id=D.contextId;D.contextId++}p(D,N);g(D,[{key:"cache",value:function F(S){var T=new l["default"](this._canvas.width,this._canvas.height);var W=undefined,V=undefined,U=undefined;if(!this._cache[S]){U=this._createFramebuffer()}else{U=this._cache[S]}W=U.fbo;V=U.texture;var X=this._context;X.useProgram(this._defaultProgram);X.bindTexture(X.TEXTURE_2D,V);X.texImage2D(X.TEXTURE_2D,0,X.RGBA,T.x,T.y,0,X.RGBA,X.UNSIGNED_BYTE,null);X.bindFramebuffer(X.FRAMEBUFFER,W);X.viewport(0,0,T.x,T.y);X.bindTexture(X.TEXTURE_2D,this._lastTexture);X.drawArrays(X.TRIANGLES,0,6);this._cache[S]={fbo:W,texture:V,size:T}}},{key:"_drawCachedFinal",value:function y(S){var U=this._cache[S];var V=U.texture;var T=U.size;var W=this._context;W.useProgram(this._defaultProgram);W.bindFramebuffer(W.FRAMEBUFFER,null);W.bindTexture(W.TEXTURE_2D,V);this._canvas.width=T.x;this._canvas.height=T.y;W.viewport(0,0,T.x,T.y);W.drawArrays(W.TRIANGLES,0,6)}},{key:"drawCached",value:function B(X){var U=this._cache[X];var Y=U.texture;var aa=U.size;var T=this.getCurrentFramebuffer();var Z=this.getCurrentTexture();var W=this._context;W.useProgram(this._defaultProgram);this._canvas.width=aa.x;this._canvas.height=aa.y;for(var V=0;V<this._textures.length;V++){var S=this._textures[V];W.bindTexture(W.TEXTURE_2D,S);W.texImage2D(W.TEXTURE_2D,0,W.RGBA,aa.x,aa.y,0,W.RGBA,W.UNSIGNED_BYTE,null)}W.bindFramebuffer(W.FRAMEBUFFER,T);W.bindTexture(W.TEXTURE_2D,Z);W.texImage2D(W.TEXTURE_2D,0,W.RGBA,aa.x,aa.y,0,W.RGBA,W.UNSIGNED_BYTE,null);W.bindTexture(W.TEXTURE_2D,Y);W.viewport(0,0,aa.x,aa.y);W.clear(W.COLOR_BUFFER_BIT|W.DEPTH_BUFFER_BIT);W.drawArrays(W.TRIANGLES,0,6);this.setLastTexture(Z);this.selectNextBuffer()}},{key:"_getContext",value:function J(){var S=this._canvas.getContext("webgl",this._contextOptions)||this._canvas.getContext("experimental-webgl",this._contextOptions);S.disable(S.DEPTH_TEST);S.disable(S.CULL_FACE);this._maxTextureSize=S.getParameter(S.MAX_TEXTURE_SIZE);return S}},{key:"drawImage",value:function K(S){var T=this;return new d["default"](function(W,V){var X=T._context;X.useProgram(T._defaultProgram);var U=T.createTexture();X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,true);T._inputTexture=U;T.setLastTexture(U);X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);X.texImage2D(X.TEXTURE_2D,0,X.RGBA,X.RGBA,X.UNSIGNED_BYTE,S);T._clear(X);X.drawArrays(X.TRIANGLES,0,6);W()})}},{key:"prepareImage",value:function C(X){if(X.width<=this._maxTextureSize&&X.height<=this._maxTextureSize){return d["default"].resolve(X)}var Z=new l["default"](this._maxTextureSize,this._maxTextureSize);var V=new l["default"](X.width,X.height);var Y=Math.min(Z.x/V.x,Z.y/V.y);var S=V.clone().multiply(Y);var T=this.createCanvas(S.x,S.y);var U=T.getContext("2d");U.drawImage(X,0,0,V.x,V.y,0,0,S.x,S.y);var W=T.toDataURL("image/jpeg");return new d["default"](function(ab,aa){var ac=new Image();ac.addEventListener("load",function(){ab(ac)});ac.src=W})}},{key:"_clear",value:function x(S){S.clearColor(0,0,0,0);S.clear(S.COLOR_BUFFER_BIT)}},{key:"runProgram",value:function z(U,W){var Z=this._context;Z.useProgram(U);var Y=this.getCurrentFramebuffer();var X=this.getCurrentTexture();Z.bindFramebuffer(Z.FRAMEBUFFER,Y);Z.viewport(0,0,this._canvas.width,this._canvas.height);Z.bindTexture(Z.TEXTURE_2D,X);Z.pixelStorei(Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);Z.texImage2D(Z.TEXTURE_2D,0,Z.RGBA,this._canvas.width,this._canvas.height,0,Z.RGBA,Z.UNSIGNED_BYTE,null);Z.bindTexture(Z.TEXTURE_2D,this._lastTexture);for(var V in W.uniforms){var T=Z.getUniformLocation(U,V);var S=W.uniforms[V];switch(S.type){case"i":case"1i":Z.uniform1i(T,S.value);break;case"f":case"1f":Z.uniform1f(T,S.value);break;case"2f":Z.uniform2f(T,S.value[0],S.value[1]);break;case"3f":Z.uniform3f(T,S.value[0],S.value[1],S.value[2]);break;case"4f":Z.uniform4f(T,S.value[0],S.value[1],S.value[2],S.value[3]);break;case"2fv":Z.uniform2fv(T,S.value);break;case"mat3fv":Z.uniformMatrix3fv(T,false,S.value);break;default:throw new Error("Unknown uniform type: "+S.type)}}Z.clear(Z.COLOR_BUFFER_BIT|Z.DEPTH_BUFFER_BIT);Z.drawArrays(Z.TRIANGLES,0,6);this.setLastTexture(X);this.selectNextBuffer()}},{key:"runShader",value:function I(V,S,U){if(typeof U==="undefined"){U={}}if(typeof U.uniforms==="undefined"){U.uniforms={}}var T=this.setupGLSLProgram(V,S);this.runProgram(T,U)}},{key:"renderFinal",value:function M(){var T=this._context;var S=this._defaultProgram;T.useProgram(S);T.bindFramebuffer(T.FRAMEBUFFER,null);T.viewport(0,0,this._canvas.width,this._canvas.height);T.bindTexture(T.TEXTURE_2D,this._lastTexture);this._clear(T);T.drawArrays(T.TRIANGLES,0,6)}},{key:"setupGLSLProgram",value:function v(ab,V){var Z=this._context;var ad=[];ab=this._createShader(Z.VERTEX_SHADER,ab||D.prototype.defaultVertexShader);ad.push(ab);V=this._createShader(Z.FRAGMENT_SHADER,V||D.prototype.defaultFragmentShader);ad.push(V);var Y=Z.createProgram();for(var X=0;X<ad.length;X++){Z.attachShader(Y,ad[X])}Z.linkProgram(Y);var T=Z.getProgramParameter(Y,Z.LINK_STATUS);if(!T){var aa=Z.getProgramInfoLog(Y);Z.deleteProgram(Y);throw new Error("WebGL program linking error: "+aa)}var ac=Z.getAttribLocation(Y,"a_position");var U=Z.getAttribLocation(Y,"a_texCoord");var S=Z.createBuffer();Z.bindBuffer(Z.ARRAY_BUFFER,S);Z.bufferData(Z.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),Z.STATIC_DRAW);Z.enableVertexAttribArray(U);Z.vertexAttribPointer(U,2,Z.FLOAT,false,0,0);var W=Z.createBuffer();Z.bindBuffer(Z.ARRAY_BUFFER,W);Z.enableVertexAttribArray(ac);Z.vertexAttribPointer(ac,2,Z.FLOAT,false,0,0);Z.bufferData(Z.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),Z.STATIC_DRAW);return Y}},{key:"_createShader",value:function s(V,X){var U=this._context;var S=U.createShader(V);U.shaderSource(S,X);U.compileShader(S);var T=U.getShaderParameter(S,U.COMPILE_STATUS);if(!T){var W=U.getShaderInfoLog(S);U.deleteShader(S);throw new Error("WebGL shader compilation error: "+W)}return S}},{key:"createTexture",value:function t(){var T=this._context;var S=T.createTexture();T.bindTexture(T.TEXTURE_2D,S);T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE);T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE);T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.NEAREST);T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,T.NEAREST);return S}},{key:"_createFramebuffers",value:function E(){for(var S=0;S<2;S++){var V=this._createFramebuffer();var U=V.fbo;var T=V.texture;this._textures.push(T);this._framebuffers.push(U)}}},{key:"_createFramebuffer",value:function L(){var U=this._context;var T=this.createTexture();U.pixelStorei(U.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);U.texImage2D(U.TEXTURE_2D,0,U.RGBA,this._canvas.width,this._canvas.height,0,U.RGBA,U.UNSIGNED_BYTE,null);var S=U.createFramebuffer();U.bindFramebuffer(U.FRAMEBUFFER,S);U.framebufferTexture2D(U.FRAMEBUFFER,U.COLOR_ATTACHMENT0,U.TEXTURE_2D,T,0);return{fbo:S,texture:T}}},{key:"resizeTo",value:function H(S){var T=this._context;this._canvas.width=S.x;this._canvas.height=S.y;T.viewport(0,0,this._canvas.width,this._canvas.height);T.drawArrays(T.TRIANGLES,0,6)}},{key:"getCurrentFramebuffer",value:function A(){return this._framebuffers[this._bufferIndex%2]}},{key:"getCurrentTexture",value:function w(){return this._textures[this._bufferIndex%2]}},{key:"selectNextBuffer",value:function r(){this._bufferIndex++}},{key:"getDefaultProgram",value:function G(){return this._defaultProgram}},{key:"getLastTexture",value:function Q(){return this._lastTexture}},{key:"getTextures",value:function u(){return this._textures}},{key:"setLastTexture",value:function P(S){this._lastTexture=S}},{key:"reset",value:function O(){var S=arguments[0]===undefined?false:arguments[0];this._lastTexture=null;this._textures=[];this._framebuffers=[];this._bufferIndex=0;if(S){this._cache=[]}this._createFramebuffers();this.setLastTexture(this._inputTexture)}},{key:"_contextOptions",get:function(){return{alpha:true,premultipliedAlpha:true}}},{key:"identifier",get:function(){return"webgl"}},{key:"defaultVertexShader",get:function(){var S="\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0, 1);\n        v_texCoord = a_texCoord;\n      }\n    ";return S}},{key:"defaultFragmentShader",get:function(){var S="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_FragColor = texture2D(u_image, v_texCoord);\n      }\n    ";return S}},{key:"maxTextureSize",get:function(){return this._maxTextureSize}}],[{key:"isSupported",value:function R(){if(typeof window==="undefined"){return false}var S=document.createElement("canvas");var T=S.getContext("webgl")||S.getContext("experimental-webgl");return !!T}}]);return D})(f["default"]);n.contextId=0;i["default"]=n;c.exports=i["default"]},function(c,b,d){(function(f){Object.defineProperty(b,"__esModule",{value:true});var e=typeof f!=="undefined"?f:typeof window!=="undefined"?window:null;var g=e.Promise;if(!g){g=d(100)}b["default"]=g;c.exports=b["default"]}.call(b,(function(){return this}())))},function(c,b,d){c.exports=function(h,e){var g=this;var j;if(h&&h.hasOwnProperty("constructor")){j=h.constructor}else{j=function(){return g.apply(this,arguments)}}var f;for(f in g){j[f]=g[f]}if(typeof e!=="undefined"){for(f in e){j[f]=e[f]}}var i=function i(){this.constructor=j};i.prototype=g.prototype;j.prototype=new i();if(h){for(f in h){j.prototype[f]=h[f]}}j.__super__=g.prototype;return j}},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function h(){for(var k=arguments.length,l=Array(k),m=0;m<k;m++){l[m]=arguments[m]}f(this,h);this._stack=[]}d(h,[{key:"add",value:function j(k){this._stack.push(k)}},{key:"render",value:function i(m){for(var l=0;l<this._stack.length;l++){var k=this._stack[l];k.render(m)}}}]);return h})();c["default"]=b;e.exports=c["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var g=b(5);var o=n(g);var i=b(99);var m=n(i);var f=(function(p){function r(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}j(this,r);k(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=o["default"].defaults(this._options,{saturation:0});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_saturation;\n\n      const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float luminance = dot(texColor.rgb, luminanceWeighting);\n\n        vec3 greyScaleColor = vec3(luminance);\n\n        gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);\n      }\n    "}l(r,p);e(r,[{key:"renderWebGL",value:function s(t){if(!this._glslPrograms[t.id]){this._glslPrograms[t.id]=t.setupGLSLProgram(null,this._fragmentShader)}t.runProgram(this._glslPrograms[t.id],{uniforms:{u_saturation:{type:"f",value:this._options.saturation}}})}},{key:"renderCanvas",value:function q(A){var w=A.getCanvas();var C=A.getContext().getImageData(0,0,w.width,w.height);var z=this._options.saturation;for(var t=0;t<w.width;t++){for(var B=0;B<w.height;B++){var v=(w.width*B+t)*4;var u=C.data[v]*0.2125+C.data[v+1]*0.7154+C.data[v+2]*0.0721;C.data[v]=u*(1-z)+C.data[v]*z;C.data[v+1]=u*(1-z)+C.data[v+1]*z;C.data[v+2]=u*(1-z)+C.data[v+2]*z}}A.getContext().putImageData(C,0,0)}}]);return r})(m["default"]);h["default"]=f;c.exports=h["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var j=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function i(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var h=c(99);var l=m(h);var b=(function(n){function r(){for(var s=arguments.length,t=Array(s),u=0;u<s;u++){t[u]=arguments[u]}i(this,r);j(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,t);this._textureIndex=3;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_lookupTable;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;\n        float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;\n        float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;\n\n        gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);\n      }\n    "}k(r,n);f(r,[{key:"renderWebGL",value:function q(s){this._updateTexture(s);s.runShader(null,this._fragmentShader,{uniforms:{u_lookupTable:{type:"i",value:3}}})}},{key:"renderCanvas",value:function o(z){var u=z.getCanvas();var s=z.getContext().getImageData(0,0,u.width,u.height);var D=this._options.data;for(var C=0;C<u.width;C++){for(var B=0;B<u.height;B++){var w=(u.width*B+C)*4;var t=s.data[w];s.data[w]=D[t*4];var v=s.data[w+1];s.data[w+1]=D[1+v*4];var A=s.data[w+2];s.data[w+2]=D[2+A*4]}}z.getContext().putImageData(s,0,0)}},{key:"_updateTexture",value:function p(t){var u=t.getContext();if(typeof this._options.data==="undefined"){throw new Error("LookupTable: No data specified.")}var s=new Uint8Array(this._options.data);u.activeTexture(u.TEXTURE0+this._textureIndex);if(!this._texture){this._texture=u.createTexture()}u.bindTexture(u.TEXTURE_2D,this._texture);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE);u.texImage2D(u.TEXTURE_2D,0,u.RGBA,256,1,0,u.RGBA,u.UNSIGNED_BYTE,s);u.activeTexture(u.TEXTURE0)}}]);return r})(l["default"]);g["default"]=b;d.exports=g["default"]},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function f(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var h=d(5);var o=n(h);var l=d(61);var b=n(l);var c=(function(r){function u(){for(var w=arguments.length,x=Array(w),y=0;y<w;y++){x[y]=arguments[y]}j(this,u);k(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,x);this._options=o["default"].defaults(this._options,{rgbControlPoints:{red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}});if(typeof this._options.rgbControlPoints!=="undefined"){this._updateLookupTable()}}m(u,r);g(u,[{key:"_updateLookupTable",value:function t(){var y=this._calculateSplineCurve(this._options.rgbControlPoints.red);var x=this._calculateSplineCurve(this._options.rgbControlPoints.green);var w=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(y,x,w)}},{key:"_buildLookupTable",value:function q(z,y,w){var A=[];for(var x=0;x<256;x++){A.push(Math.min(Math.max(x+z[x],0),255));A.push(Math.min(Math.max(x+y[x],0),255));A.push(Math.min(Math.max(x+w[x],0),255));A.push(255)}return A}},{key:"_calculateSplineCurve",value:function v(B){B=B.sort(function(F,E){return F[0]>E[0]});var w=this._getSplineCurve(B);var C=w[0];var z;if(C[0]>0){for(z=0;z<C[0];z++){w.unshift([0,0])}}var y=[];for(z=0;z<w.length;z++){var x=w[z];var A=[x[0],x[0]];var D=Math.sqrt(Math.pow(A[0]-x[0],2)+Math.pow(A[1]-x[1],2));if(A[1]>x[1]){D=-D}y.push(D)}return y}},{key:"_getSplineCurve",value:function s(K){var A=this._secondDerivative(K);var w=A.length;var E=[];var B;for(B=0;B<w;B++){E[B]=A[B]}var z=[];for(B=0;B<w-1;B++){var J=K[B];var D=K[B+1];for(var I=J[0];I<D[0];I++){var L=(I-J[0])/(D[0]-J[0]);var H=1-L;var G=L;var C=D[0]-J[0];var F=H*J[1]+G*D[1]+C*C/6*((H*H*H-H)*E[B]+(G*G*G-G)*E[B+1]);if(F>255){F=255}else{if(F<0){F=0}}z.push([I,F])}}if(z.length===255){z.push(K[K.length-1])}return z}},{key:"_secondDerivative",value:function p(C){var x=C.length;if(x<=0||x===1){return null}var B=[];var F=[];var z,y;B[0]=[0,1,0];for(z=1;z<x-1;z++){var w=C[z-1];var E=C[z];var D=C[z+1];B[z]=B[z]||[];B[z][0]=(E[0]-w[0])/6;B[z][1]=(D[0]-w[0])/3;B[z][2]=(D[0]-E[0])/6;F[z]=(D[1]-E[1])/(D[0]-E[0])-(E[1]-w[1])/(E[0]-w[0])}F[0]=0;F[x-1]=0;B[x-1]=[0,1,0];for(z=1;z<x;z++){y=B[1][0]/B[z-1][1];B[z][1]-=y*B[z-1][2];B[z][0]=0;F[z]-=y*F[z-1]}for(z=x-2;z>0;z--){y=B[z][2]/B[z+1][1];B[z][1]-=y*B[z+1][0];B[z][2]=0;F[z]-=y*F[z+1]}var A=[];for(z=0;z<x;z++){A[z]=F[z]/B[z][1]}return A}}]);return u})(b["default"]);i["default"]=c;e.exports=i["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var l=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var h=c(5);var q=p(h);var j=c(99);var o=p(j);var m=c(9);var b=p(m);var f=(function(s){function r(){for(var v=arguments.length,w=Array(v),x=0;x<v;x++){w[x]=arguments[x]}k(this,r);l(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,w);this._options=q["default"].defaults(this._options,{color:new b["default"](1,1,1)});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform vec3 u_overlay;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        vec4 overlayVec4 = vec4(u_overlay, texColor.a);\n        gl_FragColor = max(overlayVec4 * texColor.a, texColor);\n      }\n    "}n(r,s);g(r,[{key:"renderWebGL",value:function u(v){v.runShader(null,this._fragmentShader,{uniforms:{u_overlay:{type:"3f",value:this._options.color.toRGBGLColor()}}})}},{key:"renderCanvas",value:function t(A){var z=A.getCanvas();var C=A.getContext().getImageData(0,0,z.width,z.height);for(var v=0;v<z.width;v++){for(var B=0;B<z.height;B++){var w=(z.width*B+v)*4;C.data[w]=Math.max(this._options.color.r,C.data[w]);C.data[w+1]=Math.max(this._options.color.g,C.data[w+1]);C.data[w+2]=Math.max(this._options.color.b,C.data[w+2])}}A.getContext().putImageData(C,0,0)}}]);return r})(o["default"]);i["default"]=f;d.exports=i["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var g=b(5);var o=n(g);var i=b(99);var m=n(i);var f=(function(p){function r(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}j(this,r);k(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=o["default"].defaults(this._options,{desaturation:1});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_desaturation;\n\n      const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        vec3 grayXfer = vec3(0.3, 0.59, 0.11);\n        vec3 gray = vec3(dot(grayXfer, texColor.xyz));\n        gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);\n      }\n    "}l(r,p);e(r,[{key:"renderWebGL",value:function s(t){t.runShader(null,this._fragmentShader,{uniforms:{u_desaturation:{type:"f",value:this._options.desaturation}}})}},{key:"renderCanvas",value:function q(A){var w=A.getCanvas();var C=A.getContext().getImageData(0,0,w.width,w.height);var z=this._options.desaturation;for(var t=0;t<w.width;t++){for(var B=0;B<w.height;B++){var v=(w.width*B+t)*4;var u=C.data[v]*0.3+C.data[v+1]*0.59+C.data[v+2]*0.11;C.data[v]=u*(1-z)+C.data[v]*z;C.data[v+1]=u*(1-z)+C.data[v+1]*z;C.data[v+2]=u*(1-z)+C.data[v+2]*z}}A.getContext().putImageData(C,0,0)}}]);return r})(m["default"]);h["default"]=f;c.exports=h["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var g=b(99);var l=m(g);var j=(function(n){function p(){for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}h(this,p);i(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,s);this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;\n        gray -= 0.2;\n        gray = clamp(gray, 0.0, 1.0);\n        gray += 0.15;\n        gray *= 1.4;\n        gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);\n      }\n    "}k(p,n);e(p,[{key:"renderWebGL",value:function q(r){r.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function o(v){var u=v.getCanvas();var z=v.getContext().getImageData(0,0,u.width,u.height);for(var s=0;s<u.width;s++){for(var w=0;w<u.height;w++){var t=(u.width*w+s)*4;var r=z.data[t]/255*0.3+z.data[t+1]/255*0.3+z.data[t+2]/255*0.3;r-=0.2;r=Math.max(0,Math.min(1,r));r+=0.15;r*=1.4;r*=255;z.data[t]=r;z.data[t+1]=r;z.data[t+2]=r}}v.getContext().putImageData(z,0,0)}}]);return p})(l["default"]);f["default"]=j;c.exports=f["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var j=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function i(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var h=b(99);var l=m(h);var e=(function(n){function p(){for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}i(this,p);j(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,s);this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      vec3 W = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float luminance = dot(texColor.rgb, W);\n        gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);\n      }\n    "}k(p,n);f(p,[{key:"renderWebGL",value:function q(r){r.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function o(v){var u=v.getCanvas();var z=v.getContext().getImageData(0,0,u.width,u.height);for(var r=0;r<u.width;r++){for(var w=0;w<u.height;w++){var t=(u.width*w+r)*4;var s=z.data[t]*0.2125+z.data[t+1]*0.7154+z.data[t+2]*0.0721;z.data[t]=s;z.data[t+1]=s;z.data[t+2]=s}}v.getContext().putImageData(z,0,0)}}]);return p})(l["default"]);g["default"]=e;c.exports=g["default"]},function(d,h,c){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function e(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var g=c(5);var o=n(g);var i=c(99);var m=n(i);var b=(function(p){function r(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}j(this,r);k(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=o["default"].defaults(this._options,{contrast:1});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_contrast;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);\n      }\n    "}l(r,p);f(r,[{key:"renderWebGL",value:function s(t){if(!this._glslPrograms[t.id]){this._glslPrograms[t.id]=t.setupGLSLProgram(null,this._fragmentShader)}t.runProgram(this._glslPrograms[t.id],{uniforms:{u_contrast:{type:"f",value:this._options.contrast}}})}},{key:"renderCanvas",value:function q(z){var v=z.getCanvas();var B=z.getContext().getImageData(0,0,v.width,v.height);var w=this._options.contrast;for(var t=0;t<v.width;t++){for(var A=0;A<v.height;A++){var u=(v.width*A+t)*4;B.data[u]=(B.data[u]-127)*w+127;B.data[u+1]=(B.data[u+1]-127)*w+127;B.data[u+2]=(B.data[u+2]-127)*w+127}}z.getContext().putImageData(B,0,0)}}]);return r})(m["default"]);h["default"]=b;d.exports=h["default"]},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var l=function f(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var h=d(5);var q=p(h);var j=d(99);var o=p(j);var m=d(9);var c=p(m);var b=(function(r){function t(){for(var v=arguments.length,w=Array(v),x=0;x<v;x++){w[x]=arguments[x]}k(this,t);l(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,w);this._options=q["default"].defaults(this._options,{color:new c["default"](1,1,1)});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      uniform vec3 u_color;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n\n        vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);\n        textureCoord /= 0.75;\n\n        float d = 1.0 - dot(textureCoord, textureCoord);\n        d = clamp(d, 0.2, 1.0);\n        vec3 newColor = texColor.rgb * d * u_color.rgb;\n        gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);\n      }\n    "}n(t,r);g(t,[{key:"renderWebGL",value:function u(v){v.runShader(null,this._fragmentShader,{uniforms:{u_color:{type:"3f",value:this._options.color.toRGBGLColor()}}})}},{key:"renderCanvas",value:function s(I){var w=I.getCanvas();var v=I.getContext().getImageData(0,0,w.width,w.height);var A=this._options.color;var H;for(var K=0;K<w.width;K++){for(var J=0;J<w.height;J++){var E=(w.width*J+K)*4;var z=K/w.width;var C=J/w.height;var D=(z-0.5)/0.75;var B=(C-0.5)/0.75;var G=D*D;var F=B*B;H=1-(G+F);H=Math.min(Math.max(H,0.1),1);v.data[E]=v.data[E]*(H*A.r);v.data[E+1]=v.data[E+1]*(H*A.g);v.data[E+2]=v.data[E+2]*(H*A.b);v.data[E+3]=255}}I.getContext().putImageData(v,0,0)}}]);return t})(o["default"]);i["default"]=b;e.exports=i["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var g=b(99);var l=m(g);var j=(function(n){function q(){for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}h(this,q);i(Object.getPrototypeOf(q.prototype),"constructor",this).apply(this,s);this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        texColor.b = texColor.g * 0.33;\n        texColor.r = texColor.r * 0.6;\n        texColor.b += texColor.r * 0.33;\n        texColor.g = texColor.g * 0.7;\n        gl_FragColor = texColor;\n      }\n    "}k(q,n);e(q,[{key:"renderWebGL",value:function p(r){r.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function o(u){var t=u.getCanvas();var w=u.getContext().getImageData(0,0,t.width,t.height);for(var r=0;r<t.width;r++){for(var v=0;v<t.height;v++){var s=(t.width*v+r)*4;w.data[s+2]=w.data[s+1]*0.33;w.data[s]=w.data[s]*0.6;w.data[s+2]+=w.data[s]*0.33;w.data[s+1]=w.data[s+1]*0.7;w.data[s+3]=255}}u.getContext().putImageData(w,0,0)}}]);return q})(l["default"]);f["default"]=j;c.exports=f["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var j=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var f=b(5);var o=n(f);var h=b(99);var m=n(h);var k=(function(p){function r(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}i(this,r);j(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=o["default"].defaults(this._options,{brightness:1});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_brightness;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;\n      }\n    "}l(r,p);e(r,[{key:"renderWebGL",value:function s(t){if(!this._glslPrograms[t.id]){this._glslPrograms[t.id]=t.setupGLSLProgram(null,this._fragmentShader)}t.runProgram(this._glslPrograms[t.id],{uniforms:{u_brightness:{type:"f",value:this._options.brightness}}})}},{key:"renderCanvas",value:function q(w){var v=w.getCanvas();var B=w.getContext().getImageData(0,0,v.width,v.height);var z=this._options.brightness;for(var t=0;t<v.width;t++){for(var A=0;A<v.height;A++){var u=(v.width*A+t)*4;B.data[u]=B.data[u]+z*255;B.data[u+1]=B.data[u+1]+z*255;B.data[u+2]=B.data[u+2]+z*255}}w.getContext().putImageData(B,0,0)}}]);return r})(m["default"]);g["default"]=k;c.exports=g["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var g=b(10);var j=k(g);var h=(function(n){function m(){f(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);d(m,[{key:"render",value:function l(){}},{key:"name",get:function(){return"Original"}}],[{key:"identifier",get:function(){return"identity"}}]);return m})(j["default"]);e["default"]=h;c.exports=e["default"]},function(d,c,g){
/*!
	 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
	 * https://github.com/hMatoba/MinifyJpeg
	 */
"use strict";Object.defineProperty(c,"__esModule",{value:true});var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c["default"]={encode:function e(k){var h="",r=undefined,p=undefined,n="",q=undefined,o=undefined,m=undefined,l="",j=0;do{r=k[j++];p=k[j++];n=k[j++];q=r>>2;o=(r&3)<<4|p>>4;m=(p&15)<<2|n>>6;l=n&63;if(isNaN(p)){m=l=64}else{if(isNaN(n)){l=64}}h=h+b.charAt(q)+b.charAt(o)+b.charAt(m)+b.charAt(l);r=p=n="";q=o=m=l=""}while(j<k.length);return h},decode:function f(l){var s=undefined,q=undefined,o="",r=undefined,p=undefined,n=undefined,m="",k=0,j=[];var h=/[^A-Za-z0-9\+\/\=]/g;if(h.exec(l)){throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.")}l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{r=b.indexOf(l.charAt(k++));p=b.indexOf(l.charAt(k++));n=b.indexOf(l.charAt(k++));m=b.indexOf(l.charAt(k++));s=r<<2|p>>4;q=(p&15)<<4|n>>2;o=(n&3)<<6|m;j.push(s);if(n!==64){j.push(q)}if(m!==64){j.push(o)}s=q=o="";r=p=n=m=""}while(k<l.length);return j}};d.exports=c["default"]},function(d,b,g){Object.defineProperty(b,"__esModule",{value:true});var c=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var e=(function(){function m(u){f(this,m);this._head=0;this._buf=u}c(m,[{key:"getHead",value:function q(){return this._head}},{key:"setHead",value:function j(u){this._head=u}},{key:"peekInt8",value:function n(){return this._buf[this._head]}},{key:"peekInt16",value:function o(){var w=arguments[0]===undefined?false:arguments[0];var v=this._buf[this._head];var u=this._buf[this._head+1];if(!w){return(v<<8)+u}else{return(u<<8)+v}}},{key:"peekInt24",value:function k(){var w=arguments[0]===undefined?false:arguments[0];var v=this._buf[this._head];var u=this._buf[this._head+1];var x=this._buf[this._head+2];if(!w){return(v<<16)+(u<<8)+x}else{return(x<<16)+(u<<8)+v}}},{key:"peekInt32",value:function h(){var w=arguments[0]===undefined?false:arguments[0];var v=this._buf[this._head];var u=this._buf[this._head+1];var y=this._buf[this._head+2];var x=this._buf[this._head+3];if(!w){return(v<<32)+(u<<16)+(y<<8)+x}else{return(x<<32)+(y<<16)+(u<<8)+v}}},{key:"writeInt16",value:function t(u){this._buf[this._head]=u>>8;this._buf[this._head+1]=u&255}},{key:"readInt8",value:function l(){var u=this.peekInt8();this._head+=1;return u}},{key:"readInt16",value:function i(){var v=arguments[0]===undefined?false:arguments[0];var u=this.peekInt16(v);this._head+=2;return u}},{key:"readInt24",value:function s(){var v=arguments[0]===undefined?false:arguments[0];var u=this.peekInt24(v);this._head+=3;return u}},{key:"readInt32",value:function p(){var v=arguments[0]===undefined?false:arguments[0];var u=this.peekInt32(v);this._head+=4;return u}},{key:"readString",value:function r(v){var x="";for(var u=0;u<v;u++){var w=this.readInt8();x+=String.fromCharCode(w)}return x}}]);return m})();b["default"]=e;d.exports=b["default"]},function(e,b,i){Object.defineProperty(b,"__esModule",{value:true});var d=(function(){function j(n,l){for(var k=0;k<l.length;k++){var m=l[k];m.enumerable=m.enumerable||false;m.configurable=true;if("value" in m){m.writable=true}Object.defineProperty(n,m.key,m)}}return function(m,k,l){if(k){j(m.prototype,k)}if(l){j(m,l)}return m}})();function h(j,k){if(!(j instanceof k)){throw new TypeError("Cannot call a class as a function")}}var g=12;function c(m){for(var j=arguments.length,k=Array(j>1?j-1:0),l=1;l<j;l++){k[l-1]=arguments[l]}console.error.apply(console,[m].concat(k));console.trace()}var f=(function(){function n(){h(this,n);this._maxListeners=g;this._events={}}d(n,[{key:"on",value:function j(q,r){if(typeof r!=="function"){throw new TypeError()}var p=this._events[q]||(this._events[q]=[]);if(p.indexOf(r)!==-1){return this}p.push(r);if(p.length>this._maxListeners){c("possible memory leak, added %i %s listeners,\n        use EventEmitter#setMaxListeners(number) if you\n        want to increase the limit (%i now)",p.length,q,this._maxListeners)}return this}},{key:"once",value:function m(q,s){var r=this;function p(){r.off(q,p);s.apply(null,arguments)}return this.on(q,p)}},{key:"off",value:function o(t){for(var p=arguments.length,r=Array(p>1?p-1:0),q=1;q<p;q++){r[q-1]=arguments[q]}if(r.length===0){this._events[t]=null;return this}var v=r[0];if(typeof v!=="function"){throw new TypeError()}var s=this._events[t];if(!s||!s.length){return this}var u=s.indexOf(v);if(u===-1){return this}s.splice(u,1);return this}},{key:"emit",value:function k(s){for(var t=arguments.length,q=Array(t>1?t-1:0),p=1;p<t;p++){q[p-1]=arguments[p]}var r=this._events[s];if(!r||!r.length){return false}r.forEach(function(u){return u.apply(null,q)});return true}},{key:"setMaxListeners",value:function l(p){if(parseInt(p,10)!==p){throw new TypeError()}this._maxListeners=p}}]);return n})();b["default"]=f;e.exports=b["default"]},function(d,c,f){
/*!
	
	StackBlur - a fast almost Gaussian Blur For Canvas
	
	Version:  0.5
	Author:   Mario Klingemann
	Contact:  mario@quasimondo.com
	Website:  http://www.quasimondo.com/StackBlurForCanvas
	Twitter:  @quasimondo
	
	In case you find this class useful - especially in commercial projects -
	I am not totally unhappy for a small donation to my PayPal account
	mario@quasimondo.de
	
	Or support me on flattr:
	https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript
	
	Copyright (c) 2010 Mario Klingemann
	
	Permission is hereby granted, free of charge, to any person
	obtaining a copy of this software and associated documentation
	files (the "Software"), to deal in the Software without
	restriction, including without limitation the rights to use,
	copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the
	Software is furnished to do so, subject to the following
	conditions:
	
	The above copyright notice and this permission notice shall be
	included in all copies or substantial portions of the Software.
	
	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
	EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
	OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
	NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
	HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
	WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
	FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
	OTHER DEALINGS IN THE SOFTWARE.
	*/
var b=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259];var h=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function g(Z,M,K,j,l,U){if(isNaN(U)||U<1){return}U|=0;var q=Z.data;var S,R,ab,Y,A,D,u,n,o,J,X,w,L,H,k,P,T,B,v,t,C,E,F,O;var ac=U+U+1;var z=j-1;var W=l-1;var s=U+1;var V=s*(s+1)/2;var N=new e();var r;var I=N;for(ab=1;ab<ac;ab++){I=I.next=new e();if(ab==s){r=I}}I.next=N;var aa=null;var Q=null;u=D=0;var G=b[U];var m=h[U];for(R=0;R<l;R++){P=T=B=v=n=o=J=X=0;w=s*(t=q[D]);L=s*(C=q[D+1]);H=s*(E=q[D+2]);k=s*(F=q[D+3]);n+=V*t;o+=V*C;J+=V*E;X+=V*F;I=N;for(ab=0;ab<s;ab++){I.r=t;I.g=C;I.b=E;I.a=F;I=I.next}for(ab=1;ab<s;ab++){Y=D+((z<ab?z:ab)<<2);n+=(I.r=t=q[Y])*(O=s-ab);o+=(I.g=C=q[Y+1])*O;J+=(I.b=E=q[Y+2])*O;X+=(I.a=F=q[Y+3])*O;P+=t;T+=C;B+=E;v+=F;I=I.next}aa=N;Q=r;for(S=0;S<j;S++){q[D+3]=F=X*G>>m;if(F!==0){F=255/F;q[D]=(n*G>>m)*F;q[D+1]=(o*G>>m)*F;q[D+2]=(J*G>>m)*F}else{q[D]=q[D+1]=q[D+2]=0}n-=w;o-=L;J-=H;X-=k;w-=aa.r;L-=aa.g;H-=aa.b;k-=aa.a;Y=u+((Y=S+U+1)<z?Y:z)<<2;P+=aa.r=q[Y];T+=aa.g=q[Y+1];B+=aa.b=q[Y+2];v+=aa.a=q[Y+3];n+=P;o+=T;J+=B;X+=v;aa=aa.next;w+=t=Q.r;L+=C=Q.g;H+=E=Q.b;k+=F=Q.a;P-=t;T-=C;B-=E;v-=F;Q=Q.next;D+=4}u+=j}for(S=0;S<j;S++){T=B=v=P=o=J=X=n=0;D=S<<2;w=s*(t=q[D]);L=s*(C=q[D+1]);H=s*(E=q[D+2]);k=s*(F=q[D+3]);n+=V*t;o+=V*C;J+=V*E;X+=V*F;I=N;for(ab=0;ab<s;ab++){I.r=t;I.g=C;I.b=E;I.a=F;I=I.next}A=j;for(ab=1;ab<=U;ab++){D=A+S<<2;n+=(I.r=t=q[D])*(O=s-ab);o+=(I.g=C=q[D+1])*O;J+=(I.b=E=q[D+2])*O;X+=(I.a=F=q[D+3])*O;P+=t;T+=C;B+=E;v+=F;I=I.next;if(ab<W){A+=j}}D=S;aa=N;Q=r;for(R=0;R<l;R++){Y=D<<2;q[Y+3]=F=X*G>>m;if(F>0){F=255/F;q[Y]=(n*G>>m)*F;q[Y+1]=(o*G>>m)*F;q[Y+2]=(J*G>>m)*F}else{q[Y]=q[Y+1]=q[Y+2]=0}n-=w;o-=L;J-=H;X-=k;w-=aa.r;L-=aa.g;H-=aa.b;k-=aa.a;Y=S+((Y=R+s)<W?Y:W)*j<<2;n+=P+=aa.r=q[Y];o+=T+=aa.g=q[Y+1];J+=B+=aa.b=q[Y+2];X+=v+=aa.a=q[Y+3];aa=aa.next;w+=t=Q.r;L+=C=Q.g;H+=E=Q.b;k+=F=Q.a;P-=t;T-=C;B-=E;v-=F;Q=Q.next;D+=j}}}function e(){this.r=0;this.g=0;this.b=0;this.a=0;this.next=null}d.exports={stackBlurCanvasRGBA:g}},function(d,c,h){var g=d.exports={};var b=[];var i=false;function f(){if(i){return}i=true;var l;var j=b.length;while(j){l=b;b=[];var k=-1;while(++k<j){l[k]()}j=b.length}i=false}g.nextTick=function(j){b.push(j);if(!i){setTimeout(f,0)}};g.title="browser";g.browser=true;g.env={};g.argv=[];g.version="";g.versions={};function e(){}g.on=e;g.addListener=e;g.once=e;g.off=e;g.removeListener=e;g.removeAllListeners=e;g.emit=e;g.binding=function(j){throw new Error("process.binding is not supported")};g.cwd=function(){return"/"};g.chdir=function(j){throw new Error("process.chdir is not supported")};g.umask=function(){return 0}},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function f(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var h=d(5);var q=p(h);var c=d(74);var l=p(c);var b=d(101);var m=p(b);var n=(function(r){function A(C,B){j(this,A);k(Object.getPrototypeOf(A.prototype),"constructor",this).call(this);this._kit=C;this._options=B;this._options.ui=this._options.ui||{};this._operations=[];this._helpers=new m["default"](this.kit,this,B);this._languages={};this.selectOperations(null)}o(A,r);g(A,[{key:"run",value:function x(){this._attach()}},{key:"registerLanguage",value:function t(C,B){this._languages[C]=B}},{key:"translate",value:function u(B){return q["default"].fetch(this._language,B,"translation-missing")}},{key:"_attach",value:function s(){if(this._options.container===null){throw new Error("BaseUI#attach: No container set.")}var B=this._render();this._options.container.innerHTML=B;this._options.container.style.position="relative"}},{key:"_render",value:function y(){if(typeof this._template==="undefined"){throw new Error("BaseUI#_render: No template set.")}return this._template(this.context)}},{key:"selectOperations",value:function z(B){var E=this._kit.registeredOperations;var D=Object.keys(E);var C=q["default"].select(D,B);this._operations=C.map(function(F){return E[F]})}},{key:"addOperation",value:function w(B){this._operations.push(B)}},{key:"isOperationSelected",value:function v(B){var C=this._operations.map(function(D){return D.prototype.identifier});return C.indexOf(B)!==-1}},{key:"identifier",get:function(){return null}},{key:"context",get:function(){return{operations:this._operations,helpers:this._helpers,options:this._options}}},{key:"container",get:function(){return this._options.container}},{key:"operations",get:function(){return this._operations}},{key:"options",get:function(){return this._options}},{key:"canvas",get:function(){return this._canvas}},{key:"helpers",get:function(){return this._helpers}},{key:"image",get:function(){return this._options.image}}]);return A})(l["default"]);i["default"]=n;e.exports=i["default"]},function(d,w,g){Object.defineProperty(w,"__esModule",{value:true});var s=(function(){function x(B,z){for(var y=0;y<z.length;y++){var A=z[y];A.enumerable=A.enumerable||false;A.configurable=true;if("value" in A){A.writable=true}Object.defineProperty(B,A.key,A)}}return function(A,y,z){if(y){x(A.prototype,y)}if(z){x(A,z)}return A}})();var b=function u(C,B,A){var D=true;_function:while(D){var y=C,G=B,x=A;z=F=E=undefined;D=false;var z=Object.getOwnPropertyDescriptor(y,G);if(z===undefined){var F=Object.getPrototypeOf(y);if(F===null){return undefined}else{C=F;B=G;A=x;D=true;continue _function}}else{if("value" in z){return z.value}else{var E=z.get;if(E===undefined){return undefined}return E.call(x)}}}};function c(x){return x&&x.__esModule?x:{"default":x}}function i(x,y){if(!(x instanceof y)){throw new TypeError("Cannot call a class as a function")}}function p(y,x){if(typeof x!=="function"&&x!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof x)}y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,enumerable:false,writable:true,configurable:true}});if(x){y.__proto__=x}}var l=g(56);var h=c(l);var t=g(55);var j=c(t);var n=g(50);var e=c(n);var v=g(5);var r=c(v);var q=g(74);var k=c(q);var m=g(57);var f=c(m);var o=(function(Q){function O(Y,Z,X){i(this,O);b(Object.getPrototypeOf(O.prototype),"constructor",this).call(this);this._kit=Y;this._ui=Z;this._options=X;var W=this._ui.container;this._canvasContainer=W.querySelector(".imglykit-canvas-container");this._canvasInnerContainer=W.querySelector(".imglykit-canvas-inner-container");this._canvas=this._canvasContainer.querySelector("canvas");this._image=this._options.image;this._roundZoomBy=0.1;this._isFirstRender=true;this._dragOnMousedown=this._dragOnMousedown.bind(this);this._dragOnMousemove=this._dragOnMousemove.bind(this);this._dragOnMouseup=this._dragOnMouseup.bind(this)}p(O,Q);s(O,[{key:"run",value:function M(){this._initRenderer();this._zoomLevel=this._getInitialZoomLevel();this._initialZoomLevel=this._zoomLevel;this._isInitialZoom=true;this._size=null;this.render();this._centerCanvas();this._handleDrag()}},{key:"render",value:function V(){var ac=this;this._initialZoomLevel=this._getInitialZoomLevel();if(this._isInitialZoom){this.setZoomLevel(this._initialZoomLevel,false)}var aa=new e["default"](this._image.width,this._image.height);var ab=aa.multiply(this._zoomLevel);this._setCanvasSize(ab);this._renderer.reset();var W=this.sanitizedStack;this._updateStackDirtyStates(W);var Z=[];for(var Y=0;Y<W.length;Y++){var X=W[Y];Z.push(X.validateSettings())}return f["default"].all(Z).then(function(){if(ac._isFirstRender&&ac._renderer.identifier==="webgl"){if(ac._image.width>ac._renderer.maxTextureSize||ac._image.height>ac._renderer.maxTextureSize){ac._ui.displayLoadingMessage("Resizing...");return new f["default"](function(ae,ad){setTimeout(function(){ac._renderer.prepareImage(ac._image).then(function(af){ac._ui.hideLoadingMessage();ac._options.image=af;ac._image=ac._options.image;ae()})["catch"](function(af){ad(af)})},100)})}}}).then(function(){if(ac._isFirstRender||ac._renderer.constructor.identifier==="canvas"){ac._isFirstRender=false;return ac._renderer.drawImage(ac._image)}}).then(function(){var af=[];for(var ae=0;ae<W.length;ae++){var ad=W[ae];af.push(ad.render(ac._renderer))}return f["default"].all(af)}).then(function(){return ac._renderer.renderFinal()}).then(function(){ac._storeCanvasSize();ac._updateContainerSize();ac._updateCanvasMargins();ac._applyBoundaries()})["catch"](function(ad){console.log(ad)})}},{key:"setImage",value:function x(W){this._image=W;this.reset();this.render();this._centerCanvas()}},{key:"zoomIn",value:function R(){this._isInitialZoom=false;var X=Math.round(this._zoomLevel*100);var W=Math.round(this._roundZoomBy*100);var Y=Math.round(this._initialZoomLevel*100);if(X%W!==0){X=Math.ceil(X/W)*W}else{X+=W}X=Math.min(Y*2,X);return this.setZoomLevel(X/100)}},{key:"zoomOut",value:function L(){this._isInitialZoom=false;var X=Math.round(this._zoomLevel*100);var W=Math.round(this._roundZoomBy*100);var Y=Math.round(this._initialZoomLevel*100);if(X%W!==0){X=Math.floor(X/W)*W}else{X-=W}X=Math.max(Y,X);return this.setZoomLevel(X/100)}},{key:"_setCanvasSize",value:function A(W){W=W||new e["default"](this._canvas.width,this._canvas.height);this._canvas.width=W.x;this._canvas.height=W.y;this._storeCanvasSize();this._updateContainerSize()}},{key:"_updateContainerSize",value:function E(){var W=this._size;this._canvasInnerContainer.style.width=""+W.x+"px";this._canvasInnerContainer.style.height=""+W.y+"px"}},{key:"_storeCanvasSize",value:function z(){this._size=new e["default"](this._canvas.width,this._canvas.height)}},{key:"_centerCanvas",value:function I(){var W=this._maxSize.divide(2);this._canvasInnerContainer.style.left=""+W.x+"px";this._canvasInnerContainer.style.top=""+W.y+"px";this._updateCanvasMargins()}},{key:"_updateCanvasMargins",value:function S(){var W=new e["default"](this._canvas.width,this._canvas.height);var X=W.divide(2).multiply(-1);this._canvasInnerContainer.style.marginLeft=""+X.x+"px";this._canvasInnerContainer.style.marginTop=""+X.y+"px"}},{key:"setZoomLevel",value:function H(Z){var Y=this;var X=arguments[1]===undefined?true:arguments[1];var W=arguments[2]===undefined?false:arguments[2];this._zoomLevel=Z;this._isInitialZoom=W;if(X){this.setAllOperationsToDirty();return this.render().then(function(){Y._updateCanvasMargins();Y._applyBoundaries();Y.emit("zoom")})}else{this._updateCanvasMargins();this._applyBoundaries();this.emit("zoom")}}},{key:"setAllOperationsToDirty",value:function J(){var Y=this._kit.operationsStack;for(var X=0;X<Y.length;X++){var W=Y[X];if(!W){continue}W.dirty=true}}},{key:"_getInitialZoomLevel",value:function G(){var ab=new e["default"](this._image.width,this._image.height);var Z=this._ui.operations.crop;var Y=this._ui.operations.rotation;var X=undefined,W=undefined,ad=undefined,ac=undefined;if(Z){X=Z.getEnd().clone().subtract(Z.getStart())}else{X=new e["default"](1,1)}W=ab.clone().multiply(X);if(Y&&Y.getDegrees()%180!==0){var aa=W.x;W.x=W.y;W.y=aa}ad=r["default"].resizeVectorToFit(W,this._maxSize);if(Y&&Y.getDegrees()%180!==0){var aa=ad.x;ad.x=ad.y;ad.y=aa}ac=ad.clone().divide(X);return ac.x/ab.x}},{key:"_initRenderer",value:function U(){var W=this;if(h["default"].isSupported()&&this._options.renderer!=="canvas"){this._renderer=new h["default"](null,this._canvas);this._webglEnabled=true}else{if(j["default"].isSupported()){this._renderer=new j["default"](null,this._canvas);this._webglEnabled=false}}if(this._renderer===null){throw new Error("Neither Canvas nor WebGL renderer are supported.")}this._renderer.on("new-canvas",function(X){W._setCanvas(X)})}},{key:"_setCanvas",value:function D(W){var X=this._canvas.parentNode;X.removeChild(this._canvas);this._canvas=W;X.appendChild(this._canvas);this._updateCanvasMargins();this._applyBoundaries();this._updateContainerSize()}},{key:"_handleDrag",value:function N(){this._canvas.addEventListener("mousedown",this._dragOnMousedown);this._canvas.addEventListener("touchstart",this._dragOnMousedown)}},{key:"_dragOnMousedown",value:function F(Z){if(Z.type==="mousedown"&&Z.button!==0){return}Z.preventDefault();var W=Z.pageX;var aa=Z.pageY;if(Z.type==="touchstart"){W=Z.touches[0].pageX;aa=Z.touches[0].pageY}var Y=parseInt(this._canvasInnerContainer.style.left,10);var X=parseInt(this._canvasInnerContainer.style.top,10);document.addEventListener("mousemove",this._dragOnMousemove);document.addEventListener("touchmove",this._dragOnMousemove);document.addEventListener("mouseup",this._dragOnMouseup);document.addEventListener("touchend",this._dragOnMouseup);this._initialMousePosition=new e["default"](W,aa);this._initialCanvasPosition=new e["default"](Y,X)}},{key:"_dragOnMousemove",value:function K(Z){Z.preventDefault();var W=Z.pageX,ab=Z.pageY;if(Z.type==="touchmove"){W=Z.touches[0].pageX;ab=Z.touches[0].pageY}var Y=new e["default"](W,ab);var aa=Y.clone().subtract(this._initialMousePosition);var X=this._initialCanvasPosition.clone().add(aa);this._canvasInnerContainer.style.left=""+X.x+"px";this._canvasInnerContainer.style.top=""+X.y+"px";this._applyBoundaries()}},{key:"_applyBoundaries",value:function C(){var W=parseInt(this._canvasInnerContainer.style.left,10);var Z=parseInt(this._canvasInnerContainer.style.top,10);var Y=new e["default"](W,Z);var X=this._boundaries;Y.x=Math.min(X.max.x,Math.max(X.min.x,Y.x));Y.y=Math.min(X.max.y,Math.max(X.min.y,Y.y));this._canvasInnerContainer.style.left=""+Y.x+"px";this._canvasInnerContainer.style.top=""+Y.y+"px"}},{key:"_dragOnMouseup",value:function y(W){W.preventDefault();document.removeEventListener("mousemove",this._dragOnMousemove);document.removeEventListener("touchmove",this._dragOnMousemove);document.removeEventListener("mouseup",this._dragOnMouseup);document.removeEventListener("touchend",this._dragOnMouseup)}},{key:"_updateStackDirtyStates",value:function B(W){var Y=false;for(var Z=0;Z<W.length;Z++){var X=W[Z];if(!X){continue}if(X.dirty){Y=true}if(Y){X.dirty=true}}}},{key:"zoomToFit",value:function P(){var W=arguments[0]===undefined?true:arguments[0];var X=this._getInitialZoomLevel();return this.setZoomLevel(X,W,true)}},{key:"reset",value:function T(){this._renderer.reset(true);this._kit.operationsStack=[];this._isFirstRender=true}},{key:"_boundaries",get:function(){var W=new e["default"](this._canvas.width,this._canvas.height);var aa=this._maxSize;var Y=W.clone().subtract(aa).multiply(-1);var X={min:new e["default"](Y.x,Y.y),max:new e["default"](0,0)};if(W.x<aa.x){X.min.x=Y.x/2;X.max.x=Y.x/2}if(W.y<aa.y){X.min.y=Y.y/2;X.max.y=Y.y/2}var Z=W.clone().divide(2);X.min.add(Z);X.max.add(Z);return X}},{key:"_maxSize",get:function(){return new e["default"](this._canvasContainer.offsetWidth,this._canvasContainer.offsetHeight)}},{key:"sanitizedStack",get:function(){var Y=[];for(var X=0;X<this._kit.operationsStack.length;X++){var W=this._kit.operationsStack[X];if(!W){continue}Y.push(W)}return Y}},{key:"zoomLevel",get:function(){return this._zoomLevel}},{key:"size",get:function(){return this._size}}]);return O})(k["default"]);w["default"]=o;d.exports=w["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var b=c(74);var k=m(b);var j=(function(n){function v(z,A){h(this,v);i(Object.getPrototypeOf(v.prototype),"constructor",this).call(this);this._kit=z;this._ui=A;this._dragCounter=0;this._container=this._ui.container.querySelector(".imglykit-splash-container");this._onDropAreaDragEnter=this._onDropAreaDragEnter.bind(this);this._onDropAreaDragOver=this._onDropAreaDragOver.bind(this);this._onDropAreaDragLeave=this._onDropAreaDragLeave.bind(this);this._onDropAreaDrop=this._onDropAreaDrop.bind(this);this._onDropAreaClick=this._onDropAreaClick.bind(this);this._onFileInputChange=this._onFileInputChange.bind(this);this._hiddenInputField=this._ui.container.querySelector(".imglykit-upload-hidden-input");this._hiddenInputField.addEventListener("change",this._onFileInputChange);this._handleDropArea();if(this._ui.options.image){this.removeDOM()}}l(v,n);f(v,[{key:"openFileDialog",value:function x(){this._hiddenInputField.click()}},{key:"_handleDropArea",value:function u(){this._dropArea=this._container.querySelector(".imglykit-splash-row--upload");this._dropArea.addEventListener("dragenter",this._onDropAreaDragEnter);this._dropArea.addEventListener("dragover",this._onDropAreaDragOver);this._dropArea.addEventListener("dragleave",this._onDropAreaDragLeave);this._dropArea.addEventListener("drop",this._onDropAreaDrop);this._dropArea.addEventListener("dragdrop",this._onDropAreaDrop);this._dropArea.addEventListener("click",this._onDropAreaClick)}},{key:"_onDropAreaClick",value:function s(){this.openFileDialog()}},{key:"_onDropAreaDragEnter",value:function y(z){z.preventDefault();this._dragCounter++;this._dropArea.classList.add("imglykit-splash-active")}},{key:"_onDropAreaDragOver",value:function o(z){z.preventDefault()}},{key:"_onDropAreaDragLeave",value:function q(z){z.preventDefault();this._dragCounter--;if(this._dragCounter===0){this._dropArea.classList.remove("imglykit-splash-active")}}},{key:"_onDropAreaDrop",value:function t(z){z.stopPropagation();z.preventDefault();z.returnValue=false;this._dropArea.classList.remove("imglykit-splash-active");if(!z.dataTransfer){return}this._handleFile(z.dataTransfer.files[0])}},{key:"_onFileInputChange",value:function p(){this._handleFile(this._hiddenInputField.files[0])}},{key:"_handleFile",value:function r(z){this.emit("file",z)}},{key:"removeDOM",value:function w(){this._dropArea.removeEventListener("dragenter",this._onDropAreaDragEnter);this._dropArea.removeEventListener("dragover",this._onDropAreaDragOver);this._dropArea.removeEventListener("dragleave",this._onDropAreaDragLeave);this._dropArea.removeEventListener("drop",this._onDropAreaDrop);this._dropArea.removeEventListener("dragdrop",this._onDropAreaDrop);this._dropArea.removeEventListener("click",this._onDropAreaClick);if(this._container){this._container.style.display="none"}}}]);return v})(k["default"]);g["default"]=j;d.exports=g["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function o(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var b=c(74);var m=o(b);var g=c(5);var q=o(g);var h=c(50);var l=o(h);var p=(function(v){function u(y,z){j(this,u);k(Object.getPrototypeOf(u.prototype),"constructor",this).call(this);this._kit=y;this._ui=z;var x=this._ui.container;this._canvasContainer=x.querySelector(".imglykit-canvas-container");this._video=x.querySelector(".imglykit-webcam-video");this._webcamButton=x.querySelector(".imglykit-webcam-button");this._webcamButton.addEventListener("click",this._onWebcamButtonClick.bind(this));this._initVideoStream()}n(u,v);f(u,[{key:"_onWebcamButtonClick",value:function w(A){var B=this;A.preventDefault();var x=document.createElement("canvas");x.width=this._video.videoWidth;x.height=this._video.videoHeight;var y=x.getContext("2d");y.drawImage(this._video,0,0);this._stream.stop();this._video.pause();delete this._stream;delete this._video;var z=new Image();z.addEventListener("load",function(){B.emit("image",z)});z.src=x.toDataURL("image/png")}},{key:"_initVideoStream",value:function s(){var x=this;var y=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(!y){throw new Error("Webcam feature not supported! :(")}y.call(navigator,{video:true},function(z){x._stream=z;x._video.onloadedmetadata=x._onVideoReady.bind(x);x._video.src=window.URL.createObjectURL(z)},function(z){throw z})}},{key:"_onVideoReady",value:function t(){this._resizeVideo()}},{key:"_resizeVideo",value:function r(){var x=this._video;var D=x.videoWidth;var y=x.videoHeight;var z=new l["default"](D,y);var C=new l["default"](this._canvasContainer.offsetWidth,this._canvasContainer.offsetHeight);var B=q["default"].resizeVectorToFit(z,C);this._video.style.width=""+B.x+"px";this._video.style.height=""+B.y+"px";var A=C.clone().subtract(B).divide(2);this._video.style.marginLeft=""+A.x+"px";this._video.style.marginTop=""+A.y+"px"}},{key:"getUserMedia",get:function(){return}}]);return u})(m["default"]);i["default"]=p;d.exports=i["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var b=c(74);var j=m(b);var k=(function(A){function o(F,G){h(this,o);i(Object.getPrototypeOf(o.prototype),"constructor",this).call(this);this._kit=F;this._ui=G;this.init()}l(o,A);f(o,[{key:"init",value:function B(){this._canvas=this._ui.canvas}},{key:"run",value:function u(){var F=this._ui.container;this._rightControls=F.querySelector(".imglykit-top-controls-right");this._leftControls=F.querySelector(".imglykit-top-controls-left");this._undoButton=F.querySelector(".imglykit-undo");this._zoomIn=F.querySelector(".imglykit-zoom-in");this._zoomOut=F.querySelector(".imglykit-zoom-out");this._zoomLevel=F.querySelector(".imglykit-zoom-level-num");this._newButton=F.querySelector(".imglykit-new");this._exportButton=F.querySelector(".imglykit-export");this._handleZoom();this._handleUndo();this._handleNew();this._handleExport()}},{key:"_handleZoom",value:function D(){this._zoomIn.addEventListener("click",this._onZoomInClick.bind(this));this._zoomOut.addEventListener("click",this._onZoomOutClick.bind(this))}},{key:"_handleUndo",value:function C(){this._undoButton.addEventListener("click",this._undo.bind(this));this._undo()}},{key:"_handleNew",value:function w(){if(!this._newButton){return}this._newButton.addEventListener("click",this._onNewClick.bind(this))}},{key:"_handleExport",value:function p(){if(!this._exportButton){return}this._exportButton.addEventListener("click",this._onExportClick.bind(this))}},{key:"_onNewClick",value:function y(F){F.preventDefault();this.emit("new")}},{key:"_onExportClick",value:function n(F){F.preventDefault();this.emit("export")}},{key:"_undo",value:function v(){this.emit("undo")}},{key:"updateUndoButton",value:function s(){var F=this._ui.history;if(F.length===0){this._undoButton.style.display="none"}else{this._undoButton.style.display="inline-block"}}},{key:"updateExportButton",value:function q(){if(!this._exportButton){return}var F=this._ui.image;if(F){this._exportButton.style.display="inline-block"}else{this._exportButton.style.display="none"}}},{key:"_onZoomInClick",value:function x(F){F.preventDefault();this.emit("zoom-in");this.updateZoomLevel()}},{key:"_onZoomOutClick",value:function r(F){F.preventDefault();this.emit("zoom-out");this.updateZoomLevel()}},{key:"showZoom",value:function t(){this._rightControls.style.display="inline-block"}},{key:"hideZoom",value:function E(){this._rightControls.style.display="none"}},{key:"updateZoomLevel",value:function z(){var F=this._canvas.zoomLevel;this._zoomLevel.innerHTML=Math.round(F*100)}}]);return o})(j["default"]);g["default"]=k;d.exports=g["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function l(n){return n&&n.__esModule?n:{"default":n}}function j(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}var g=c(5);var m=l(g);var h=c(50);var k=l(h);var e=18;var b=(function(){function o(C){j(this,o);this._container=C;this._isDragging=false;this._isHovering=false;this._appendDOM();this._resizeButton();this._updateValues();this._onButtonDown=this._onButtonDown.bind(this);this._onButtonMove=this._onButtonMove.bind(this);this._onButtonUp=this._onButtonUp.bind(this);this._onContainerEnter=this._onContainerEnter.bind(this);this._onContainerLeave=this._onContainerLeave.bind(this);this._onBackgroundClick=this._onBackgroundClick.bind(this);this._container.addEventListener("mouseenter",this._onContainerEnter);this._container.addEventListener("mouseleave",this._onContainerLeave);this._container.addEventListener("mousemove",this._onContainerEnter);this._dom.button.addEventListener("mousedown",this._onButtonDown);this._dom.button.addEventListener("touchstart",this._onButtonDown);this._dom.background.addEventListener("click",this._onBackgroundClick);this._list.addEventListener("scroll",this._onListScroll.bind(this));this._onListScroll()}f(o,[{key:"_onBackgroundClick",value:function A(E){E.preventDefault();if(E.target!==this._dom.background){return}var C=m["default"].getEventPosition(E);var F=this._dom.background.getBoundingClientRect();F=new k["default"](F.left,F.top);var D=C.clone().subtract(F);D.x-=this._values.button.width*0.5;this._setButtonPosition(D.x)}},{key:"_onContainerEnter",value:function u(){this._isHovering=true;this.show()}},{key:"_onContainerLeave",value:function x(){this._isHovering=false;this.hide()}},{key:"show",value:function y(){if(!this._isScrollingNecessary){return}this._dom.background.classList.add("visible")}},{key:"hide",value:function v(){if(this._isDragging){return}this._dom.background.classList.remove("visible")}},{key:"_updateValues",value:function r(){this._values={list:{totalWidth:this._list.scrollWidth,visibleWidth:this._list.offsetWidth,scrollableWidth:this._list.scrollWidth-this._list.offsetWidth},button:{width:this._dom.button.offsetWidth,scrollableWidth:this._dom.background.offsetWidth-this._dom.button.offsetWidth}}}},{key:"_onButtonDown",value:function B(C){C.preventDefault();this._isDragging=true;this._initialMousePosition=m["default"].getEventPosition(C);this._initialButtonPosition=this._buttonPosition||0;document.addEventListener("mousemove",this._onButtonMove);document.addEventListener("touchmove",this._onButtonMove);document.addEventListener("mouseup",this._onButtonUp);document.addEventListener("touchend",this._onButtonUp)}},{key:"_onButtonMove",value:function s(C){C.preventDefault();var F=m["default"].getEventPosition(C);var D=F.clone().subtract(this._initialMousePosition);var E=this._initialButtonPosition+D.x;this._setButtonPosition(E)}},{key:"_setButtonPosition",value:function q(E){E=Math.max(0,E);E=Math.min(E,this._values.button.scrollableWidth);this._buttonPosition=E;this._dom.button.style.left=""+this._buttonPosition+"px";var D=E/this._values.button.scrollableWidth;var C=this._values.list.scrollableWidth*D;this._list.scrollLeft=C}},{key:"_onButtonUp",value:function n(){this._isDragging=false;document.removeEventListener("mousemove",this._onButtonMove);document.removeEventListener("touchmove",this._onButtonMove);document.removeEventListener("mouseup",this._onButtonUp);document.removeEventListener("touchend",this._onButtonUp)}},{key:"_onListScroll",value:function p(){if(this._isDragging){return}var F=this._list.scrollWidth-this._list.offsetWidth;var C=this._list.scrollLeft;var E=this._dom.background.offsetWidth-this._dom.button.offsetWidth;var D=C/F;this._buttonPosition=E*D;this._dom.button.style.left=""+this._buttonPosition+"px"}},{key:"_resizeButton",value:function w(){var C=this._list.scrollWidth;var D=this._list.offsetWidth;this._buttonWidth=D/C*D;this._dom.button.style.width=""+this._buttonWidth+"px"}},{key:"_appendDOM",value:function z(){var E=document.createElement("div");E.classList.add("imglykit-scrollbar-background");E.style.bottom=""+e+"px";var D=document.createElement("div");D.classList.add("imglykit-scrollbar-button");E.appendChild(D);this._container.appendChild(E);this._container.style.position="relative";this._list=this._container.querySelector(".imglykit-controls-list");this._dom={background:E,button:D};this._list.style.height="";var C=this._list.offsetHeight;C+=e;this._container.style.height=""+C+"px";this._list.style.height=""+C+"px"}},{key:"remove",value:function t(){this._dom.button.removeEventListener("mousedown",this._onButtonDown);this._dom.button.removeEventListener("touchstart",this._onButtonDown);this._dom.background.parentNode.removeChild(this._dom.background)}},{key:"_isScrollingNecessary",get:function(){return this._list.scrollWidth>this._list.offsetWidth}}]);return o})();i["default"]=b;d.exports=i["default"]},function(c,i,b){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var h=b(95);var l=n(h);var g=b(5);var o=n(g);var e=(function(p){function s(){j(this,s);if(p!=null){p.apply(this,arguments)}}m(s,p);f(s,[{key:"init",value:function z(){var A=function(G){var E='<div class="imglykit-controls-list-container"> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';for(var D in G.filters){E+=" ";var F=G.filters[D];E+=" ";var C=F.prototype.name;E+=" ";var B=G.activeFilter.identifier===D;E+=' <li data-identifier="'+(D)+'" class="imglykit-controls-item-with-label';if(B){E+=" imglykit-controls-item-active"}E+='"> <img src="'+(G.helpers.assetPath("ui/night/filters/"+D+".png"))+'" /> <div class="imglykit-controls-item-label">'+(C)+"</div> </li> "}E+=" </ul></div>";return E};this._controlsTemplate=A;this._availableFilters={};this._filters={};this._addDefaultFilters();this.selectFilters(null)}},{key:"_renderAllControls",value:function w(){for(var A=arguments.length,B=Array(A),C=0;C<A;C++){B[C]=arguments[C]}this._operationExistedBefore=!!this._ui.operations.filters;this._operation=this._ui.getOrCreateOperation("filters");k(Object.getPrototypeOf(s.prototype),"_renderAllControls",this).apply(this,B)}},{key:"_onEnter",value:function t(){var D=this;this._historyItem=null;this._initialFilter=this._operation.getFilter();this._defaultFilter=this._operation.availableOptions.filter["default"];var B=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(B);var C=function(E){var F=D._listItems[E];F.addEventListener("click",function(){D._onListItemClick(F)})};for(var A=0;A<this._listItems.length;A++){C(A)}}},{key:"_onBack",value:function x(){var A=this._operation.getFilter();if(A===this._defaultFilter){this._ui.removeOperation("filters")}this._ui.canvas.render()}},{key:"_onListItemClick",value:function u(C){this._deactivateAllItems();var B=C.getAttribute("data-identifier");this._operation.setFilter(this._filters[B]);this._ui.canvas.render();C.classList.add("imglykit-controls-item-active");var A=this._operation.getFilter();if(A!==this._initialFilter&&!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{filter:this._initialFilter},this._operationExistedBefore)}}},{key:"_deactivateAllItems",value:function q(){for(var A=0;A<this._listItems.length;A++){var B=this._listItems[A];B.classList.remove("imglykit-controls-item-active")}}},{key:"_addDefaultFilters",value:function y(){this.addFilter(b(71));this.addFilter(b(34));this.addFilter(b(35));this.addFilter(b(36));this.addFilter(b(37));this.addFilter(b(30));this.addFilter(b(23));this.addFilter(b(42));this.addFilter(b(27));this.addFilter(b(31));this.addFilter(b(28));this.addFilter(b(49));this.addFilter(b(24));this.addFilter(b(25));this.addFilter(b(38));this.addFilter(b(45));this.addFilter(b(44));this.addFilter(b(43));this.addFilter(b(29));this.addFilter(b(32));this.addFilter(b(26));this.addFilter(b(48));this.addFilter(b(41));this.addFilter(b(39));this.addFilter(b(33));this.addFilter(b(40));this.addFilter(b(47));this.addFilter(b(22));this.addFilter(b(46))}},{key:"addFilter",value:function v(A){this._availableFilters[A.identifier]=A}},{key:"selectFilters",value:function r(A){this._filters={};var E=Object.keys(this._availableFilters);var B=o["default"].select(E,A);for(var D=0;D<B.length;D++){var C=B[D];this._filters[C]=this._availableFilters[C]}if(this._active){this._renderControls()}}},{key:"context",get:function(){return{filters:this._filters,activeFilter:this._operation.getFilter()}}}]);return s})(l["default"]);e.prototype.identifier="filters";i["default"]=e;c.exports=i["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var d=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var e=b(95);var k=m(e);var f=b(50);var i=m(f);var j=(function(n){function r(){h(this,r);if(n!=null){n.apply(this,arguments)}}l(r,n);d(r,[{key:"init",value:function v(){var w=function(z){var y='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> <li data-degrees="-90"> <img src="'+(z.helpers.assetPath("ui/night/rotation/left.png"))+'" /> </li> <li data-degrees="90"> <img src="'+(z.helpers.assetPath("ui/night/rotation/right.png"))+'" /> </li> </ul></div>';return y};this._controlsTemplate=w;var x=function(z){var y='<div class="imglykit-canvas-crop-container imglykit-canvas-crop-container-hidden"> <div class="imglykit-canvas-crop-top"> <div class="imglykit-canvas-crop-top-left"></div> <div class="imglykit-canvas-crop-top-center"></div> <div class="imglykit-canvas-crop-top-right"></div> </div> <div class="imglykit-canvas-crop-center"> <div class="imglykit-canvas-crop-center-left"></div> <div class="imglykit-canvas-crop-center-center imglykit-canvas-crop-center-center-nomove"> </div> <div class="imglykit-canvas-crop-center-right"></div> </div> <div class="imglykit-canvas-crop-bottom"> <div class="imglykit-canvas-crop-bottom-left"></div> <div class="imglykit-canvas-crop-bottom-center"></div> <div class="imglykit-canvas-crop-bottom-right"></div> </div></div>';return y};this._canvasControlsTemplate=x}},{key:"_onEnter",value:function o(){var A=this;this._historyItem=null;this._operationExistedBefore=!!this._ui.operations.rotation;this._operation=this._ui.getOrCreateOperation("rotation");this._operation.dirty=true;this._cropOperation=this._ui.operations.crop;if(this._cropOperation){if(!this._initialStart&&!this._initialEnd){this._initialStart=this._cropOperation.getStart().clone();this._initialEnd=this._cropOperation.getEnd().clone()}this._cropOperation.set({start:new i["default"](0,0),end:new i["default"](1,1)})}this._initialZoomLevel=this._ui.canvas.zoomLevel;this._ui.canvas.zoomToFit(false);this._initialDegrees=this._operation.getDegrees();var y=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(y);var z=function(B){var C=A._listItems[B];C.addEventListener("click",function(){A._onListItemClick(C)})};for(var w=0;w<this._listItems.length;w++){z(w)}var x=".imglykit-canvas-crop";this._cropAreas={topLeft:this._canvasControls.querySelector(""+x+"-top-left"),topCenter:this._canvasControls.querySelector(""+x+"-top-center"),centerLeft:this._canvasControls.querySelector(""+x+"-center-left"),centerCenter:this._canvasControls.querySelector(""+x+"-center-center")};this._ui.canvas.render().then(function(){A._showCropContainer();A._updateCropDOM()})}},{key:"_showCropContainer",value:function p(){var w=this._canvasControls.querySelector(".imglykit-canvas-crop-container");w.classList.remove("imglykit-canvas-crop-container-hidden")}},{key:"_onListItemClick",value:function q(x){var w=this;var z=x.getAttribute("data-degrees");z=parseInt(z,10);var y=this._operation.getDegrees();if(!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{degrees:this._initialDegrees},this._operationExistedBefore)}this._operation.setDegrees(y+z);this._ui.canvas.zoomToFit().then(function(){w._updateCropDOM()})}},{key:"onZoom",value:function u(){this._updateCropDOM()}},{key:"_updateCropDOM",value:function s(){var x=undefined,z=undefined;if(this._cropOperation){x=this._initialStart.clone();z=this._initialEnd.clone()}else{x=new i["default"](0,0);z=new i["default"](1,1)}var E=this._ui.canvas.size;var C=x.multiply(E);var B=z.multiply(E);var F=B.clone().subtract(C);var A=Math.max(1,C.y);var y=Math.max(1,C.x);var w=Math.max(1,F.x);var D=Math.max(1,F.y);this._cropAreas.topLeft.style.width=""+y+"px";this._cropAreas.topCenter.style.width=""+w+"px";this._cropAreas.topLeft.style.height=""+A+"px";this._cropAreas.centerLeft.style.height=""+D+"px"}},{key:"_onBack",value:function t(){var w=this._operation.getDegrees();if(w===0){this._ui.removeOperation("rotation")}if(this._cropOperation){this._cropOperation.set({start:this._initialStart,end:this._initialEnd})}this._ui.canvas.setZoomLevel(this._initialZoomLevel,true)}}]);return r})(k["default"]);j.prototype.identifier="rotation";g["default"]=j;c.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function j(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var e=b(95);var i=k(e);var h=(function(n){function p(){g(this,p);if(n!=null){n.apply(this,arguments)}}j(p,n);d(p,[{key:"init",value:function r(){var s=function(u){var t='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> <li data-direction="horizontal"> <img src="'+(u.helpers.assetPath("ui/night/flip/horizontal.png"))+'" /> </li> <li data-direction="vertical"> <img src="'+(u.helpers.assetPath("ui/night/flip/vertical.png"))+'" /> </li> </ul></div>';return t};this._controlsTemplate=s}},{key:"_onEnter",value:function q(){var v=this;this._historyItem=null;this._operationExistedBefore=!!this._ui.operations.flip;this._operation=this._ui.getOrCreateOperation("flip");this._initialHorizontal=this._operation.getHorizontal();this._initialVertical=this._operation.getVertical();var t=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(t);var u=function(w){var x=v._listItems[w];x.addEventListener("click",function(){v._onListItemClick(x)});var y=x.getAttribute("data-direction");if(y==="horizontal"&&v._operation.getHorizontal()){v._toggleItem(x,true)}else{if(y==="vertical"&&v._operation.getVertical()){v._toggleItem(x,true)}}};for(var s=0;s<this._listItems.length;s++){u(s)}}},{key:"_onListItemClick",value:function m(t){var v=t.getAttribute("data-direction");var u=false;var s=this._operation.getHorizontal();var w=this._operation.getVertical();if(v==="horizontal"){this._operation.setHorizontal(!s);s=!s;this._ui.canvas.render();u=!s}else{if(v==="vertical"){this._operation.setVertical(!w);w=!w;this._ui.canvas.render();u=!w}}if((this._initialVertical!==w||this._initialHorizontal!==s)&&!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{vertical:this._initialVertical,horizontal:this._initialHorizontal},this._operationExistedBefore)}this._toggleItem(t,u)}},{key:"_toggleItem",value:function l(t,u){var s="imglykit-controls-item-active";if(u){t.classList.add(s)}else{t.classList.remove(s)}}},{key:"_onBack",value:function o(){var t=this._operation.getVertical();var s=this._operation.getHorizontal();if(!t&&!s){this._ui.removeOperation("flip")}this._ui.canvas.render()}}]);return p})(i["default"]);h.prototype.identifier="flip";f["default"]=h;c.exports=f["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function m(n){return n&&n.__esModule?n:{"default":n}}function j(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var f=b(95);var k=m(f);var i=b(102);var g=m(i);var d=(function(o){function s(){j(this,s);if(o!=null){o.apply(this,arguments)}}l(s,o);e(s,[{key:"init",value:function r(){var t=function(v){var u="<div> "+(v.partials.slider)+"</div>";return u};this._controlsTemplate=t;this._partialTemplates.slider=g["default"].template;this._onUpdate=this._onUpdate.bind(this)}},{key:"_onEnter",value:function q(){this._historyItem=null;this._operationExistedBefore=!!this._ui.operations.brightness;this._operation=this._ui.getOrCreateOperation("brightness");var t=this._operation.getBrightness();this._initialBrightness=t;var u=this._controls.querySelector(".imglykit-slider");this._slider=new g["default"](u,{minValue:-1,maxValue:1,defaultValue:t});this._slider.on("update",this._onUpdate);this._slider.setValue(t)}},{key:"_onBack",value:function p(){var t=this._operation.getBrightness();if(t===1){this._ui.removeOperation("brightness")}this._ui.canvas.render();this._slider=null}},{key:"_onUpdate",value:function n(t){this._operation.setBrightness(t);this._ui.canvas.render();if(!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{brightness:this._initialBrightness},this._operationExistedBefore)}}}]);return s})(k["default"]);d.prototype.identifier="brightness";h["default"]=d;c.exports=h["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var d=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function m(n){return n&&n.__esModule?n:{"default":n}}function j(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var e=b(95);var k=m(e);var i=b(102);var f=m(i);var h=(function(p){function n(){j(this,n);if(p!=null){p.apply(this,arguments)}}l(n,p);d(n,[{key:"init",value:function s(){var t=function(v){var u="<div> "+(v.partials.slider)+"</div>";return u};this._controlsTemplate=t;this._partialTemplates.slider=f["default"].template}},{key:"_onEnter",value:function r(){this._historyItem=null;this._operationExistedBefore=!!this._ui.operations.contrast;this._operation=this._ui.getOrCreateOperation("contrast");var t=this._operation.getContrast();this._initialContrast=t;var u=this._controls.querySelector(".imglykit-slider");this._slider=new f["default"](u,{minValue:0,maxValue:2,defaultValue:t});this._slider.on("update",this._onUpdate.bind(this));this._slider.setValue(this._initialContrast)}},{key:"_onBack",value:function q(){var t=this._operation.getContrast();if(t===1){this._ui.removeOperation("contrast")}this._ui.canvas.render()}},{key:"_onUpdate",value:function o(u){this._operation.setContrast(u);this._ui.canvas.render();var t=this._operation.getContrast();if(this._initialContrast!==t&&!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{contrast:this._initialContrast},this._operationExistedBefore)}}}]);return n})(k["default"]);h.prototype.identifier="contrast";g["default"]=h;c.exports=g["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var d=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var i=b(102);var f=m(i);var e=b(95);var j=m(e);var k=(function(o){function q(){h(this,q);if(o!=null){o.apply(this,arguments)}}l(q,o);d(q,[{key:"init",value:function s(){var t=function(v){var u="<div> "+(v.partials.slider)+"</div>";return u};this._controlsTemplate=t;this._partialTemplates.slider=f["default"].template}},{key:"_onEnter",value:function r(){this._historyItem=null;this._operationExistedBefore=!!this._ui.operations.saturation;this._operation=this._ui.getOrCreateOperation("saturation");var t=this._operation.getSaturation();this._initialSaturation=t;var u=this._controls.querySelector(".imglykit-slider");this._slider=new f["default"](u,{minValue:0,maxValue:2,defaultValue:t});this._slider.on("update",this._onUpdate.bind(this));this._slider.setValue(this._initialSaturation)}},{key:"_onBack",value:function p(){var t=this._operation.getSaturation();if(t===1){this._ui.removeOperation("saturation")}this._ui.canvas.render()}},{key:"_onUpdate",value:function n(t){this._operation.setSaturation(t);this._ui.canvas.render();var u=this._operation.getSaturation();if(this._initialSaturation!==u&&!this._historyItem){this._historyItem=this._ui.addHistory(this._operation,{saturation:this._initialSaturation},this._operationExistedBefore)}}}]);return q})(j["default"]);k.prototype.identifier="saturation";g["default"]=k;c.exports=g["default"]},function(c,j,b){Object.defineProperty(j,"__esModule",{value:true});var e=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var l=function d(y,x,u){var v=true;_function:while(v){var s=y,A=x,r=u;t=z=w=undefined;v=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;u=r;v=true;continue _function}}else{if("value" in t){return t.value}else{var w=t.get;if(w===undefined){return undefined}return w.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var h=b(95);var n=p(h);var i=b(50);var m=p(i);var g=b(5);var q=p(g);var f=(function(y){function A(){k(this,A);if(y!=null){y.apply(this,arguments)}}o(A,y);e(A,[{key:"init",value:function D(){this._availableRatios={};this._ratios={};var O=function(U){var S='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';for(var R in U.ratios){S+=" ";var T=U.ratios[R];S+=" ";var Q=T.selected;S+=' <li data-identifier="'+(R)+'" data-ratio="'+(T.ratio)+'"';if(Q){S+=" data-selected"}S+='> <img src="'+(U.helpers.assetPath("ui/night/crop/"+R+".png"))+'" /> </li> '}S+=" </ul></div>"+(U.partials.doneButton);return S};this._controlsTemplate=O;var P=function(R){var Q='<div class="imglykit-canvas-crop-container"> <div class="imglykit-canvas-crop-top"> <div class="imglykit-canvas-crop-top-left"></div> <div class="imglykit-canvas-crop-top-center"></div> <div class="imglykit-canvas-crop-top-right"></div> </div> <div class="imglykit-canvas-crop-center"> <div class="imglykit-canvas-crop-center-left"></div> <div class="imglykit-canvas-crop-center-center"> <div class="imglykit-canvas-crop-knobs"> <div data-corner="top-left"></div> <div data-corner="top-right"></div> <div data-corner="bottom-left"></div> <div data-corner="bottom-right"></div> </div> </div> <div class="imglykit-canvas-crop-center-right"></div> </div> <div class="imglykit-canvas-crop-bottom"> <div class="imglykit-canvas-crop-bottom-left"></div> <div class="imglykit-canvas-crop-bottom-center"></div> <div class="imglykit-canvas-crop-bottom-right"></div> </div></div>';return Q};this._canvasControlsTemplate=P;this._onKnobDown=this._onKnobDown.bind(this);this._onKnobDrag=this._onKnobDrag.bind(this);this._onKnobUp=this._onKnobUp.bind(this);this._onCenterDown=this._onCenterDown.bind(this);this._onCenterDrag=this._onCenterDrag.bind(this);this._onCenterUp=this._onCenterUp.bind(this);this._addDefaultRatios();this.selectRatios(null)}},{key:"selectRatios",value:function K(O){this._ratios={};var P=Object.keys(this._availableRatios);var S=q["default"].select(P,O);for(var R=0;R<S.length;R++){var Q=S[R];this._ratios[Q]=this._availableRatios[Q]}if(this._active){this._renderControls()}}},{key:"_addDefaultRatios",value:function s(){this.addRatio("custom","*",true);this.addRatio("square","1");this.addRatio("4-3","1.33");this.addRatio("16-9","1.77")}},{key:"addRatio",value:function w(O,Q,P){this._availableRatios[O]={ratio:Q,selected:P}}},{key:"_onEnter",value:function I(){var R=this;l(Object.getPrototypeOf(A.prototype),"_onEnter",this).call(this);this._operationExistedBefore=!!this._ui.operations.crop;this._operation=this._ui.getOrCreateOperation("crop");this._defaultStart=new m["default"](0.1,0.1);this._defaultEnd=new m["default"](0.9,0.9);this._initialOptions={start:this._operation.getStart(),end:this._operation.getEnd()};this._start=this._initialOptions.start||this._defaultStart;this._end=this._initialOptions.end||this._defaultEnd;this._minimumSize=new m["default"](50,50);this._initialZoomLevel=this._ui.canvas.zoomLevel;this._ui.canvas.zoomToFit(false);var Q=".imglykit-canvas-crop";var O=this._canvasControls;var P=O.querySelector(""+Q+"-knobs");this._initialStart=this._operation.getStart().clone();this._initialEnd=this._operation.getEnd().clone();this._operation.set({start:new m["default"](0,0),end:new m["default"](1,1)});this._knobs={topLeft:P.querySelector("[data-corner=top-left]"),topRight:P.querySelector("[data-corner=top-right]"),bottomLeft:P.querySelector("[data-corner=bottom-left]"),bottomRight:P.querySelector("[data-corner=bottom-right]")};this._areas={topLeft:this._canvasControls.querySelector(""+Q+"-top-left"),topCenter:this._canvasControls.querySelector(""+Q+"-top-center"),centerLeft:this._canvasControls.querySelector(""+Q+"-center-left"),centerCenter:this._canvasControls.querySelector(""+Q+"-center-center")};this._knobsContainer=this._canvasControls.querySelector(".imglykit-canvas-crop-knobs");this._handleControls();this._handleKnobs();this._handleKnobsContainer();this._ui.canvas.render().then(function(){R._updateDOM()})}},{key:"_handleControls",value:function z(){var P=this;var Q=this._controls.querySelectorAll("ul > li");this._ratioItems=Array.prototype.slice.call(Q);var R=function(T){var W=P._ratioItems[T];var V=W.getAttribute("data-selected");var U=W.getAttribute("data-ratio");var S=W.getAttribute("data-identifier");if(typeof V!=="undefined"&&V!==null&&!P._operationExistedBefore){P._setRatio(S,U,false);P._selectRatio(W)}W.addEventListener("click",function(X){X.preventDefault();P._onRatioClick(W)})};for(var O=0;O<this._ratioItems.length;O++){R(O)}}},{key:"_onRatioClick",value:function L(O){this._unselectAllRatios();this._selectRatio(O)}},{key:"_unselectAllRatios",value:function J(){for(var O=0;O<this._ratioItems.length;O++){var P=this._ratioItems[O];P.classList.remove("imglykit-controls-item-active")}}},{key:"_selectRatio",value:function r(Q){Q.classList.add("imglykit-controls-item-active");var P=Q.getAttribute("data-ratio");var O=Q.getAttribute("data-identifier");this._setRatio(O,P)}},{key:"_setRatio",value:function N(R,T){var Q=arguments[2]===undefined?true:arguments[2];var P=this._ui.canvas.size;this._selectedRatio=R;if(T==="*"){this._ratio=null;this._start=new m["default"](0.1,0.1);this._end=new m["default"](0.9,0.9)}else{if(T==="original"){this._ratio=P.x/P.y}else{T=parseFloat(T);this._ratio=T}if(Q){if(P.x/P.y<=this._ratio){this._start.x=0.1;this._end.x=0.9;var O=1/P.y*(P.x/this._ratio*0.8);this._start.y=(1-O)/2;this._end.y=1-this._start.y}else{this._start.y=0.1;this._end.y=0.9;var S=1/P.x*(this._ratio*P.y*0.8);this._start.x=(1-S)/2;this._end.x=1-this._start.x}}}this._updateDOM()}},{key:"_updateDOM",value:function M(){var P=this._ui.canvas.size;var R=this._start.clone().multiply(P);var T=this._end.clone().multiply(P);var Q=T.clone().subtract(R);var V=Math.max(1,R.y);var U=Math.max(1,R.x);var S=Math.max(1,Q.x);var O=Math.max(1,Q.y);this._areas.topLeft.style.width=""+U+"px";this._areas.topCenter.style.width=""+S+"px";this._areas.topLeft.style.height=""+V+"px";this._areas.centerLeft.style.height=""+O+"px";this._knobsContainer.style.height=""+O+"px"}},{key:"_handleKnobs",value:function v(){var P=this;var Q=function(S){var R=P._knobs[S];R.addEventListener("mousedown",function(T){P._onKnobDown(T,R)});R.addEventListener("touchstart",function(T){P._onKnobDown(T,R)})};for(var O in this._knobs){Q(O)}}},{key:"_onKnobDown",value:function H(P,O){P.preventDefault();P.stopPropagation();this._currentKnob=O;this._initialMousePosition=q["default"].getEventPosition(P);this._startBeforeDrag=this._start.clone();this._endBeforeDrag=this._end.clone();document.addEventListener("mousemove",this._onKnobDrag);document.addEventListener("touchmove",this._onKnobDrag);document.addEventListener("mouseup",this._onKnobUp);document.addEventListener("touchend",this._onKnobUp)}},{key:"_onKnobDrag",value:function u(S){S.preventDefault();var X=q["default"].getEventPosition(S);var R=X.subtract(this._initialMousePosition);var V=this._currentKnob.getAttribute("data-corner");var Y=this._ui.canvas.size;var U=this._startBeforeDrag.clone().multiply(Y);var P=this._endBeforeDrag.clone().multiply(Y);var O=undefined,W=undefined,Q=undefined,T=undefined;switch(V){case"top-left":U.add(R);Q=P.clone().subtract(this._minimumSize);U.clamp(null,Q);break;case"top-right":P.x+=R.x;U.y+=R.y;P.x=Math.max(U.x+this._minimumSize.x,P.x);U.y=Math.min(P.y-this._minimumSize.y,U.y);break;case"bottom-right":P.add(R);T=U.clone().add(this._minimumSize);P.clamp(T);break;case"bottom-left":U.x+=R.x;P.y+=R.y;U.x=Math.min(P.x-this._minimumSize.x,U.x);P.y=Math.max(U.y+this._minimumSize.y,P.y);break}this._start.copy(U).divide(Y);this._end.copy(P).divide(Y);this._start.clamp(0,1);this._end.clamp(0,1);if(this._ratio!==null){switch(V){case"top-left":O=(this._end.x-this._start.x)*Y.x;W=O/this._ratio;this._start.y=this._end.y-W/Y.y;if(this._start.y<=0){this._start.y=0;W=(this._end.y-this._start.y)*Y.y;O=W*this._ratio;this._start.x=this._end.x-O/Y.x}break;case"top-right":O=(this._end.x-this._start.x)*Y.x;W=O/this._ratio;this._start.y=this._end.y-W/Y.y;if(this._start.y<=0){this._start.y=0;W=(this._end.y-this._start.y)*Y.y;O=W*this._ratio;this._end.x=this._start.x+O/Y.x}break;case"bottom-right":O=(this._end.x-this._start.x)*Y.x;W=O/this._ratio;this._end.y=this._start.y+W/Y.y;if(this._end.y>=1){this._end.y=1;W=(this._end.y-this._start.y)*Y.y;O=W*this._ratio;this._end.x=this._start.x+O/Y.x}break;case"bottom-left":O=(this._end.x-this._start.x)*Y.x;W=O/this._ratio;this._end.y=this._start.y+W/Y.y;if(this._end.y>=1){this._end.y=1;W=(this._end.y-this._start.y)*Y.y;O=W*this._ratio;this._start.x=this._end.x-O/Y.x}break}}this._updateDOM()}},{key:"_onKnobUp",value:function C(){this._currentKnob=null;document.removeEventListener("mousemove",this._onKnobDrag);document.removeEventListener("touchmove",this._onKnobDrag);document.removeEventListener("mouseup",this._onKnobUp);document.removeEventListener("touchend",this._onKnobUp)}},{key:"_handleKnobsContainer",value:function G(){this._knobsContainer.addEventListener("mousedown",this._onCenterDown);this._knobsContainer.addEventListener("touchstart",this._onCenterDown)}},{key:"_onCenterDown",value:function F(O){console.log("_onCenterDown");this._initialMousePosition=q["default"].getEventPosition(O);this._startBeforeDrag=this._start.clone();this._endBeforeDrag=this._end.clone();document.addEventListener("mousemove",this._onCenterDrag);document.addEventListener("touchmove",this._onCenterDrag);document.addEventListener("mouseup",this._onCenterUp);document.addEventListener("touchend",this._onCenterUp)}},{key:"_onCenterDrag",value:function t(R){var V=q["default"].getEventPosition(R);var P=V.subtract(this._initialMousePosition);var W=this._ui.canvas.size;var S=this._endBeforeDrag.clone().subtract(this._startBeforeDrag);var Q=S.clone().multiply(W);var T=this._startBeforeDrag.clone().multiply(W);var O=this._endBeforeDrag.clone().multiply(W);T.add(P);var U=W.clone().subtract(Q);T.clamp(new m["default"](0,0),U);O.copy(T).add(Q);this._start.copy(T).divide(W);this._end.copy(O).divide(W);this._updateDOM()}},{key:"_onCenterUp",value:function x(){document.removeEventListener("mousemove",this._onCenterDrag);document.removeEventListener("touchmove",this._onCenterDrag);document.removeEventListener("mouseup",this._onCenterUp);document.removeEventListener("touchend",this._onCenterUp)}},{key:"_onBack",value:function E(){this._ui.canvas.setZoomLevel(this._initialZoomLevel,false);if(this._operationExistedBefore){this._operation.set({start:this._initialStart,end:this._initialEnd})}else{this._ui.removeOperation("crop")}this._ui.canvas.render()}},{key:"_onDone",value:function B(){this._operation.set({start:this._start,end:this._end});this._ui.canvas.zoomToFit(true);this._ui.addHistory(this._operation,{start:this._initialStart.clone(),end:this._initialEnd.clone()},this._operationExistedBefore)}},{key:"context",get:function(){var O=l(Object.getPrototypeOf(A.prototype),"context",this);O.ratios=this._ratios;return O}},{key:"selectedRatio",get:function(){return this._selectedRatio}}]);return A})(n["default"]);f.prototype.identifier="crop";j["default"]=f;c.exports=j["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var e=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();function p(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var g=c(95);var l=p(g);var h=c(50);var k=p(h);var f=c(5);var q=p(f);var b=c(103);var o=p(b);var m=(function(r){function E(){j(this,E);if(r!=null){r.apply(this,arguments)}}n(E,r);e(E,[{key:"init",value:function G(){var H=function(K){var J='<div class="imglykit-controls-icon"> <img src="'+(K.helpers.assetPath("ui/night/blur/blur.png"))+'" /></div><div> '+(K.partials.slider)+"</div>"+(K.partials.doneButton);return J};this._controlsTemplate=H;var I=function(K){var J='<div class="imglykit-canvas-radial-blur-container"> <div class="imglykit-canvas-radial-blur-dot" id="imglykit-radial-blur-position"></div> <div class="imglykit-canvas-radial-blur-dot" id="imglykit-radial-blur-gradient"></div> <div class="imglykit-canvas-radial-blur-circle-container"> <div class="imglykit-canvas-radial-blur-circle"></div> </div></div>';return J};this._canvasControlsTemplate=I;this._partialTemplates.slider=o["default"].template;this._partialTemplates.slider.additionalContext={id:"imglykit-blur-radius-slider"}}},{key:"_onEnter",value:function x(){var H=this;this._operationExistedBefore=!!this._ui.operations["radial-blur"];this._operation=this._ui.getOrCreateOperation("radial-blur");this._initialSettings={position:this._operation.getPosition().clone(),gradientRadius:this._operation.getGradientRadius(),blurRadius:this._operation.getBlurRadius()};this._onPositionKnobDown=this._onPositionKnobDown.bind(this);this._onPositionKnobDrag=this._onPositionKnobDrag.bind(this);this._onPositionKnobUp=this._onPositionKnobUp.bind(this);this._onGradientKnobDown=this._onGradientKnobDown.bind(this);this._onGradientKnobDrag=this._onGradientKnobDrag.bind(this);this._onGradientKnobUp=this._onGradientKnobUp.bind(this);this._positionKnob=this._canvasControls.querySelector("#imglykit-radial-blur-position");this._gradientKnob=this._canvasControls.querySelector("#imglykit-radial-blur-gradient");this._circle=this._canvasControls.querySelector(".imglykit-canvas-radial-blur-circle");this._handleKnobs();this._initSliders();this._ui.canvas.render().then(function(){H._updateDOM()})}},{key:"_initSliders",value:function B(){var H=this._controls.querySelector("#imglykit-blur-radius-slider");this._blurRadiusSlider=new o["default"](H,{minValue:0,maxValue:40});this._blurRadiusSlider.on("update",this._onBlurRadiusUpdate.bind(this));this._blurRadiusSlider.setValue(this._initialSettings.blurRadius)}},{key:"_onBlurRadiusUpdate",value:function v(H){this._operation.setBlurRadius(H);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_handleKnobs",value:function D(){var I=this._ui.canvas.size;var H=this._operation.getPosition().clone().multiply(I);this._gradientKnobPosition=H.clone().add(this._initialSettings.gradientRadius,0);this._positionKnob.addEventListener("mousedown",this._onPositionKnobDown);this._positionKnob.addEventListener("touchstart",this._onPositionKnobDown);this._gradientKnob.addEventListener("mousedown",this._onGradientKnobDown);this._gradientKnob.addEventListener("touchstart",this._onGradientKnobDown)}},{key:"_onPositionKnobDown",value:function y(I){I.preventDefault();var H=this._ui.canvas.size;this._initialMousePosition=q["default"].getEventPosition(I);this._initialPosition=this._operation.getPosition().clone();this._gradientKnobDistance=this._gradientKnobPosition.clone().subtract(this._initialPosition.clone().multiply(H));document.addEventListener("mousemove",this._onPositionKnobDrag);document.addEventListener("touchmove",this._onPositionKnobDrag);document.addEventListener("mouseup",this._onPositionKnobUp);document.addEventListener("touchend",this._onPositionKnobUp)}},{key:"_onPositionKnobDrag",value:function u(K){K.preventDefault();var H=this._ui.canvas.size;var M=q["default"].getEventPosition(K);var J=M.subtract(this._initialMousePosition);var I=this._initialPosition.clone().multiply(H).add(J);var L=H.clone().subtract(this._gradientKnobDistance);I.clamp(new k["default"](0,0),L);this._gradientKnobPosition.copy(I).add(this._gradientKnobDistance);I.divide(H);this._operation.setPosition(I);this._updateDOM();this._ui.canvas.render()}},{key:"_onPositionKnobUp",value:function A(H){H.preventDefault();document.removeEventListener("mousemove",this._onPositionKnobDrag);document.removeEventListener("touchmove",this._onPositionKnobDrag);document.removeEventListener("mouseup",this._onPositionKnobUp);document.removeEventListener("touchend",this._onPositionKnobUp)}},{key:"_onGradientKnobDown",value:function w(H){H.preventDefault();this._initialMousePosition=q["default"].getEventPosition(H);this._initialGradientKnobPosition=this._gradientKnobPosition.clone();document.addEventListener("mousemove",this._onGradientKnobDrag);document.addEventListener("touchmove",this._onGradientKnobDrag);document.addEventListener("mouseup",this._onGradientKnobUp);document.addEventListener("touchend",this._onGradientKnobUp)}},{key:"_onGradientKnobDrag",value:function F(L){L.preventDefault();var I=this._ui.canvas.size;var N=q["default"].getEventPosition(L);var K=N.subtract(this._initialMousePosition);this._gradientKnobPosition=this._initialGradientKnobPosition.clone().add(K);this._gradientKnobPosition.clamp(new k["default"](0,0),I);var H=this._operation.getPosition().clone().multiply(I);var M=this._gradientKnobPosition.clone().subtract(H);var J=Math.sqrt(Math.pow(M.x,2)+Math.pow(M.y,2));this._operation.setGradientRadius(J);this._updateDOM();this._ui.canvas.render()}},{key:"_onGradientKnobUp",value:function t(H){H.preventDefault();document.removeEventListener("mousemove",this._onGradientKnobDrag);document.removeEventListener("touchmove",this._onGradientKnobDrag);document.removeEventListener("mouseup",this._onGradientKnobUp);document.removeEventListener("touchend",this._onGradientKnobUp)}},{key:"_updateDOM",value:function s(){var I=this._ui.canvas.size;var H=this._operation.getPosition().clone().multiply(I);this._positionKnob.style.left=""+H.x+"px";this._positionKnob.style.top=""+H.y+"px";this._gradientKnob.style.left=""+this._gradientKnobPosition.x+"px";this._gradientKnob.style.top=""+this._gradientKnobPosition.y+"px";var J=this._operation.getGradientRadius()*2;this._circle.style.left=""+H.x+"px";this._circle.style.top=""+H.y+"px";this._circle.style.width=""+J+"px";this._circle.style.height=""+J+"px";this._circle.style.marginLeft="-"+J/2+"px";this._circle.style.marginTop="-"+J/2+"px"}},{key:"_onBack",value:function C(){if(this._operationExistedBefore){this._operation.set(this._initialSettings)}else{this._ui.removeOperation("radial-blur")}this._ui.canvas.render()}},{key:"_onDone",value:function z(){this._ui.addHistory(this._operation,{position:this._initialSettings.position.clone(),gradientRadius:this._initialSettings.gradientRadius,blurRadius:this._initialSettings.blurRadius},this._operationExistedBefore)}}]);return E})(l["default"]);m.prototype.identifier="radial-blur";i["default"]=m;d.exports=i["default"]},function(d,j,c){Object.defineProperty(j,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var h=c(95);var m=p(h);var i=c(50);var l=p(i);var g=c(5);var q=p(g);var b=c(103);var o=p(b);var e=(function(r){function w(){k(this,w);if(r!=null){r.apply(this,arguments)}}n(w,r);f(w,[{key:"init",value:function H(){var I=function(M){var L='<div class="imglykit-controls-icon"> <img src="'+(M.helpers.assetPath("ui/night/blur/blur.png"))+'" /></div><div> ';var K="imglykit-blur-radius-slider";L+=" "+(M.partials.slider)+"</div>"+(M.partials.doneButton);return L};this._controlsTemplate=I;var J=function(L){var K='<div class="imglykit-canvas-tilt-shift-container"> <div class="imglykit-canvas-tilt-shift-dot" data-option="position"></div> <div class="imglykit-canvas-tilt-shift-dot" data-option="gradient"></div> <div class="imglykit-canvas-tilt-shift-rect-container"> <div class="imglykit-canvas-tilt-shift-rect"></div> </div></div>';return K};this._canvasControlsTemplate=J;this._partialTemplates.slider=o["default"].template;this._partialTemplates.slider.additionalContext={id:"imglykit-blur-radius-slider"};this._currentKnob=null}},{key:"_onEnter",value:function y(){var J=this;this._operationExistedBefore=!!this._ui.operations["tilt-shift"];this._operation=this._ui.getOrCreateOperation("tilt-shift");this._initialSettings={start:this._operation.getStart().clone(),end:this._operation.getEnd().clone(),gradientRadius:this._operation.getGradientRadius(),blurRadius:this._operation.getBlurRadius()};this._onPositionKnobDown=this._onPositionKnobDown.bind(this);this._onPositionKnobDrag=this._onPositionKnobDrag.bind(this);this._onPositionKnobUp=this._onPositionKnobUp.bind(this);this._onGradientKnobDown=this._onGradientKnobDown.bind(this);this._onGradientKnobDrag=this._onGradientKnobDrag.bind(this);this._onGradientKnobUp=this._onGradientKnobUp.bind(this);var I=".imglykit-canvas-tilt-shift-dot";this._positionKnob=this._canvasControls.querySelector(""+I+"[data-option='position']");this._gradientKnob=this._canvasControls.querySelector(""+I+"[data-option='gradient']");this._rect=this._canvasControls.querySelector(".imglykit-canvas-tilt-shift-rect");this._initSliders();this._ui.canvas.render().then(function(){J._handleKnobs();J._updateDOM()})}},{key:"_initSliders",value:function D(){var I=this._controls.querySelector("#imglykit-blur-radius-slider");this._blurRadiusSlider=new o["default"](I,{minValue:0,maxValue:40});this._blurRadiusSlider.on("update",this._onBlurRadiusUpdate.bind(this));this._blurRadiusSlider.setValue(this._initialSettings.blurRadius)}},{key:"_onBlurRadiusUpdate",value:function v(I){this._operation.setBlurRadius(I);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_handleKnobs",value:function F(){this._positionKnob.addEventListener("mousedown",this._onPositionKnobDown);this._positionKnob.addEventListener("touchstart",this._onPositionKnobDown);this._gradientKnob.addEventListener("mousedown",this._onGradientKnobDown);this._gradientKnob.addEventListener("touchstart",this._onGradientKnobDown);var P=this._ui.canvas.size;var M=this._initialSettings;var I=M.start;var K=M.end;I=I.clone().multiply(P);K=K.clone().multiply(P);var N=K.clone().subtract(I);var Q=I.clone().add(N.clone().divide(2));var L=Math.sqrt(Math.pow(N.x,2)+Math.pow(N.y,2));var O=N.clone().divide(L).divide(2);this._knobPosition=Q.clone();var J=this._initialSettings.gradientRadius;this._gradientKnobPosition=Q.clone().add(-J*O.y,J*O.x);this._updateStartAndEnd();this._updateDOM();this._ui.canvas.render()}},{key:"_updateStartAndEnd",value:function z(){var I=this._ui.canvas.size;var K=this._gradientKnobPosition.clone().subtract(this._knobPosition);var L=this._knobPosition.clone().add(-K.y,K.x).divide(I);var J=this._knobPosition.clone().add(K.y,-K.x).divide(I);this._operation.set({start:L,end:J})}},{key:"_onPositionKnobDown",value:function A(I){I.preventDefault();this._initialMousePosition=q["default"].getEventPosition(I);this._initialPosition=this._knobPosition.clone();this._initialDistanceToGradientKnob=this._gradientKnobPosition.clone().subtract(this._initialPosition);document.addEventListener("mousemove",this._onPositionKnobDrag);document.addEventListener("touchmove",this._onPositionKnobDrag);document.addEventListener("mouseup",this._onPositionKnobUp);document.addEventListener("touchend",this._onPositionKnobUp)}},{key:"_onPositionKnobDrag",value:function u(L){L.preventDefault();var I=this._ui.canvas.size;var O=q["default"].getEventPosition(L);var K=O.subtract(this._initialMousePosition);var J=this._initialPosition.clone().add(K);this._knobPosition.copy(J);var N=new l["default"]().subtract(this._initialDistanceToGradientKnob);N.clamp(new l["default"](0,0));var M=I.clone().subtract(this._initialDistanceToGradientKnob);M.clamp(null,I);this._knobPosition.clamp(N,M);this._gradientKnobPosition.copy(this._knobPosition).add(this._initialDistanceToGradientKnob);this._updateStartAndEnd();this._updateDOM();this._ui.canvas.render()}},{key:"_onPositionKnobUp",value:function C(I){I.preventDefault();document.removeEventListener("mousemove",this._onPositionKnobDrag);document.removeEventListener("touchmove",this._onPositionKnobDrag);document.removeEventListener("mouseup",this._onPositionKnobUp);document.removeEventListener("touchend",this._onPositionKnobUp)}},{key:"_onGradientKnobDown",value:function x(I){I.preventDefault();this._initialMousePosition=q["default"].getEventPosition(I);this._initialGradientKnobPosition=this._gradientKnobPosition.clone();document.addEventListener("mousemove",this._onGradientKnobDrag);document.addEventListener("touchmove",this._onGradientKnobDrag);document.addEventListener("mouseup",this._onGradientKnobUp);document.addEventListener("touchend",this._onGradientKnobUp)}},{key:"_onGradientKnobDrag",value:function G(K){K.preventDefault();var I=this._ui.canvas.size;var N=q["default"].getEventPosition(K);var J=N.subtract(this._initialMousePosition);this._gradientKnobPosition.copy(this._initialGradientKnobPosition).add(J);this._gradientKnobPosition.clamp(new l["default"](0,0),I);var M=this._gradientKnobPosition.clone().subtract(this._knobPosition);var L=2*Math.sqrt(Math.pow(M.x,2)+Math.pow(M.y,2));this._operation.setGradientRadius(L);this._updateStartAndEnd();this._updateDOM();this._ui.canvas.render()}},{key:"_onGradientKnobUp",value:function t(I){I.preventDefault();document.removeEventListener("mousemove",this._onGradientKnobDrag);document.removeEventListener("touchmove",this._onGradientKnobDrag);document.removeEventListener("mouseup",this._onGradientKnobUp);document.removeEventListener("touchend",this._onGradientKnobUp)}},{key:"_updateDOM",value:function s(){var J=this._knobPosition;this._positionKnob.style.left=""+J.x+"px";this._positionKnob.style.top=""+J.y+"px";var P=this._gradientKnobPosition;this._gradientKnob.style.left=""+P.x+"px";this._gradientKnob.style.top=""+P.y+"px";var I=this._ui.canvas.size;var L=this._operation.getGradientRadius();var M=new l["default"](Math.sqrt(Math.pow(I.x,2)+Math.pow(I.y,2))*2,L);this._rect.style.width=""+M.x+"px";this._rect.style.height=""+M.y+"px";this._rect.style.marginLeft="-"+M.x/2+"px";this._rect.style.marginTop="-"+M.y/2+"px";this._rect.style.left=""+J.x+"px";this._rect.style.top=""+J.y+"px";var O=P.clone().subtract(J);var N=Math.atan2(O.x,O.y)*(180/Math.PI);var K="rotate("+(-N).toFixed(2)+"deg)";this._rect.style.transform=K;this._rect.style["-moz-transform"]=K;this._rect.style["-ms-transform"]=K;this._rect.style["-webkit-transform"]=K}},{key:"_onBack",value:function E(){if(this._operationExistedBefore){this._operation.set(this._initialSettings)}else{this._ui.removeOperation("tilt-shift")}this._ui.canvas.render()}},{key:"_onDone",value:function B(){this._ui.addHistory(this._operation,{start:this._initialSettings.start.clone(),end:this._initialSettings.end.clone(),blurRadius:this._initialSettings.blurRadius,gradientRadius:this._initialSettings.gradientRadius},this._operationExistedBefore)}}]);return w})(m["default"]);e.prototype.identifier="tilt-shift";j["default"]=e;d.exports=j["default"]},function(d,j,c){Object.defineProperty(j,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var m=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function l(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var i=c(95);var n=q(i);var b=c(103);var p=q(b);var h=c(104);var k=q(h);var g=(function(r){function t(){l(this,t);if(r!=null){r.apply(this,arguments)}}o(t,r);f(t,[{key:"init",value:function z(){var A=function(C){var B="<div> "+(C.partials.slider)+'</div><div class="imglykit-controls-button"> '+(C.partials.colorPicker)+"</div>"+(C.partials.doneButton);return B};this._controlsTemplate=A;this._partialTemplates.slider=p["default"].template;this._partialTemplates.colorPicker=k["default"].template}},{key:"_renderControls",value:function w(){this._partialTemplates.colorPicker.additionalContext={label:this._ui.translate("controls.frames.color")};m(Object.getPrototypeOf(t.prototype),"_renderControls",this).call(this)}},{key:"_onEnter",value:function s(){this._operationExistedBefore=!!this._ui.operations.frames;this._operation=this._ui.getOrCreateOperation("frames");this._initialOptions={thickness:this._operation.getThickness(),color:this._operation.getColor()};this._ui.canvas.render();var B=this._controls.querySelector(".imglykit-slider");this._slider=new p["default"](B,{minValue:0,maxValue:0.5});this._slider.on("update",this._onThicknessUpdate.bind(this));this._slider.setValue(this._initialOptions.thickness);var A=this._controls.querySelector(".imglykit-color-picker");this._colorPicker=new k["default"](this._ui,A);this._colorPicker.on("update",this._onColorUpdate.bind(this));this._colorPicker.setValue(this._initialOptions.color)}},{key:"_onBack",value:function y(){if(this._operationExistedBefore){this._operation.set(this._initialOptions)}else{this._ui.removeOperation("frames")}this._ui.canvas.render()}},{key:"_onThicknessUpdate",value:function v(A){this._operation.setThickness(A);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_onColorUpdate",value:function u(A){this._operation.setColor(A);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_onDone",value:function x(){this._ui.addHistory(this._operation,{color:this._initialOptions.color,thickness:this._initialOptions.thickness},this._operationExistedBefore)}}]);return t})(n["default"]);g.prototype.identifier="frames";j["default"]=g;d.exports=j["default"]},function(c,i,b){Object.defineProperty(i,"__esModule",{value:true});var e=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function d(y,x,u){var v=true;_function:while(v){var s=y,A=x,r=u;t=z=w=undefined;v=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;u=r;v=true;continue _function}}else{if("value" in t){return t.value}else{var w=t.get;if(w===undefined){return undefined}return w.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var g=b(95);var n=p(g);var h=b(50);var l=p(h);var f=b(5);var q=p(f);var m=(function(x){function v(){j(this,v);if(x!=null){x.apply(this,arguments)}}o(v,x);e(v,[{key:"init",value:function H(){var O=function(T){var S='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';for(var R in T.stickers){S+=" ";var U=T.stickers[R];S+=" ";var Q=T.activeSticker===R;S+=' <li data-identifier="'+(R)+'"';if(Q){S+=' class="imglykit-controls-item-active"'}S+='> <canvas class="imglykit-controls-item-canvas" data-image="'+(T.helpers.assetPath(U))+'"></canvas> </li> '}S+=" </ul></div>"+(T.partials.doneButton);return S};this._controlsTemplate=O;var P=function(R){var Q='<div class="imglykit-canvas-stickers-container"> <div class="imglykit-canvas-stickers"> <img class="imglykit-canvas-sticker-image" /> <div class="imglykit-knob"></div> </div></div>';return Q};this._canvasControlsTemplate=P;this._availableStickers={};this._stickers={};this._addDefaultStickers();this.selectStickers(null)}},{key:"_addDefaultStickers",value:function C(){this.addSticker("glasses-nerd","stickers/sticker-glasses-nerd.png");this.addSticker("glasses-normal","stickers/sticker-glasses-normal.png");this.addSticker("glasses-shutter-green","stickers/sticker-glasses-shutter-green.png");this.addSticker("glasses-shutter-yellow","stickers/sticker-glasses-shutter-yellow.png");this.addSticker("glasses-sun","stickers/sticker-glasses-sun.png");this.addSticker("hat-cap","stickers/sticker-hat-cap.png");this.addSticker("hat-cylinder","stickers/sticker-hat-cylinder.png");this.addSticker("hat-party","stickers/sticker-hat-party.png");this.addSticker("hat-sheriff","stickers/sticker-hat-sheriff.png");this.addSticker("heart","stickers/sticker-heart.png");this.addSticker("mustache-long","stickers/sticker-mustache-long.png");this.addSticker("mustache1","stickers/sticker-mustache1.png");this.addSticker("mustache2","stickers/sticker-mustache2.png");this.addSticker("mustache3","stickers/sticker-mustache3.png");this.addSticker("pipe","stickers/sticker-pipe.png");this.addSticker("snowflake","stickers/sticker-snowflake.png");this.addSticker("star","stickers/sticker-star.png")}},{key:"addSticker",value:function I(O,P){this._availableStickers[O]=P;this._stickers[O]=this._availableStickers[O];if(this._active){this._renderControls()}}},{key:"selectStickers",value:function z(P){this._stickers={};var S=Object.keys(this._availableStickers);var O=q["default"].select(S,P);for(var R=0;R<O.length;R++){var Q=O[R];this._stickers[Q]=this._availableStickers[Q]}if(this._active){this._renderControls()}}},{key:"_onEnter",value:function M(){var P=this;this._operationExistedBefore=!!this._ui.operations.stickers;this._operation=this._ui.getOrCreateOperation("stickers");this._ui.removeOperation("stickers");this._initialSettings={sticker:this._operation.getSticker(),position:this._operation.getPosition().clone(),size:this._operation.getSize().clone()};var O=this._ui.canvas.size;this._size=this._initialSettings.size.clone();this._position=this._initialSettings.position.clone().multiply(O);this._initialZoomLevel=this._ui.canvas.zoomLevel;this._ui.canvas.zoomToFit();this._container=this._canvasControls.querySelector(".imglykit-canvas-stickers");this._stickerImage=this._canvasControls.querySelector("img");this._stickerImage.addEventListener("load",function(){P._stickerSize=new l["default"](P._stickerImage.width,P._stickerImage.height);P._onStickerLoad()});this._knob=this._canvasControls.querySelector("div.imglykit-knob");this._onImageDown=this._onImageDown.bind(this);this._onImageDrag=this._onImageDrag.bind(this);this._onImageUp=this._onImageUp.bind(this);this._onKnobDown=this._onKnobDown.bind(this);this._onKnobDrag=this._onKnobDrag.bind(this);this._onKnobUp=this._onKnobUp.bind(this);this._renderListItems();this._handleListItems();this._handleImage();this._handleKnob()}},{key:"_renderListItems",value:function t(){var P=this;var Q=this._controls.querySelectorAll("li canvas");this._canvasItems=Array.prototype.slice.call(Q);var R=function(V){var T=P._canvasItems[V];T.width=T.offsetWidth;T.height=T.offsetHeight;var U=T.getContext("2d");var W=T.getAttribute("data-image");var X=document.createElement("img");var S=new l["default"](T.width,T.height);X.addEventListener("load",function(){var Z=new l["default"](X.width,X.height);var Y=q["default"].resizeVectorToFit(Z,S);var aa=S.clone().divide(2).subtract(Y.clone().divide(2));U.drawImage(X,0,0,Z.x,Z.y,aa.x,aa.y,Y.x,Y.y)});X.src=W};for(var O=0;O<this._canvasItems.length;O++){R(O)}}},{key:"_handleListItems",value:function E(){var P=this;var R=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(R);var Q=function(T){var U=P._listItems[T];var S=U.getAttribute("data-identifier");U.addEventListener("click",function(){P._onListItemClick(U)});if(!P._operationExistedBefore&&T===0||P._operationExistedBefore&&P._stickers[S]===P._initialSettings.sticker){P._onListItemClick(U,false)}};for(var O=0;O<this._listItems.length;O++){Q(O)}}},{key:"_applySettings",value:function K(){var O=this._stickerSize.y/this._stickerSize.x;this._size.y=this._size.x*O;this._stickerImage.style.width=""+this._size.x+"px";this._stickerImage.style.height=""+this._size.y+"px";this._container.style.left=""+this._position.x+"px";this._container.style.top=""+this._position.y+"px"}},{key:"_onBack",value:function J(){if(this._operationExistedBefore){this._operation=this._ui.getOrCreateOperation("stickers");this._operation.set(this._initialSettings)}else{this._ui.removeOperation("stickers")}this._ui.canvas.setZoomLevel(this._initialZoomLevel)}},{key:"_onDone",value:function D(){var P=this._ui.canvas.size;var O=this._position.clone().divide(P);var Q=this._size.clone().divide(P);this._ui.canvas.setZoomLevel(this._initialZoomLevel,false);this._operation=this._ui.getOrCreateOperation("stickers");this._operation.set({sticker:this._availableStickers[this._sticker],position:O,size:Q});this._ui.canvas.render();this._ui.addHistory(this,{sticker:this._initialSettings.sticker,position:this._initialSettings.position.clone(),size:this._initialSettings.size.clone()},this._operationExistedBefore)}},{key:"_handleKnob",value:function u(){this._knob.addEventListener("mousedown",this._onKnobDown);this._knob.addEventListener("touchstart",this._onKnobDown)}},{key:"_onKnobDown",value:function L(O){O.preventDefault();this._initialMousePosition=q["default"].getEventPosition(O);this._initialSize=this._size.clone();document.addEventListener("mousemove",this._onKnobDrag);document.addEventListener("touchmove",this._onKnobDrag);document.addEventListener("mouseup",this._onKnobUp);document.addEventListener("touchend",this._onKnobUp)}},{key:"_onKnobDrag",value:function s(R){R.preventDefault();var S=q["default"].getEventPosition(R);var Q=S.clone().subtract(this._initialMousePosition);var O=this._initialSize.clone();var P=this._stickerImage.height/this._stickerImage.width;O.x+=Q.x;O.y=O.x*P;this._size.copy(O);this._applySettings();this._highlightDoneButton()}},{key:"_onKnobUp",value:function G(){document.removeEventListener("mousemove",this._onKnobDrag);document.removeEventListener("touchmove",this._onKnobDrag);document.removeEventListener("mouseup",this._onKnobUp);document.removeEventListener("touchend",this._onKnobUp)}},{key:"_handleImage",value:function r(){this._stickerImage.addEventListener("mousedown",this._onImageDown);this._stickerImage.addEventListener("touchstart",this._onImageDown)}},{key:"_onImageDown",value:function B(O){O.preventDefault();this._initialMousePosition=q["default"].getEventPosition(O);this._initialPosition=this._position.clone();document.addEventListener("mousemove",this._onImageDrag);document.addEventListener("touchmove",this._onImageDrag);document.addEventListener("mouseup",this._onImageUp);document.addEventListener("touchend",this._onImageUp)}},{key:"_onImageDrag",value:function N(Q){Q.preventDefault();var R=q["default"].getEventPosition(Q);var P=R.clone().subtract(this._initialMousePosition);var O=this._initialPosition.clone();O.add(P);this._position.copy(O);this._applySettings();this._highlightDoneButton()}},{key:"_onImageUp",value:function y(){document.removeEventListener("mousemove",this._onImageDrag);document.removeEventListener("touchmove",this._onImageDrag);document.removeEventListener("mouseup",this._onImageUp);document.removeEventListener("touchend",this._onImageUp)}},{key:"_onStickerLoad",value:function F(){this._size=new l["default"](this._stickerImage.width,this._stickerImage.height);if(typeof this._position==="undefined"){this._position=new l["default"](0,0)}this._applySettings()}},{key:"_onListItemClick",value:function A(R){var O=arguments[1]===undefined?true:arguments[1];this._deactivateAllItems();var P=R.getAttribute("data-identifier");var Q=this._availableStickers[P];Q=this._kit.getAssetPath(Q);try{this._stickerImage.attributes.removeNamedItem("style")}catch(S){}this._sticker=P;this._stickerImage.src=Q;R.classList.add("imglykit-controls-item-active");if(O){this._highlightDoneButton()}}},{key:"_deactivateAllItems",value:function w(){for(var O=0;O<this._listItems.length;O++){var P=this._listItems[O];P.classList.remove("imglykit-controls-item-active")}}},{key:"context",get:function(){var O=k(Object.getPrototypeOf(v.prototype),"context",this);O.stickers=this._stickers;return O}}]);return v})(n["default"]);m.prototype.identifier="stickers";i["default"]=m;c.exports=i["default"]},function(d,s,g){Object.defineProperty(s,"__esModule",{value:true});var n=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var b=function q(A,z,w){var x=true;_function:while(x){var u=A,C=z,t=w;v=B=y=undefined;x=false;var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;w=t;x=true;continue _function}}else{if("value" in v){return v.value}else{var y=v.get;if(y===undefined){return undefined}return y.call(t)}}}};function c(t){return t&&t.__esModule?t:{"default":t}}function h(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function l(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){u.__proto__=t}}var p=g(95);var f=c(p);var j=g(104);var i=c(j);var k=g(50);var e=c(k);var r=g(5);var m=c(r);var o=(function(B){function R(){h(this,R);if(B!=null){B.apply(this,arguments)}}l(R,B);n(R,[{key:"init",value:function N(){var V=function(ab){var aa='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';var Z=ab.fonts;if(Z){var ac,Y=-1,X=Z.length-1;while(Y<X){ac=Z[Y+=1];aa+=' <li data-name="'+(ac.name)+'" data-weight="'+(ac.weight)+'"> <canvas class="imglykit-controls-item-canvas"></canvas> </li> '}}aa+=' </ul></div><div class="imglykit-controls-button"> '+(ab.partials.fgColorPicker)+'</div><div class="imglykit-controls-button"> '+(ab.partials.bgColorPicker)+"</div>"+(ab.partials.doneButton);return aa};this._controlsTemplate=V;var W=function(Y){var X='<div class="imglykit-canvas-text-container"> <div class="imglykit-canvas-text"> <div class="imglykit-crosshair"> <img src="'+(Y.helpers.assetPath("ui/night/crosshair.png"))+'" /> </div> <div class="imglykit-canvas-text-textarea"> <textarea></textarea> <div class="imglykit-knob"></div> </div> </div></div>';return X};this._canvasControlsTemplate=W;this._partialTemplates.fgColorPicker=i["default"].template;this._partialTemplates.fgColorPicker.additionalContext={id:"imglykit-text-foreground-color-picker"};this._partialTemplates.bgColorPicker=i["default"].template;this._partialTemplates.bgColorPicker.additionalContext={id:"imglykit-text-background-color-picker"};this._fonts=[];this._addFonts()}},{key:"_renderControls",value:function I(){this._partialTemplates.fgColorPicker.additionalContext.label=this._ui.translate("controls.text.foreground");this._partialTemplates.bgColorPicker.additionalContext.label=this._ui.translate("controls.text.background");b(Object.getPrototypeOf(R.prototype),"_renderControls",this).call(this)}},{key:"_onEnter",value:function S(){var W=this;this._operationExistedBefore=!!this._ui.operations.text;this._operation=this._ui.getOrCreateOperation("text");this._ui.removeOperation("text");var V=this._ui.canvas.size;this._initialSettings={lineHeight:this._operation.getLineHeight(),fontSize:this._operation.getFontSize(),fontFamily:this._operation.getFontFamily(),fontWeight:this._operation.getFontWeight(),color:this._operation.getColor(),position:this._operation.getPosition(),text:this._operation.getText()||"",maxWidth:this._operation.getMaxWidth(),backgroundColor:this._operation.getBackgroundColor()};this._settings={lineHeight:this._initialSettings.lineHeight,fontSize:this._initialSettings.fontSize,fontFamily:this._initialSettings.fontFamily,fontWeight:this._initialSettings.fontWeight,color:this._initialSettings.color.clone(),position:this._initialSettings.position.clone().multiply(V),text:this._initialSettings.text,maxWidth:this._initialSettings.maxWidth*V.x,backgroundColor:this._initialSettings.backgroundColor.clone()};this._initialZoomLevel=this._ui.canvas.zoomLevel;this._container=this._canvasControls.querySelector(".imglykit-canvas-text");this._textarea=this._canvasControls.querySelector("textarea");this._textarea.focus();this._moveKnob=this._canvasControls.querySelector(".imglykit-crosshair");this._resizeKnob=this._canvasControls.querySelector(".imglykit-knob");if(this._operationExistedBefore){this._settings.position.x-=2;this._settings.position.y-=2}this._onTextareaKeyUp=this._onTextareaKeyUp.bind(this);this._onResizeKnobDown=this._onResizeKnobDown.bind(this);this._onResizeKnobDrag=this._onResizeKnobDrag.bind(this);this._onResizeKnobUp=this._onResizeKnobUp.bind(this);this._onMoveKnobDown=this._onMoveKnobDown.bind(this);this._onMoveKnobDrag=this._onMoveKnobDrag.bind(this);this._onMoveKnobUp=this._onMoveKnobUp.bind(this);this._onForegroundColorUpdate=this._onForegroundColorUpdate.bind(this);this._onBackgroundColorUpdate=this._onBackgroundColorUpdate.bind(this);this._initColorPickers();this._renderListItems();this._handleListItems();this._handleTextarea();this._handleResizeKnob();this._handleMoveKnob();setTimeout(function(){W._resizeTextarea()},1);this._ui.canvas.zoomToFit().then(function(){W._applySettings()})}},{key:"_initColorPickers",value:function w(){var W=this;var X=this._controls.querySelector("#imglykit-text-foreground-color-picker");this._foregroundColorPicker=new i["default"](this._ui,X);this._foregroundColorPicker.setValue(this._operation.getColor());this._foregroundColorPicker.on("update",this._onForegroundColorUpdate);this._foregroundColorPicker.on("show",function(){W._backgroundColorPicker.hide()});var V=this._controls.querySelector("#imglykit-text-background-color-picker");this._backgroundColorPicker=new i["default"](this._ui,V);this._backgroundColorPicker.setValue(this._operation.getBackgroundColor());this._backgroundColorPicker.on("update",this._onBackgroundColorUpdate);this._backgroundColorPicker.on("show",function(){W._foregroundColorPicker.hide()})}},{key:"_renderListItems",value:function z(){var ab=this._controls.querySelectorAll("li canvas");this._canvasItems=Array.prototype.slice.call(ab);for(var Z=0;Z<this._canvasItems.length;Z++){var X=this._canvasItems[Z];X.width=X.offsetWidth;X.height=X.offsetHeight;var aa=X.parentNode;var Y=X.getContext("2d");var V=aa.getAttribute("data-name");var W=aa.getAttribute("data-weight");Y.font=""+W+" 30px "+V;Y.textBaseline="middle";Y.textAlign="center";Y.fillStyle="white";Y.fillText(V.substr(0,2),X.width/2,X.height/2)}}},{key:"_handleListItems",value:function L(){var W=this;var X=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(X);var Y=function(aa){var ab=W._listItems[aa];var Z=ab.getAttribute("data-name");ab.addEventListener("click",function(){W._onListItemClick(ab)});if(!W._operationExistedBefore&&aa===0||W._operationExistedBefore&&Z===W._initialSettings.fontFamily){W._onListItemClick(ab,false)}};for(var V=0;V<this._listItems.length;V++){Y(V)}}},{key:"_handleTextarea",value:function D(){this._textarea.addEventListener("keyup",this._onTextareaKeyUp)}},{key:"_onTextareaKeyUp",value:function J(){this._resizeTextarea();this._settings.text=this._textarea.value;this._highlightDoneButton()}},{key:"_resizeTextarea",value:function v(){var Y=this._textarea.scrollTop;if(!Y){var X=undefined,V=undefined;do{X=this._textarea.scrollHeight;V=this._textarea.offsetHeight;this._textarea.style.height=""+(V-5)+"px"}while(X&&X!==this._textarea.scrollHeight)}var W=this._textarea.scrollHeight;this._textarea.style.height=""+(W+20)+"px"}},{key:"_handleMoveKnob",value:function y(){this._moveKnob.addEventListener("mousedown",this._onMoveKnobDown);this._moveKnob.addEventListener("touchstart",this._onMoveKnobDown)}},{key:"_onMoveKnobDown",value:function U(V){V.preventDefault();this._initialMousePosition=m["default"].getEventPosition(V);this._initialPosition=this._settings.position.clone();document.addEventListener("mousemove",this._onMoveKnobDrag);document.addEventListener("touchmove",this._onMoveKnobDrag);document.addEventListener("mouseup",this._onMoveKnobUp);document.addEventListener("tochend",this._onMoveKnobUp)}},{key:"_onMoveKnobDrag",value:function x(Y){Y.preventDefault();var W=this._ui.canvas.size;var ac=m["default"].getEventPosition(Y);var X=ac.clone().subtract(this._initialMousePosition);var ab=new e["default"](0,0);var aa=new e["default"](this._container.offsetWidth,this._container.offsetHeight);var Z=W.clone().subtract(aa);var V=this._initialPosition.clone().add(X).clamp(ab,Z);this._settings.position=V;this._container.style.left=""+V.x+"px";this._container.style.top=""+V.y+"px"}},{key:"_onMoveKnobUp",value:function H(){document.removeEventListener("mousemove",this._onMoveKnobDrag);document.removeEventListener("touchmove",this._onMoveKnobDrag);document.removeEventListener("mouseup",this._onMoveKnobUp);document.removeEventListener("touchend",this._onMoveKnobUp)}},{key:"_handleResizeKnob",value:function M(){this._resizeKnob.addEventListener("mousedown",this._onResizeKnobDown);this._resizeKnob.addEventListener("touchstart",this._onResizeKnobDown)}},{key:"_onResizeKnobDown",value:function E(V){V.preventDefault();this._initialMousePosition=m["default"].getEventPosition(V);this._initialMaxWidth=this._settings.maxWidth;document.addEventListener("mousemove",this._onResizeKnobDrag);document.addEventListener("touchmove",this._onResizeKnobDrag);document.addEventListener("mouseup",this._onResizeKnobUp);document.addEventListener("touchend",this._onResizeKnobUp)}},{key:"_onResizeKnobDrag",value:function P(aa){aa.preventDefault();var W=this._ui.canvas.size;var ab=m["default"].getEventPosition(aa);var Z=ab.subtract(this._initialMousePosition);var V=this._settings.position.clone();var X=W.x-V.x;var Y=this._initialMaxWidth+Z.x;Y=Math.max(100,Math.min(X,Y));this._settings.maxWidth=Y;this._textarea.style.width=""+Y+"px";this._resizeTextarea()}},{key:"_onResizeKnobUp",value:function t(){document.removeEventListener("mousemove",this._onResizeKnobDrag);document.removeEventListener("touchmove",this._onResizeKnobDrag);document.removeEventListener("mouseup",this._onResizeKnobUp);document.removeEventListener("touchend",this._onResizeKnobUp)}},{key:"_onForegroundColorUpdate",value:function T(V){this._settings.color=V;this._applySettings();this._highlightDoneButton()}},{key:"_onBackgroundColorUpdate",value:function u(V){this._settings.backgroundColor=V;this._applySettings();this._highlightDoneButton()}},{key:"_applySettings",value:function Q(){var W=this._textarea;var Y=this._settings;var V=this._ui.canvas.size;var X=Y.fontSize*V.y;this._container.style.left=""+Y.position.x+"px";this._container.style.top=""+Y.position.y+"px";W.value=Y.text;W.style.fontFamily=Y.fontFamily;W.style.fontSize=""+X+"px";W.style.fontWeight=Y.fontWeight;W.style.lineHeight=Y.lineHeight;W.style.color=Y.color.toRGBA();W.style.backgroundColor=Y.backgroundColor.toRGBA();W.style.width=""+Y.maxWidth+"px"}},{key:"_onListItemClick",value:function G(X){var V=arguments[1]===undefined?true:arguments[1];this._deactivateAllItems();var W=X.getAttribute("data-name");var Y=X.getAttribute("data-weight");this._settings.fontFamily=W;this._settings.fontWeight=Y;this._applySettings();X.classList.add("imglykit-controls-item-active");if(V){this._highlightDoneButton()}}},{key:"_deactivateAllItems",value:function A(){for(var V=0;V<this._listItems.length;V++){var W=this._listItems[V];W.classList.remove("imglykit-controls-item-active")}}},{key:"_addFonts",value:function F(){this.addFont("Helvetica","normal");this.addFont("Lucida Grande","normal");this.addFont("Times New Roman","normal")}},{key:"addFont",value:function C(V,W){this._fonts.push({name:V,weight:W})}},{key:"_onDone",value:function K(){var W=this._ui.canvas.size;var X=new e["default"](2,2);var V=this._settings.position.clone().add(X).divide(W);this._ui.canvas.setZoomLevel(this._initialZoomLevel,false);this._operation=this._ui.getOrCreateOperation("text");this._operation.set({fontSize:this._settings.fontSize,fontFamily:this._settings.fontFamily,fontWeight:this._settings.fontWeight,color:this._settings.color,backgroundColor:this._settings.backgroundColor,position:V,text:this._settings.text,maxWidth:this._settings.maxWidth/W.x});this._ui.canvas.render();this._ui.addHistory(this,{fontFamily:this._initialSettings.fontFamily,fontWeight:this._initialSettings.fontWeight,color:this._initialSettings.color.clone(),backgroundColor:this._initialSettings.backgroundColor.clone(),position:this._initialSettings.position.clone(),text:this._initialSettings.text,maxWidth:this._initialSettings.maxWidth},this._operationExistedBefore)}},{key:"_onBack",value:function O(){if(this._operationExistedBefore){this._operation=this._ui.getOrCreateOperation("text");this._operation.set(this._initialSettings)}else{this._ui.removeOperation("text")}this._ui.canvas.setZoomLevel(this._initialZoomLevel)}},{key:"context",get:function(){var V=b(Object.getPrototypeOf(R.prototype),"context",this);V.fonts=this._fonts;return V}}]);return R})(f["default"]);o.prototype.identifier="text";s["default"]=o;d.exports=s["default"]},function(d,u,e){Object.defineProperty(u,"__esModule",{value:true});var o=(function(){function v(z,x){for(var w=0;w<x.length;w++){var y=x[w];y.enumerable=y.enumerable||false;y.configurable=true;if("value" in y){y.writable=true}Object.defineProperty(z,y.key,y)}}return function(y,w,x){if(w){v(y.prototype,w)}if(x){v(y,x)}return y}})();var b=function r(C,B,A){var y=true;_function:while(y){var w=C,E=B,v=A;x=D=z=undefined;y=false;var x=Object.getOwnPropertyDescriptor(w,E);if(x===undefined){var D=Object.getPrototypeOf(w);if(D===null){return undefined}else{C=D;B=E;A=v;y=true;continue _function}}else{if("value" in x){return x.value}else{var z=x.get;if(z===undefined){return undefined}return z.call(v)}}}};function c(v){return v&&v.__esModule?v:{"default":v}}function g(v,w){if(!(v instanceof w)){throw new TypeError("Cannot call a class as a function")}}function l(w,v){if(typeof v!=="function"&&v!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof v)}w.prototype=Object.create(v&&v.prototype,{constructor:{value:w,enumerable:false,writable:true,configurable:true}});if(v){w.__proto__=v}}var i=e(101);var k=c(i);var p=e(74);var h=c(p);var s=e(5);var n=c(s);var q=e(82);var j=c(q);var f=e(58);var m=c(f);var t=(function(G){function S(U,V,T){g(this,S);b(Object.getPrototypeOf(S.prototype),"constructor",this).call(this);this._kit=U;this._ui=V;this._operation=T;this._helpers=new k["default"](this._kit,this._ui,this._ui.options);this._partialTemplates={doneButton:function(X){var W='<div class="imglykit-controls-button imglykit-controls-done"> <img src="'+(X.helpers.assetPath("ui/night/buttons/done.png"))+'" /> <div class="imglykit-controls-done-highlighted"> <img src="'+(X.helpers.assetPath("ui/night/buttons/done-highlighted.png"))+'" /> </div></div>';return W}};this._template=function(X){var W='<div class="imglykit-controls-'+(X.identifier)+'"> <div class="imglykit-controls-button imglykit-controls-back"> <img src="'+(X.helpers.assetPath("ui/night/buttons/back.png"))+'" /> </div> '+(X.partials.control)+"</div>";return W};this._active=false;this._historyItem=null;this.init()}l(S,G);o(S,[{key:"setContainers",value:function R(U,T){this._controlsContainer=U;this._canvasControlsContainer=T}},{key:"init",value:function J(){}},{key:"update",value:function B(){this._renderAllControls();this._onEnter()}},{key:"_setInitialValues",value:function L(){}},{key:"_renderAllControls",value:function v(){this._renderControls();this._renderCanvasControls();this._initScrollbar();this._handleBackAndDoneButtons();this._enableCanvasControls()}},{key:"_renderControls",value:function E(){if(typeof this._controlsTemplate==="undefined"){throw new Error("Control#_renderOverviewControls: Control needs to define this._controlsTemplate.")}var T=this._template(this._context);if(typeof this._controls!=="undefined"&&this._controls.parentNode!==null){this._controls.parentNode.removeChild(this._controls)}this._controls=document.createElement("div");this._controls.innerHTML=T;this._controlsContainer.appendChild(this._controls)}},{key:"_renderCanvasControls",value:function y(){if(typeof this._canvasControlsTemplate==="undefined"){return}var T=this._canvasControlsTemplate(this._context);if(typeof this._canvasControls!=="undefined"&&this._canvasControls.parentNode!==null){this._canvasControls.parentNode.removeChild(this._canvasControls)}this._canvasControls=document.createElement("div");this._canvasControls.innerHTML=T;this._canvasControlsContainer.appendChild(this._canvasControls)}},{key:"_initScrollbar",value:function D(){var T=this._controls.querySelector(".imglykit-controls-list");if(T){this._scrollbar=new j["default"](T.parentNode)}}},{key:"_removeControls",value:function w(){this._controls.parentNode.removeChild(this._controls);if(this._canvasControls){this._canvasControls.parentNode.removeChild(this._canvasControls)}if(this._scrollbar){this._scrollbar.remove()}}},{key:"_handleBackAndDoneButtons",value:function C(){this._backButton=this._controls.querySelector(".imglykit-controls-back");if(this._backButton){this._backButton.addEventListener("click",this._onBackButtonClick.bind(this))}this._doneButton=this._controls.querySelector(".imglykit-controls-done");if(this._doneButton){this._doneButton.addEventListener("click",this._onDoneButtonClick.bind(this))}}},{key:"_onBackButtonClick",value:function H(){this._onBack();this.emit("back")}},{key:"_onDoneButtonClick",value:function P(){this._onDone();this.emit("back")}},{key:"_highlightDoneButton",value:function x(){this._doneButton.classList.add("highlighted")}},{key:"enter",value:function N(){this._active=true;if(typeof this._canvasControlsTemplate!=="undefined"){this._ui.hideZoom()}this._renderAllControls();this._onEnter();this._setInitialValues()}},{key:"leave",value:function z(){this._active=false;this._ui.showZoom();this._removeControls();this._disableCanvasControls();this._onLeave()}},{key:"_enableCanvasControls",value:function M(){if(typeof this._canvasControlsTemplate==="undefined"){return}this._canvasControlsContainer.classList.remove("imglykit-canvas-controls-disabled")}},{key:"_disableCanvasControls",value:function Q(){if(typeof this._canvasControlsTemplate==="undefined"){return}this._canvasControlsContainer.classList.add("imglykit-canvas-controls-disabled")}},{key:"_onEnter",value:function O(){}},{key:"_onLeave",value:function A(){}},{key:"_onBack",value:function K(){}},{key:"_onDone",value:function F(){}},{key:"onZoom",value:function I(){}},{key:"_context",get:function(){var U=this.context;U=n["default"].extend(U,{helpers:this._helpers,identifier:this.identifier});U.partials={};for(var T in this._partialTemplates){var W=this._partialTemplates[T];var V=n["default"].extend({},U,W.additionalContext||{});U.partials[T]=W(V)}U.partials.control=this._controlsTemplate(U);return U}},{key:"context",get:function(){return{}}}]);return S})(h["default"]);t.prototype.identifier=null;t.extend=m["default"];u["default"]=t;d.exports=u["default"]},function(c,b,d){c.exports={operations:{brightness:"Brightness",contrast:"Contrast",filters:"Filters",flip:"Flip",frames:"Frames","radial-blur":"Radial Blur",rotation:"Rotation",saturation:"Saturation",stickers:"Stickers",text:"Text","tilt-shift":"Tilt-Shift",crop:"Crop"},"top-controls":{"new":"New",undo:"Undo","export":"Export",zoom:"Zoom"},splash:{upload:{headline:"Upload a picture",description:"Click here to upload a picture from your library or just drag and drop"},or:"or",webcam:{headline:"Take a picture",description:"Click here to take a picture with your webcam or phone"}},generic:{loading:"Loading",exporting:"Exporting",color:"Color"},controls:{frames:{color:"Color"},text:{foreground:"Foreground",background:"Background"}}}},function(c,b,d){c.exports={operations:{brightness:"Helligkeit",contrast:"Kontrast",filters:"Filter",flip:"Spiegeln",frames:"Rahmen","radial-blur":"Radial Blur",rotation:"Drehung",saturation:"Sättigung",stickers:"Sticker",text:"Text","tilt-shift":"Tilt-Shift",crop:"Zuschneiden"},"top-controls":{"new":"Neu",undo:"Rückgängig","export":"Exportieren",zoom:"Zoom"},splash:{upload:{headline:"Bild hochladen",description:"Klicke hier, um ein Bild hochzuladen oder ziehe eine Bilddatei hier her"},or:"oder",webcam:{headline:"Foto machen",description:"Klicke hier, um ein Foto mit deiner Webcam oder deinem Smartphone zu machen"}},generic:{loading:"Laden",exporting:"Exportiere"},controls:{frames:{color:"Farbe"},text:{foreground:"Text",background:"Hintergrund"}}}},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function e(w,v,s){var t=true;_function:while(t){var q=w,y=v,p=s;r=x=u=undefined;t=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;s=p;t=true;continue _function}}else{if("value" in r){return r.value}else{var u=r.get;if(u===undefined){return undefined}return u.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var h=c(50);var l=o(h);var b=c(74);var m=o(b);var g=(function(p){function v(H,G){j(this,v);k(Object.getPrototypeOf(v.prototype),"constructor",this).call(this);this._canvas=G||this.createCanvas();if(!G){this.setSize(H)}this._context=this._getContext();this._cache={}}n(v,p);f(v,[{key:"cache",value:function q(G){}},{key:"drawCached",value:function D(G){}},{key:"createCanvas",value:function y(K,H){var J=typeof window!=="undefined";var I;if(J){I=document.createElement("canvas")}else{var G=c(53);I=new G()}if(typeof K!=="undefined"){I.width=K}if(typeof H!=="undefined"){I.height=H}return I}},{key:"getSize",value:function F(){return new l["default"](this._canvas.width,this._canvas.height)}},{key:"setSize",value:function x(G){this._canvas.width=G.x;this._canvas.height=G.y}},{key:"_getContext",value:function r(){throw new Error("Renderer#_getContext is abstract and not implemented in inherited class.")}},{key:"resizeTo",value:function w(G){throw new Error("Renderer#resizeTo is abstract and not implemented in inherited class.")}},{key:"drawImage",value:function u(G){throw new Error("Renderer#drawImage is abstract and not implemented in inherited class.")}},{key:"renderFinal",value:function t(){}},{key:"getCanvas",value:function A(){return this._canvas}},{key:"getContext",value:function C(){return this._context}},{key:"setCanvas",value:function E(G){this._canvas=G;this._context=this._getContext();this.emit("new-canvas",this._canvas)}},{key:"setContext",value:function B(G){this._context=G}},{key:"reset",value:function z(){var G=arguments[0]===undefined?false:arguments[0]}},{key:"identifier",get:function(){return null}}],[{key:"isSupported",value:function s(){throw new Error("Renderer#isSupported is abstract and not implemented in inherited class.")}}]);return v})(m["default"]);i["default"]=g;d.exports=i["default"]},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function h(l){f(this,h);l=l||{};this._glslPrograms={};this._options=l}d(h,[{key:"render",value:function j(l){if(l.identifier==="webgl"){this.renderWebGL(l)}else{this.renderCanvas(l)}}},{key:"renderWebGL",value:function k(l){throw new Error("Primitive#renderWebGL is abstract and not implemented in inherited class.")}},{key:"renderCanvas",value:function i(l){throw new Error("Primitive#renderCanvas is abstract and not implemented in inherited class.")}},{key:"options",get:function(){return this._options}}]);return h})();c["default"]=b;e.exports=c["default"]},function(c,b,d){var e;(function(h,g){
/*!
	 * Native Promise Only
	 * v0.8.0-a (c) Kyle Simpson
	 * MIT License: http://getify.mit-license.org
	 * @license
	 */
"use strict";(function i(j,l,k){l[j]=l[j]||k();if(typeof c!="undefined"&&c.exports){c.exports=l[j]}else{if(true){!(e=function m(){return l[j]}.call(b,d,b,c),e!==undefined&&(c.exports=e))}}})("Promise",typeof h!="undefined"?h:undefined,function f(){var o,s,E,t=Object.prototype.toString,q=typeof g!="undefined"?function q(F){return g(F)}:setTimeout;try{Object.defineProperty({},"x",{});o=function o(H,G,I,F){return Object.defineProperty(H,G,{value:I,writable:true,configurable:F!==false})}}catch(n){o=function o(G,F,H){G[F]=H;return G}}E=(function C(){var K,I,H;function G(M,L){this.fn=M;this.self=L;this.next=void 0}return{add:function J(M,L){H=new G(M,L);if(I){I.next=H}else{K=H}I=H;H=void 0},drain:function F(){var L=K;K=I=s=void 0;while(L){L.fn.call(L.self);L=L.next}}}})();function A(G,F){E.add(G,F);if(!s){s=q(E.drain)}}function D(H){var G,F=typeof H;if(H!=null&&(F=="object"||F=="function")){G=H.then}return typeof G=="function"?G:false}function r(){for(var F=0;F<this.chain.length;F++){j(this,this.state===1?this.chain[F].success:this.chain[F].failure,this.chain[F])}this.chain.length=0}function j(G,F,I){var H,K;try{if(F===false){I.reject(G.msg)}else{if(F===true){H=G.msg}else{H=F.call(void 0,G.msg)}if(H===I.promise){I.reject(TypeError("Promise-chain cycle"))}else{if(K=D(H)){K.call(H,I.resolve,I.reject)}else{I.resolve(H)}}}}catch(J){I.reject(J)}}function w(I){var H,F=this;if(F.triggered){return}F.triggered=true;if(F.def){F=F.def}try{if(H=D(I)){A(function(){var K=new p(F);try{H.call(I,function M(){w.apply(K,arguments)},function J(){m.apply(K,arguments)})}catch(L){m.call(K,L)}})}else{F.msg=I;F.state=1;if(F.chain.length>0){A(r,F)}}}catch(G){m.call(new p(F),G)}}function m(G){var F=this;if(F.triggered){return}F.triggered=true;if(F.def){F=F.def}F.msg=G;F.state=2;if(F.chain.length>0){A(r,F)}}function u(J,G,I,H){for(var F=0;F<G.length;F++){(function K(L){J.resolve(G[L]).then(function M(N){I(L,N)},H)})(F)}}function p(F){this.def=F;this.triggered=false}function x(F){this.promise=F;this.state=0;this.triggered=false;this.chain=[];this.msg=void 0}function l(L){if(typeof L!="function"){throw TypeError("Not a function")}if(this.__NPO__!==0){throw TypeError("Not a promise")}this.__NPO__=1;var J=new x(this);this["then"]=function K(P,M){var O={success:typeof P=="function"?P:true,failure:typeof M=="function"?M:false};O.promise=new this.constructor(function N(R,Q){if(typeof R!="function"||typeof Q!="function"){throw TypeError("Not a function")}O.resolve=R;O.reject=Q});J.chain.push(O);if(J.state!==0){A(r,J)}return O.promise};this["catch"]=function G(M){return this.then(void 0,M)};try{L.call(void 0,function I(M){w.call(J,M)},function F(M){m.call(J,M)})}catch(H){m.call(J,H)}}var k=o({},"constructor",l,false);l.prototype=k;o(k,"__NPO__",0,false);o(l,"resolve",function z(G){var F=this;if(G&&typeof G=="object"&&G.__NPO__===1){return G}return new F(function H(J,I){if(typeof J!="function"||typeof I!="function"){throw TypeError("Not a function")}J(G)})});o(l,"reject",function B(F){return new this(function G(I,H){if(typeof I!="function"||typeof H!="function"){throw TypeError("Not a function")}H(F)})});o(l,"all",function v(F){var G=this;if(t.call(F)!="[object Array]"){return G.reject(TypeError("Not an array"))}if(F.length===0){return G.resolve([])}return new G(function H(M,L){if(typeof M!="function"||typeof L!="function"){throw TypeError("Not a function")}var I=F.length,K=Array(I),J=0;u(G,F,function N(O,P){K[O]=P;if(++J===I){M(K)}},L)})});o(l,"race",function y(F){var G=this;if(t.call(F)!="[object Array]"){return G.reject(TypeError("Not an array"))}return new G(function H(J,I){if(typeof J!="function"||typeof I!="function"){throw TypeError("Not a function")}u(G,F,function K(L,M){J(M)},I)})});return l})}.call(b,(function(){return this}()),d(105).setImmediate))},function(e,b,g){Object.defineProperty(b,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var c=(function(){function i(l,m,k){f(this,i);this._kit=l;this._ui=m;this._options=k}d(i,[{key:"assetPath",value:function h(k){var m=this._options.assetsUrl+"/"+k;var l=this._ui.options.ui.assetPathResolver;if(typeof l!=="undefined"){m=l(m)}return m}},{key:"translate",value:function j(k){return this._ui.translate(k)}}]);return i})();b["default"]=c;e.exports=b["default"]},function(d,j,c){Object.defineProperty(j,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var l=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var b=c(74);var n=p(b);var g=c(5);var q=p(g);var i=c(50);var m=p(i);var h=(function(r){function v(D,C){k(this,v);l(Object.getPrototypeOf(v.prototype),"constructor",this).call(this);this._element=D;this._options=q["default"].defaults(C,{minValue:0,maxValue:1,defaultValue:0});this._value=this._options.defaultValue;this._sliderElement=this._element.querySelector(".imglykit-slider-slider");this._dotElement=this._element.querySelector(".imglykit-slider-dot");this._centerDotElement=this._element.querySelector(".imglykit-slider-center-dot");this._fillElement=this._element.querySelector(".imglykit-slider-fill");this._backgroundElement=this._element.querySelector(".imglykit-slider-background");this._onMouseDown=this._onMouseDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onCenterDotClick=this._onCenterDotClick.bind(this);this._onBackgroundClick=this._onBackgroundClick.bind(this);this._backgroundElement.addEventListener("click",this._onBackgroundClick);this._fillElement.addEventListener("click",this._onBackgroundClick);this._handleDot()}o(v,r);f(v,[{key:"setValue",value:function t(G){this._value=G;var C=this._options;var I=C.maxValue;var F=C.minValue;var H=I-F;var D=(G-F)/H;var E=this._sliderElement.offsetWidth;this._setX(E*D)}},{key:"_setX",value:function x(C){this._xPosition=C;this._dotElement.style.left=""+C+"px";var D=this._sliderElement.offsetWidth/2;var E=C-D;this._fillElement.style.width=""+Math.abs(E)+"px";if(E<0){this._fillElement.style.left=D-Math.abs(E)+"px"}else{this._fillElement.style.left=D+"px"}}},{key:"_handleDot",value:function u(){this._dotElement.addEventListener("mousedown",this._onMouseDown);this._dotElement.addEventListener("touchstart",this._onMouseDown);if(this._centerDotElement){this._centerDotElement.addEventListener("click",this._onCenterDotClick)}}},{key:"_onCenterDotClick",value:function y(){this.setValue(this._options.defaultValue);this.emit("update",this._value)}},{key:"_onBackgroundClick",value:function B(F){var C=q["default"].getEventPosition(F);var E=this._sliderElement.getBoundingClientRect();E=new m["default"](E.left,E.y);var D=C.clone().subtract(E);this._setX(D.x);this._updateValue()}},{key:"_onMouseDown",value:function z(E){if(E.type==="mousedown"&&E.button!==0){return}E.preventDefault();var F=q["default"].getEventPosition(E);document.addEventListener("mousemove",this._onMouseMove);document.addEventListener("touchmove",this._onMouseMove);document.addEventListener("mouseup",this._onMouseUp);document.addEventListener("touchend",this._onMouseUp);var D=this._dotElement.getBoundingClientRect();var C=this._sliderElement.getBoundingClientRect();this._initialSliderX=D.left-C.left;this._initialMousePosition=F}},{key:"_onMouseMove",value:function s(F){F.preventDefault();var H=q["default"].getEventPosition(F);var G=H.subtract(this._initialMousePosition);var E=this._dotElement.offsetWidth*0.5;var C=this._initialSliderX+G.x+E;var D=this._sliderElement.offsetWidth;C=Math.max(0,Math.min(C,D));this._setX(C);this._updateValue()}},{key:"_updateValue",value:function A(){var E=this._sliderElement.offsetWidth;var D=this._options;var G=D.minValue;var H=D.maxValue;var C=this._xPosition/E;var F=G+(H-G)*C;this.emit("update",F)}},{key:"_onMouseUp",value:function w(){document.removeEventListener("mousemove",this._onMouseMove);document.removeEventListener("touchmove",this._onMouseMove);document.removeEventListener("mouseup",this._onMouseUp);document.removeEventListener("touchend",this._onMouseUp)}}],[{key:"template",get:function(){return function(D){var C='<div class="imglykit-slider" id="'+((typeof D.id==="undefined"?"":D.id))+'"> <div class="imglykit-slider-minus"> <img src="'+(D.helpers.assetPath("ui/night/slider/minus.png"))+'" /> </div> <div class="imglykit-slider-slider"> <div class="imglykit-slider-content"> <div class="imglykit-slider-background"></div> <div class="imglykit-slider-fill"></div> <div class="imglykit-slider-center-dot"></div> <div class="imglykit-slider-dot"></div> </div> </div> <div class="imglykit-slider-plus"> <img src="'+(D.helpers.assetPath("ui/night/slider/plus.png"))+'" /> </div></div>';return C}}}]);return v})(n["default"]);j["default"]=h;d.exports=j["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(102);var g=k(h);var j=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);d(l,[{key:"_setX",value:function m(o){this._xPosition=o;this._dotElement.style.left=""+o+"px";this._fillElement.style.width=""+o+"px"}}],[{key:"template",get:function(){return function(p){var o='<div class="imglykit-slider" id="'+((typeof p.id==="undefined"?"":p.id))+'"> <div class="imglykit-slider-minus"> <img src="'+(p.helpers.assetPath("ui/night/slider/minus.png"))+'" /> </div> <div class="imglykit-slider-slider"> <div class="imglykit-slider-content"> <div class="imglykit-slider-background"></div> <div class="imglykit-slider-fill"></div> <div class="imglykit-slider-dot"></div> </div> </div> <div class="imglykit-slider-plus"> <img src="'+(p.helpers.assetPath("ui/night/slider/plus.png"))+'" /> </div></div>';return o}}}]);return l})(g["default"]);e["default"]=j;c.exports=e["default"]},function(e,t,g){Object.defineProperty(t,"__esModule",{value:true});var o=(function(){function u(y,w){for(var v=0;v<w.length;v++){var x=w[v];x.enumerable=x.enumerable||false;x.configurable=true;if("value" in x){x.writable=true}Object.defineProperty(y,x.key,x)}}return function(x,v,w){if(v){u(x.prototype,v)}if(w){u(x,w)}return x}})();var c=function r(B,A,z){var x=true;_function:while(x){var v=B,D=A,u=z;w=C=y=undefined;x=false;var w=Object.getOwnPropertyDescriptor(v,D);if(w===undefined){var C=Object.getPrototypeOf(v);if(C===null){return undefined}else{B=C;A=D;z=u;x=true;continue _function}}else{if("value" in w){return w.value}else{var y=w.get;if(y===undefined){return undefined}return y.call(u)}}}};function d(u){return u&&u.__esModule?u:{"default":u}}function h(y,x){if(Array.isArray(y)){return y}else{if(Symbol.iterator in Object(y)){var B=[];var u=true;var A=false;var z=undefined;try{for(var w=y[Symbol.iterator](),C;!(u=(C=w.next()).done);u=true){B.push(C.value);if(x&&B.length===x){break}}}catch(v){A=true;z=v}finally{try{if(!u&&w["return"]){w["return"]()}}finally{if(A){throw z}}}return B}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}function j(u,v){if(!(u instanceof v)){throw new TypeError("Cannot call a class as a function")}}function m(v,u){if(typeof u!=="function"&&u!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof u)}v.prototype=Object.create(u&&u.prototype,{constructor:{value:v,enumerable:false,writable:true,configurable:true}});if(u){v.__proto__=u}}var p=g(74);var k=d(p);var s=g(5);var n=d(s);var q=g(9);var i=d(q);var l=g(50);var f=d(l);var b=(function(T){function u(Z,Y){j(this,u);c(Object.getPrototypeOf(u.prototype),"constructor",this).call(this);this._ui=Z;this._element=Y;this._visible=false;this._loaded=false;this._overlay=this._element.querySelector(".imglykit-color-picker-overlay");this._currentColorCanvas=this._element.querySelector(".imglykit-color-picker-color");this._alphaCanvas=this._element.querySelector("canvas.imglykit-color-picker-alpha");this._alphaKnob=this._element.querySelector(".imglykit-color-picker-alpha-container .imglykit-transparent-knob");this._hueCanvas=this._element.querySelector("canvas.imglykit-color-picker-hue");this._hueKnob=this._element.querySelector(".imglykit-color-picker-hue-container .imglykit-transparent-knob");this._saturationCanvas=this._element.querySelector("canvas.imglykit-color-picker-saturation");this._saturationKnob=this._element.querySelector(".imglykit-color-picker-saturation-container .imglykit-transparent-knob");this._transparencyImage=new Image();this._transparencyImage.src=Z.helpers.assetPath("ui/night/transparency.png");this._transparencyImage.addEventListener("load",this._onTransparencyImageLoad.bind(this));this._onAlphaCanvasDown=this._onAlphaCanvasDown.bind(this);this._onAlphaCanvasDrag=this._onAlphaCanvasDrag.bind(this);this._onAlphaCanvasUp=this._onAlphaCanvasUp.bind(this);this._onHueCanvasDown=this._onHueCanvasDown.bind(this);this._onHueCanvasDrag=this._onHueCanvasDrag.bind(this);this._onHueCanvasUp=this._onHueCanvasUp.bind(this);this._onSaturationCanvasDown=this._onSaturationCanvasDown.bind(this);this._onSaturationCanvasDrag=this._onSaturationCanvasDrag.bind(this);this._onSaturationCanvasUp=this._onSaturationCanvasUp.bind(this);this._onElementClick=this._onElementClick.bind(this);this._handleToggle();this._handleAlphaKnob();this._handleHueKnob();this._handleSaturationKnob()}m(u,T);o(u,[{key:"_onTransparencyImageLoad",value:function X(){this._loaded=true;this._render()}},{key:"_handleToggle",value:function z(){this._element.addEventListener("click",this._onElementClick)}},{key:"_onElementClick",value:function U(Y){if(Y.target===this._element||Y.target===this._currentColorCanvas){if(this._visible){this.hide();this.emit("hide")}else{this.show();this.emit("show")}}}},{key:"hide",value:function M(){this._overlay.classList.remove("imglykit-visible");this._visible=false}},{key:"show",value:function W(){this._overlay.classList.add("imglykit-visible");this._visible=true}},{key:"setValue",value:function A(ad){this._value=ad.clone();var ab=this._value.toHSV();var ac=h(ab,3);var aa=ac[0];var Z=ac[1];var Y=ac[2];this._hsvColor={h:aa,s:Z,v:Y};this._positionKnobs();this._render()}},{key:"_positionKnobs",value:function y(){this._positionAlphaKnob();this._positionHueKnob();this._positionSaturationKnob()}},{key:"_positionAlphaKnob",value:function I(){var Z=this._alphaCanvas;var Y=new f["default"](Z.width,Z.height);var aa=this._value.a*Y.x;this._alphaKnob.style.left=""+aa+"px"}},{key:"_positionHueKnob",value:function J(){var Z=this._hueCanvas;var Y=new f["default"](Z.width,Z.height);var aa=this._hsvColor.h*Y.y;this._hueKnob.style.top=""+aa+"px"}},{key:"_positionSaturationKnob",value:function D(){var Z=this._saturationCanvas;var Y=new f["default"](Z.width,Z.height);var ab=this._hsvColor.s*Y.x;this._saturationKnob.style.left=""+ab+"px";var aa=(1-this._hsvColor.v)*Y.y;this._saturationKnob.style.top=""+aa+"px"}},{key:"_render",value:function F(){if(!this._loaded){return}this._renderCurrentColor();this._renderAlpha();this._renderHue();this._renderSaturation()}},{key:"_renderCurrentColor",value:function G(){var Y=this._currentColorCanvas;var Z=Y.getContext("2d");var aa=Z.createPattern(this._transparencyImage,"repeat");Z.rect(0,0,Y.width,Y.height);Z.fillStyle=aa;Z.fill();Z.fillStyle=this._value.toRGBA();Z.fill()}},{key:"_renderAlpha",value:function H(){var Z=this._alphaCanvas;var aa=Z.getContext("2d");var ab=aa.createPattern(this._transparencyImage,"repeat");aa.rect(0,0,Z.width,Z.height);aa.fillStyle=ab;aa.fill();var ac=aa.createLinearGradient(0,0,Z.width,Z.height);var Y=this._value.clone();Y.a=0;ac.addColorStop(0,Y.toRGBA());ac.addColorStop(1,this._value.toHex());aa.fillStyle=ac;aa.fill()}},{key:"_renderHue",value:function w(){var Z=this._hueCanvas;var aa=Z.getContext("2d");var Y=new i["default"]();for(var ac=0;ac<Z.height;ac++){var ab=ac/Z.height;Y.fromHSV(ab,1,1);aa.strokeStyle=Y.toRGBA();aa.beginPath();aa.moveTo(0,ac);aa.lineTo(Z.width,ac);aa.stroke()}}},{key:"_renderSaturation",value:function x(){var ab=this._saturationCanvas;var aa=ab.getContext("2d");var Z=aa.getImageData(0,0,ab.width,ab.height);var ac=new i["default"](1,0,0,1);for(var ah=0;ah<ab.height;ah++){var ak=(ab.height-ah)/ab.height;for(var aj=0;aj<ab.width;aj++){var ad=aj/ab.width;ac.fromHSV(this._hsvColor.h,ad,ak);var Y=ac.r;var ae=ac.g;var ag=ac.b;var ai=ac.a;var af=(ah*ab.width+aj)*4;Z.data[af]=Y*255;Z.data[af+1]=ae*255;Z.data[af+2]=ag*255;Z.data[af+3]=ai*255}}aa.putImageData(Z,0,0)}},{key:"_handleAlphaKnob",value:function C(){this._alphaCanvas.addEventListener("mousedown",this._onAlphaCanvasDown);this._alphaCanvas.addEventListener("touchstart",this._onAlphaCanvasDown)}},{key:"_onAlphaCanvasDown",value:function S(Y){Y.preventDefault();this._onAlphaCanvasDrag(Y);document.addEventListener("mousemove",this._onAlphaCanvasDrag);document.addEventListener("touchmove",this._onAlphaCanvasDrag);document.addEventListener("mouseup",this._onAlphaCanvasUp);document.addEventListener("touchend",this._onAlphaCanvasUp)}},{key:"_onAlphaCanvasDrag",value:function v(ac){ac.preventDefault();var Z=this._alphaCanvas;var af=new f["default"](Z.width,Z.height);var ae=n["default"].getEventPosition(ac);var ag=Z.getBoundingClientRect();var aa=ag.left;var ad=ag.top;var ab=new f["default"](aa,ad);var Y=ae.subtract(ab);Y.clamp(new f["default"](0,0),af);this._alphaKnob.style.left=""+Y.x+"px";this._value.a=Y.x/af.x;this._updateColor()}},{key:"_onAlphaCanvasUp",value:function O(){document.removeEventListener("mousemove",this._onAlphaCanvasDrag);document.removeEventListener("touchmove",this._onAlphaCanvasDrag);document.removeEventListener("mouseup",this._onAlphaCanvasUp);document.removeEventListener("touchend",this._onAlphaCanvasUp)}},{key:"_handleHueKnob",value:function N(){this._hueCanvas.addEventListener("mousedown",this._onHueCanvasDown);this._hueCanvas.addEventListener("touchstart",this._onHueCanvasDown)}},{key:"_onHueCanvasDown",value:function E(Y){Y.preventDefault();this._onHueCanvasDrag(Y);document.addEventListener("mousemove",this._onHueCanvasDrag);document.addEventListener("touchmove",this._onHueCanvasDrag);document.addEventListener("mouseup",this._onHueCanvasUp);document.addEventListener("touchend",this._onHueCanvasUp)}},{key:"_onHueCanvasDrag",value:function Q(ad){ad.preventDefault();var Z=this._hueCanvas;var ag=new f["default"](Z.width,Z.height);var af=n["default"].getEventPosition(ad);var ab=Z.getBoundingClientRect();var aa=ab.left;var ae=ab.top;var ac=new f["default"](aa,ae);var Y=af.subtract(ac);Y.clamp(new f["default"](0,0),ag);this._hueKnob.style.top=""+Y.y+"px";Y.divide(ag);this._hsvColor.h=Y.y;this._updateColor()}},{key:"_onHueCanvasUp",value:function L(){document.removeEventListener("mousemove",this._onHueCanvasDrag);document.removeEventListener("touchmove",this._onHueCanvasDrag);document.removeEventListener("mouseup",this._onHueCanvasUp);document.removeEventListener("touchend",this._onHueCanvasUp)}},{key:"_handleSaturationKnob",value:function V(){this._saturationCanvas.addEventListener("mousedown",this._onSaturationCanvasDown);this._saturationCanvas.addEventListener("touchstart",this._onSaturationCanvasDown)}},{key:"_onSaturationCanvasDown",value:function B(Y){Y.preventDefault();this._onSaturationCanvasDrag(Y);document.addEventListener("mousemove",this._onSaturationCanvasDrag);document.addEventListener("touchmove",this._onSaturationCanvasDrag);document.addEventListener("mouseup",this._onSaturationCanvasUp);document.addEventListener("touchend",this._onSaturationCanvasUp)}},{key:"_onSaturationCanvasDrag",value:function P(ad){ad.preventDefault();var Z=this._saturationCanvas;var ag=new f["default"](Z.width,Z.height);var af=n["default"].getEventPosition(ad);var ab=Z.getBoundingClientRect();var aa=ab.left;var ae=ab.top;var ac=new f["default"](aa,ae);var Y=af.subtract(ac);Y.clamp(0,Z.width);this._saturationKnob.style.left=""+Y.x+"px";this._saturationKnob.style.top=""+Y.y+"px";Y.divide(ag);this._hsvColor.s=Y.x;this._hsvColor.v=1-Y.y;this._updateColor()}},{key:"_onSaturationCanvasUp",value:function R(){document.removeEventListener("mousemove",this._onSaturationCanvasDrag);document.removeEventListener("touchmove",this._onSaturationCanvasDrag);document.removeEventListener("mouseup",this._onSaturationCanvasUp);document.removeEventListener("touchend",this._onSaturationCanvasUp)}},{key:"_updateColor",value:function K(){this._value.fromHSV(this._hsvColor.h,this._hsvColor.s,this._hsvColor.v);this.emit("update",this._value);this._render()}}],[{key:"template",get:function(){return function(Z){var Y='<div class="imglykit-color-picker" id="'+((typeof Z.id==="undefined"?"":Z.id))+'"> <canvas class="imglykit-color-picker-color" width="34" height="34"></canvas> <div class="imglykit-controls-item-label">'+((typeof Z.label==="undefined"?"":Z.label))+'</div> <div class="imglykit-color-picker-overlay"> <div class="imglykit-color-picker-alpha-container"> <canvas class="imglykit-color-picker-alpha" width="200" height="30"></canvas> <div class="imglykit-transparent-knob"></div> </div> <div class="imglykit-color-picker-saturation-container"> <canvas class="imglykit-color-picker-saturation" width="160" height="160"></canvas> <div class="imglykit-transparent-knob"></div> </div> <div class="imglykit-color-picker-hue-container"> <canvas class="imglykit-color-picker-hue" width="30" height="160"></canvas> <div class="imglykit-transparent-knob"></div> </div> </div></div>';return Y}}}]);return u})(k["default"]);t["default"]=b;e.exports=t["default"]},function(c,b,d){(function(h,i){var k=d(106).nextTick;var e=Function.prototype.apply;var j=Array.prototype.slice;var l={};var f=0;b.setTimeout=function(){return new g(e.call(setTimeout,window,arguments),clearTimeout)};b.setInterval=function(){return new g(e.call(setInterval,window,arguments),clearInterval)};b.clearTimeout=b.clearInterval=function(m){m.close()};function g(n,m){this._id=n;this._clearFn=m}g.prototype.unref=g.prototype.ref=function(){};g.prototype.close=function(){this._clearFn.call(window,this._id)};b.enroll=function(m,n){clearTimeout(m._idleTimeoutId);m._idleTimeout=n};b.unenroll=function(m){clearTimeout(m._idleTimeoutId);m._idleTimeout=-1};b._unrefActive=b.active=function(m){clearTimeout(m._idleTimeoutId);var o=m._idleTimeout;if(o>=0){m._idleTimeoutId=setTimeout(function n(){if(m._onTimeout){m._onTimeout()}},o)}};b.setImmediate=typeof h==="function"?h:function(o){var p=f++;var n=arguments.length<2?false:j.call(arguments,1);l[p]=true;k(function m(){if(l[p]){if(n){o.apply(null,n)}else{o.call(null)}b.clearImmediate(p)}});return p};b.clearImmediate=typeof i==="function"?i:function(m){delete l[m]}}.call(b,d(105).setImmediate,d(105).clearImmediate))},function(d,f,c){var b=d.exports={};var g=[];var k=false;var h;var i=-1;function j(){k=false;if(h.length){g=h.concat(g)}else{i=-1}if(g.length){m()}}function m(){if(k){return}var o=setTimeout(j);k=true;var n=g.length;while(n){h=g;g=[];while(++i<n){h[i].run()}i=-1;n=g.length}h=null;k=false;clearTimeout(o)}b.nextTick=function(n){var o=new Array(arguments.length-1);if(arguments.length>1){for(var p=1;p<arguments.length;p++){o[p-1]=arguments[p]}}g.push(new e(n,o));if(g.length===1&&!k){setTimeout(m,0)}};function e(n,o){this.fun=n;this.array=o}e.prototype.run=function(){this.fun.apply(null,this.array)};b.title="browser";b.browser=true;b.env={};b.argv=[];b.version="";b.versions={};function l(){}b.on=l;b.addListener=l;b.once=l;b.off=l;b.removeListener=l;b.removeAllListeners=l;b.emit=l;b.binding=function(n){throw new Error("process.binding is not supported")};b.cwd=function(){return"/"};b.chdir=function(n){throw new Error("process.chdir is not supported")};b.umask=function(){return 0}}])});