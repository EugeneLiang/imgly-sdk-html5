(function webpackUniversalModuleDefinition(a,b){if(typeof exports==="object"&&typeof module==="object"){module.exports=b(require("canvas"))}else{if(typeof define==="function"&&define.amd){define(["canvas"],b)}else{if(typeof exports==="object"){exports.ImglyKit=b(require("canvas"))}else{a.ImglyKit=b(a.canvas)}}}})(this,function(a){return(function(b){var c={};function d(f){if(c[f]){return c[f].exports}var e=c[f]={exports:{},id:f,loaded:false};b[f].call(e.exports,e,e.exports,d);e.loaded=true;return e.exports}d.m=b;d.c=c;d.p="";return d(0)})([function(d,t,e){
/*!
	 * Photo Editor SDK - photoeditorsdk.com
	 * Copyright (c) 2013-2015 9elements GmbH
	 *
	 * Released under Attribution-NonCommercial 3.0 Unported
	 * http://creativecommons.org/licenses/by-nc/3.0/
	 *
	 * For commercial use, please contact us at contact@9elements.com
	 */
"use strict";Object.defineProperty(t,"__esModule",{value:true});var o=(function(){function u(y,w){for(var v=0;v<w.length;v++){var x=w[v];x.enumerable=x.enumerable||false;x.configurable=true;if("value" in x){x.writable=true}Object.defineProperty(y,x.key,x)}}return function(x,v,w){if(v){u(x.prototype,v)}if(w){u(x,w)}return x}})();function c(u){return u&&u.__esModule?u:{"default":u}}function g(u,v){if(!(u instanceof v)){throw new TypeError("Cannot call a class as a function")}}var j=e(1);var k=c(j);var h=e(2);var b=c(h);var i=e(3);var l=c(i);var m=e(4);var f=c(m);var q=e(5);var r=e(6);var n=c(r);var p="2.0.0-beta.17";var s=(function(){function x(G){g(this,x);if(typeof G==="undefined"){throw new Error("No options given.")}G=k["default"].defaults(G,{assetsUrl:"assets",container:null,renderOnWindowResize:false});G.ui=G.ui||{};G.ui=k["default"].defaults(G.ui,{enabled:true});if(typeof G.image==="undefined"&&!G.ui.enabled){throw new Error("`options.image` needs to be set when UI is disabled.")}this._options=G;this.operationsStack=[];this._registeredUIs={};this._registerUIs();this._registeredOperations={};this._registerOperations();if(typeof window!=="undefined"){this._versionChecker=new f["default"](p)}if(this._options.ui.enabled){this._initUI();if(this._options.renderOnWindowResize){this._handleWindowResize()}}}o(x,[{key:"render",value:function u(H,L,G,O){var N=this;var J=l["default"].validateSettings(H,L);H=J.renderType;L=J.imageFormat;var I=new b["default"](this._options.image,this.operationsStack,G,this._options.renderer);for(var M=0;M<this.operationsStack.length;M++){var K=this.operationsStack[M];if(!K){continue}K.dirty=true}return I.render().then(function(){var P=I.getRenderer().getCanvas();return l["default"]["export"](N._options.image,P,H,L,O)})}},{key:"reset",value:function A(){}},{key:"getAssetPath",value:function z(H){var G=typeof window!=="undefined";if(G){return this._options.assetsUrl+"/"+H}else{var I=e(52);return I.resolve(this._options.assetsUrl,H)}}},{key:"_handleWindowResize",value:function y(){var G=this;var H=null;window.addEventListener("resize",function(){if(H!==null){clearTimeout(H)}H=setTimeout(function(){H=null;G.ui.render()},300)})}},{key:"_registerUIs",value:function E(){this.registerUI(x.NightUI)}},{key:"_registerOperations",value:function D(){for(var G in x.Operations){this.registerOperation(x.Operations[G])}}},{key:"registerOperation",value:function B(G){this._registeredOperations[G.prototype.identifier]=G;if(this.ui){this.ui.addOperation(G)}}},{key:"registerUI",value:function F(G){this._registeredUIs[G.prototype.identifier]=G}},{key:"_initUI",value:function v(){var G;if(this._options.ui.enabled===true){G=n["default"].values(this._registeredUIs)[0]}if(!G){return}this.ui=new G(this,this._options)}},{key:"getOperationFromStack",value:function C(H){var G=this.operationsStack.filter(function(I){return I.identifier===H})[0];return G}},{key:"run",value:function w(){if(typeof this.ui!=="undefined"){this.ui.run()}}},{key:"registeredOperations",get:function(){return this._registeredOperations}}]);return x})();s.version=p;s.RenderImage=b["default"];s.Color=e(7);s.Filter=e(8);s.Operation=e(9);s.Operations={};s.Operations.Filters=e(10);s.Operations.Crop=e(11);s.Operations.Rotation=e(12);s.Operations.Saturation=e(13);s.Operations.Contrast=e(14);s.Operations.Brightness=e(15);s.Operations.Flip=e(16);s.Operations.TiltShift=e(17);s.Operations.RadialBlur=e(18);s.Operations.Text=e(19);s.Operations.Stickers=e(20);s.Operations.Frames=e(21);s.Filters={};s.Filters.A15=e(22);s.Filters.Breeze=e(23);s.Filters.BW=e(24);s.Filters.BWHard=e(25);s.Filters.Celsius=e(26);s.Filters.Chest=e(27);s.Filters.Fixie=e(28);s.Filters.Food=e(29);s.Filters.Fridge=e(30);s.Filters.Front=e(31);s.Filters.Glam=e(32);s.Filters.Gobblin=e(33);s.Filters.K1=e(34);s.Filters.K2=e(35);s.Filters.K6=e(36);s.Filters.KDynamic=e(37);s.Filters.Lenin=e(38);s.Filters.Lomo=e(39);s.Filters.Mellow=e(40);s.Filters.Morning=e(41);s.Filters.Orchid=e(42);s.Filters.Pola=e(43);s.Filters.Pola669=e(44);s.Filters.Quozi=e(45);s.Filters.Semired=e(46);s.Filters.Sunny=e(47);s.Filters.Texas=e(48);s.Filters.X400=e(49);s.RenderType=q.RenderType;s.ImageFormat=q.ImageFormat;s.Vector2=e(50);s.NightUI=e(51);t["default"]=s;d.exports=t["default"]},function(c,b,d){var e;(function(f,g){
/*!
	 * @license
	 * lodash 3.10.1 (Custom Build) <https://lodash.com/>
	 * Build: `lodash modern include="defaults,extend"`
	 * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>
	 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
	 * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
	 * Available under MIT license <https://lodash.com/license>
	 */
"use strict";(function(){var r;var A="3.10.1";var p="Expected a function";var y="[object Array]",T="[object Function]";var Z=/^\[object .+?Constructor\]$/;var ah=/^\d+$/;var K={"function":true,object:true};var ac=K[typeof b]&&b&&!b.nodeType&&b;var E=K[typeof f]&&f&&!f.nodeType&&f;var C=ac&&E&&typeof g=="object"&&g&&g.Object&&g;var X=K[typeof self]&&self&&self.Object&&self;var n=K[typeof window]&&window&&window.Object&&window;var Y=E&&E.exports===ac&&ac;var H=C||n!==(this&&this.window)&&n||X||this;function ab(ai){return !!ai&&typeof ai=="object"}var i=Object.prototype;var Q=Function.prototype.toString;var q=i.hasOwnProperty;var N=i.toString;var u=RegExp("^"+Q.call(q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var S=i.propertyIsEnumerable;var D=R(Array,"isArray"),m=R(Object,"keys"),s=Math.max;var o=9007199254740991;function L(){}function J(ai,aj){return ai===r?aj:ai}function j(al,ai,ak){var am=-1,an=I(ai),aj=an.length;while(++am<aj){var ap=an[am],ao=al[ap],aq=ak(ao,ai[ap],ap,al,ai);if((aq===aq?aq!==ao:ao===ao)||ao===r&&!(ap in al)){al[ap]=aq}}return al}function t(ai,aj){return aj==null?ai:F(aj,I(aj),ai)}function F(an,al,aj){aj||(aj={});var ai=-1,am=al.length;while(++ai<am){var ak=al[ai];aj[ak]=an[ak]}return aj}function z(ai){return function(aj){return aj==null?r:aj[ai]}}function v(aj,ai,ak){if(typeof aj!="function"){return V}if(ai===r){return aj}switch(ak){case 1:return function(al){return aj.call(ai,al)};case 3:return function(am,al,an){return aj.call(ai,am,al,an)};case 4:return function(al,an,am,ao){return aj.call(ai,al,an,am,ao)};case 5:return function(ap,al,an,am,ao){return aj.call(ai,ap,al,an,am,ao)}}return function(){return aj.apply(ai,arguments)}}function B(ai){return M(function(am,al){var ak=-1,ap=am==null?0:al.length,an=ap>2?al[ap-2]:r,ao=ap>2?al[2]:r,aj=ap>1?al[ap-1]:r;if(typeof an=="function"){an=v(an,aj,5);ap-=2}else{an=typeof aj=="function"?aj:r;ap-=an?1:0}if(ao&&af(al[0],al[1],ao)){an=ap<3?r:an;ap=1}while(++ak<ap){var aq=al[ak];if(aq){ai(am,aq,an)}}return am})}function l(ai,aj){return M(function(al){var ak=al[0];if(ak==null){return ak}al.push(aj);return ai.apply(r,al)})}var ad=z("length");function R(ai,aj){var ak=ai==null?r:ai[aj];return k(ak)?ak:r}function O(ai){return ai!=null&&x(ad(ai))}function ag(aj,ai){aj=typeof aj=="number"||ah.test(aj)?+aj:-1;ai=ai==null?o:ai;return aj>-1&&aj%1==0&&aj<ai}function af(am,ak,aj){if(!U(aj)){return false}var al=typeof ak;if(al=="number"?O(aj)&&ag(ak,aj.length):al=="string"&&ak in aj){var ai=aj[ak];return am===am?am===ai:ai!==ai}return false}function x(ai){return typeof ai=="number"&&ai>-1&&ai%1==0&&ai<=o}function h(al){var ao=ae(al),an=ao.length,ap=an&&al.length;var aj=!!ap&&x(ap)&&(G(al)||W(al));var ak=-1,ai=[];while(++ak<an){var am=ao[ak];if(aj&&ag(am,ap)||q.call(al,am)){ai.push(am)}}return ai}function M(ai,aj){if(typeof ai!="function"){throw new TypeError(p)}aj=s(aj===r?ai.length-1:+aj||0,0);return function(){var am=arguments,al=-1,ao=s(am.length-aj,0),an=Array(ao);while(++al<ao){an[al]=am[aj+al]}switch(aj){case 0:return ai.call(this,an);case 1:return ai.call(this,am[0],an);case 2:return ai.call(this,am[0],am[1],an)}var ak=Array(aj+1);al=-1;while(++al<aj){ak[al]=am[al]}ak[aj]=an;return ai.apply(this,ak)}}function W(ai){return ab(ai)&&O(ai)&&q.call(ai,"callee")&&!S.call(ai,"callee")}var G=D||function(ai){return ab(ai)&&x(ai.length)&&N.call(ai)==y};function w(ai){return U(ai)&&N.call(ai)==T}function U(aj){var ai=typeof aj;return !!aj&&(ai=="object"||ai=="function")}function k(ai){if(ai==null){return false}if(w(ai)){return u.test(Q.call(ai))}return ab(ai)&&Z.test(ai)}var aa=B(function(ai,ak,aj){return aj?j(ai,ak,aj):t(ai,ak)});var P=l(aa,J);var I=!m?h:function(aj){var ai=aj==null?r:aj.constructor;if(typeof ai=="function"&&ai.prototype===aj||typeof aj!="function"&&O(aj)){return h(aj)}return U(aj)?m(aj):[]};function ae(al){if(al==null){return[]}if(!U(al)){al=Object(al)}var ao=al.length;ao=ao&&x(ao)&&(G(al)||W(al))&&ao||0;var ak=al.constructor,aj=-1,ap=typeof ak=="function"&&ak.prototype===al,ai=Array(ao),an=ao>0;while(++aj<ao){ai[aj]=aj+""}for(var am in al){if(!(an&&ag(am,ao))&&!(am=="constructor"&&(ap||!q.call(al,am)))){ai.push(am)}}return ai}function V(ai){return ai}L.assign=aa;L.defaults=P;L.keys=I;L.keysIn=ae;L.restParam=M;L.extend=aa;L.identity=V;L.isArguments=W;L.isArray=G;L.isFunction=w;L.isNative=k;L.isObject=U;L.VERSION=A;if(true){H._=L;!(e=function(){return L}.call(b,d,b,f),e!==r&&(f.exports=e))}else{if(ac&&E){if(Y){(E.exports=L)._=L}else{ac._=L}}else{H._=L}}}).call(undefined)}.call(b,d(94)(c),(function(){return this}())))},function(f,k,e){Object.defineProperty(k,"__esModule",{value:true});var i=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();function p(q){return q&&q.__esModule?q:{"default":q}}function l(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}var g=e(54);var m=p(g);var c=e(50);var o=p(c);var b=e(55);var j=p(b);var d=e(56);var h=p(d);var n=(function(){function s(x,v,u,w){l(this,s);this._options={preferredRenderer:w};this._webglEnabled=false;this._renderer=null;this._image=x;this._stack=v;this._dimensions=new m["default"](u);this._initialDimensions=new o["default"](this._image.width,this._image.height);this._initRenderer()}i(s,[{key:"_initRenderer",value:function q(){if(h["default"].isSupported()&&this._options.preferredRenderer!=="canvas"){this._renderer=new h["default"](this._initialDimensions);this._webglEnabled=true}else{if(j["default"].isSupported()){this._renderer=new j["default"](this._initialDimensions);this._webglEnabled=false}}if(this._renderer===null){throw new Error("Neither Canvas nor WebGL renderer are supported.")}this._renderer.drawImage(this._image)}},{key:"render",value:function t(){var y=this;var u=this.sanitizedStack;var x=[];for(var w=0;w<u.length;w++){var v=u[w];x.push(v.validateSettings())}return Promise.all(x).then(function(){var B=[];for(var A=0;A<u.length;A++){var z=u[A];B.push(z.render(y._renderer))}return Promise.all(B)}).then(function(){return y._renderer.renderFinal()}).then(function(){var A=y._renderer.getSize();var z=y._dimensions.calculateFinalDimensions(A);if(z.equals(A)){return}return y._renderer.resizeTo(z)})}},{key:"getRenderer",value:function r(){return this._renderer}},{key:"sanitizedStack",get:function(){var w=[];for(var v=0;v<this._stack.length;v++){var u=this._stack[v];if(!u){continue}w.push(u)}return w}}]);return s})();k["default"]=n;f.exports=k["default"]},function(c,b,d){(function(e){Object.defineProperty(b,"__esModule",{value:true});var i=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();function o(q){return q&&q.__esModule?q:{"default":q}}function k(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}var g=d(5);var l=d(57);var n=o(l);var p=d(6);var f=o(p);var m=d(58);var h=o(m);var j=(function(){function s(){k(this,s)}i(s,null,[{key:"validateSettings",value:function r(u,v){var t={renderType:u,imageFormat:v};if(typeof t.renderType!=="undefined"&&t.renderType!==null&&f["default"].values(g.RenderType).indexOf(t.renderType)===-1){throw new Error("Invalid render type: "+t.renderType)}else{if(typeof u==="undefined"){t.renderType=g.RenderType.DATAURL}}if(typeof t.imageFormat!=="undefined"&&t.imageFormat!==null&&f["default"].values(g.ImageFormat).indexOf(t.imageFormat)===-1){throw new Error("Invalid image format: "+t.imageFormat)}else{if(typeof v==="undefined"){t.imageFormat=g.ImageFormat.PNG}}if(t.renderType===g.RenderType.BUFFER&&typeof e==="undefined"){throw new Error("Render type 'buffer' is only available when using node.js")}return t}},{key:"export",value:function q(w,t,u,v){var x=arguments[4]===undefined?0.8:arguments[4];return new h["default"](function(D,C){var y=undefined;if(u===g.RenderType.IMAGE||u===g.RenderType.DATAURL){if(typeof window==="undefined"){y=t.toDataURL(v)}else{y=t.toDataURL(v,x)}var z=/^data:image\/jpeg/i;if(w.src.match(z)&&y.match(z)){y=n["default"].restore(w.src,y)}}if(u===g.RenderType.IMAGE){var A=undefined;if(typeof window==="undefined"){var B=d(53).Image;A=new B()}else{A=new Image()}A.src=y;D(A)}else{if(u===g.RenderType.DATAURL){D(y)}else{if(u===g.RenderType.BUFFER){D(t.toBuffer())}else{if(u===g.RenderType.MSBLOB){D(t.msToBlob())}else{if(u===g.RenderType.BLOB){t.toBlob(function(E){D(E)},v,x)}}}}}})}}]);return s})();b["default"]=j;c.exports=b["default"]}.call(b,d(75)))},function(e,b,h){Object.defineProperty(b,"__esModule",{value:true});var d=(function(){function j(n,l){for(var k=0;k<l.length;k++){var m=l[k];m.enumerable=m.enumerable||false;m.configurable=true;if("value" in m){m.writable=true}Object.defineProperty(n,m.key,m)}}return function(m,k,l){if(k){j(m.prototype,k)}if(l){j(m,l)}return m}})();function g(j,k){if(!(j instanceof k)){throw new TypeError("Cannot call a class as a function")}}var c="imglySDKVersionCallback";var i="http://sdk.img.ly/version.json?sdk=html5&jsoncallback="+c;var f=(function(){function k(l){g(this,k);this._version=l;this._check()}d(k,[{key:"_check",value:function j(){var m=this;window[c]=function(n){if(n.outdated){console.warn("imgly-sdk-html5: Your version "+m._version+" is outdated.");console.warn("imgly-sdk-html5: Current version is "+n.version+".")}};var l=document.createElement("script");l.src=i+"&version="+this._version;l.async=true;document.getElementsByTagName("head")[0].appendChild(l)}}]);return k})();b["default"]=f;e.exports=b["default"]},function(e,d,f){Object.defineProperty(d,"__esModule",{value:true});var c={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"};d.RenderType=c;var b={PNG:"image/png",JPEG:"image/jpeg"};d.ImageFormat=b},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function k(o,m){for(var l=0;l<m.length;l++){var n=m[l];n.enumerable=n.enumerable||false;n.configurable=true;if("value" in n){n.writable=true}Object.defineProperty(o,n.key,n)}}return function(n,l,m){if(l){k(n.prototype,l)}if(m){k(n,m)}return n}})();function j(k){return k&&k.__esModule?k:{"default":k}}function g(k,l){if(!(k instanceof l)){throw new TypeError("Cannot call a class as a function")}}var b=c(50);var i=j(b);var h=(function(){function p(){g(this,p)}e(p,null,[{key:"isArray",value:function m(q){return Object.prototype.toString.call(q)==="[object Array]"}},{key:"select",value:function k(r){var q=arguments[1]===undefined?null:arguments[1];if(q===null){return r}if(typeof q==="string"){q=q.split(",").map(function(s){return s.trim()})}if(p.isArray(q)){q={only:q}}if(typeof q.only!=="undefined"){if(typeof q.only==="string"){q.only=q.only.split(",").map(function(s){return s.trim()})}return r.filter(function(s){return q.only.indexOf(s)!==-1})}else{if(typeof q.except!=="undefined"){if(typeof q.except==="string"){q.except=q.except.split(",").map(function(s){return s.trim()})}return r.filter(function(s){return q.except.indexOf(s)===-1})}}throw new Error("Utils#select failed to filter items.")}},{key:"values",value:function n(r){var q=[];for(var s in r){q.push(r[s])}return q}},{key:"isDOMElement",value:function o(q){return typeof HTMLElement==="object"?q instanceof HTMLElement:q&&typeof q==="object"&&q!==null&&q.nodeType===1&&typeof q.nodeName==="string"}},{key:"getEventPosition",value:function l(r){var q=r.pageX;var s=r.pageY;if(r.type.indexOf("touch")!==-1){q=r.touches[0].pageX;s=r.touches[0].pageY}return new i["default"](q,s)}}]);return p})();f["default"]=h;d.exports=f["default"]},function(d,b,g){Object.defineProperty(b,"__esModule",{value:true});var c=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var e=(function(){function k(v,u,s,t){f(this,k);if(typeof t==="undefined"){t=1}this.r=v;this.g=u;this.b=s;this.a=t}c(k,[{key:"toRGBA",value:function m(){var r=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255),this.a];return"rgba("+r.join(",")+")"}},{key:"toHex",value:function o(){var r=[this._componentToHex(Math.round(this.r*255)),this._componentToHex(Math.round(this.g*255)),this._componentToHex(Math.round(this.b*255))];return"#"+r.join("")}},{key:"toGLColor",value:function j(){return[this.r,this.g,this.b,this.a]}},{key:"toRGBGLColor",value:function i(){return[this.r,this.g,this.b]}},{key:"toHSV",value:function q(){var r=Math.max(this.r,this.g,this.b);var u=Math.min(this.r,this.g,this.b);var x=undefined;var w=undefined;var t=r;var y=r-u;w=r===0?0:y/r;if(r===u){x=0}else{switch(r){case this.r:x=(this.g-this.b)/y+(this.g<this.b?6:0);break;case this.g:x=(this.b-this.r)/y+2;break;case this.b:x=(this.r-this.g)/y+4;break}x/=6}return[x,w,t]}},{key:"fromHSV",value:function n(z,F,D){var u=this.r;var A=this.g;var C=this.b;var y=Math.floor(z*6);var B=z*6-y;var x=D*(1-F);var w=D*(1-B*F);var E=D*(1-(1-B)*F);switch(y%6){case 0:u=D;A=E;C=x;break;case 1:u=w;A=D;C=x;break;case 2:u=x;A=D;C=E;break;case 3:u=x;A=w;C=D;break;case 4:u=E;A=x;C=D;break;case 5:u=D;A=x;C=w;break}this.r=u;this.g=A;this.b=C}},{key:"clone",value:function p(){return new k(this.r,this.g,this.b,this.a)}},{key:"_componentToHex",value:function h(r){var s=r.toString(16);return s.length===1?"0"+s:s}},{key:"toString",value:function l(){return"Color("+this.r+", "+this.g+", "+this.b+", "+this.a+")"}}]);return k})();b["default"]=e;d.exports=b["default"]},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function h(){f(this,h)}d(h,[{key:"render",value:function i(j){throw new Error("Filter#render is abstract and not implemented in inherited class.")}}],[{key:"identifier",get:function(){return null}}]);return h})();b.extend=g(59);b.PrimitivesStack=g(60);b.Primitives={};b.Primitives.Saturation=g(61);b.Primitives.LookupTable=g(62);b.Primitives.ToneCurve=g(63);b.Primitives.SoftColorOverlay=g(64);b.Primitives.Desaturation=g(65);b.Primitives.X400=g(66);b.Primitives.Grayscale=g(67);b.Primitives.Contrast=g(68);b.Primitives.Glow=g(69);b.Primitives.Gobblin=g(70);b.Primitives.Brightness=g(71);c["default"]=b;e.exports=c["default"]},function(d,w,g){Object.defineProperty(w,"__esModule",{value:true});var s=(function(){function x(B,z){for(var y=0;y<z.length;y++){var A=z[y];A.enumerable=A.enumerable||false;A.configurable=true;if("value" in A){A.writable=true}Object.defineProperty(B,A.key,A)}}return function(A,y,z){if(y){x(A.prototype,y)}if(z){x(A,z)}return A}})();var b=function v(E,D,A){var B=true;_function:while(B){var y=E,G=D,x=A;z=F=C=undefined;B=false;var z=Object.getOwnPropertyDescriptor(y,G);if(z===undefined){var F=Object.getPrototypeOf(y);if(F===null){return undefined}else{E=F;D=G;A=x;B=true;continue _function}}else{if("value" in z){return z.value}else{var C=z.get;if(C===undefined){return undefined}return C.call(x)}}}};function c(x){return x&&x.__esModule?x:{"default":x}}function j(x,y){if(!(x instanceof y)){throw new TypeError("Cannot call a class as a function")}}function p(y,x){if(typeof x!=="function"&&x!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof x)}y.prototype=Object.create(x&&x.prototype,{constructor:{value:y,enumerable:false,writable:true,configurable:true}});if(x){y.__proto__=x}}var o=g(1);var q=c(o);var m=g(50);var e=c(m);var u=g(7);var h=c(u);var t=g(73);var k=c(t);var l=g(58);var f=c(l);var i=g(59);var r=c(i);var n=(function(x){function D(J,I){j(this,D);b(Object.getPrototypeOf(D.prototype),"constructor",this).call(this);this._kit=J;this.availableOptions=q["default"].extend(this.availableOptions||{},{numberFormat:{type:"string","default":"relative",available:["absolute","relative"]}});this._dirty=true;this._glslPrograms={};this._uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(M){var L=Math.random()*16|0;var K=M==="x"?L:L&3|8;return K.toString(16)});this._initOptions(I||{})}p(D,x);s(D,[{key:"validateSettings",value:function E(){var J=this;var I=this.identifier;return new f["default"](function(N,M){for(var L in J.availableOptions){var K=J.availableOptions[L];if(K.required&&typeof J._options[L]==="undefined"){return M(new Error("Operation `"+I+"`: Option `"+L+"` is required."))}}N()})}},{key:"render",value:function z(J){var I=undefined;if(J.identifier==="webgl"){I=this._renderWebGL.bind(this)}else{I=this._renderCanvas.bind(this)}if(this._dirty){I(J);J.cache(this._uuid);this._dirty=false}else{J.drawCached(this._uuid)}}},{key:"_renderWebGL",value:function B(){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}},{key:"_renderCanvas",value:function y(){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}},{key:"_initOptions",value:function G(N){this._options={};var J,L,M;var I=this;for(J in this.availableOptions){M=J.charAt(0).toUpperCase()+J.slice(1);L=this.availableOptions[J];var K=function K(O,P){I["set"+M]=function(Q){I._setOption(O,Q)};I["get"+M]=function(){return I._getOption(O)}};K(J,L);if(typeof L["default"]!=="undefined"){this["set"+M](L["default"])}}for(J in N){if(typeof this.availableOptions[J]==="undefined"){throw new Error("Invalid option: "+J)}M=J.charAt(0).toUpperCase()+J.slice(1);this["set"+M](N[J])}}},{key:"set",value:function F(I){for(var J in I){this._setOption(J,I[J],false)}this.emit("update")}},{key:"_getOption",value:function H(I){return this._options[I]}},{key:"_setOption",value:function A(K,M){var N=arguments[2]===undefined?true:arguments[2];var I=this.availableOptions[K];var J=this.identifier;if(typeof I.setter!=="undefined"){M=I.setter.call(this,M)}if(typeof I.validation!=="undefined"){I.validation(M)}switch(I.type){case"string":if(typeof M!=="string"){throw new Error("Operation `"+J+"`: Option `"+K+"` has to be a string.")}var L=I.available;if(typeof L!=="undefined"&&L.indexOf(M)===-1){throw new Error("Operation `"+J+"`: Invalid value for `"+K+"` (valid values are: "+I.available.join(", ")+")")}this._options[K]=M;break;case"number":if(typeof M!=="number"){throw new Error("Operation `"+J+"`: Option `"+K+"` has to be a number.")}this._options[K]=M;break;case"boolean":if(typeof M!=="boolean"){throw new Error("Operation `"+J+"`: Option `"+K+"` has to be a boolean.")}this._options[K]=M;break;case"vector2":if(!(M instanceof e["default"])){throw new Error("Operation `"+J+"`: Option `"+K+"` has to be an instance of ImglyKit.Vector2.")}this._options[K]=M.clone();break;case"color":if(!(M instanceof h["default"])){throw new Error("Operation `"+J+"`: Option `"+K+"` has to be an instance of ImglyKit.Color.")}this._options[K]=M;break;case"object":this._options[K]=M;break}this._dirty=true;if(N){this.emit("update")}}},{key:"getNewDimensions",value:function C(K,J){var I=K.getCanvas();J=J||new e["default"](I.width,I.height);return J}},{key:"dirty",set:function(I){this._dirty=I},get:function(){return this._dirty}}]);return D})(k["default"]);n.prototype.identifier=null;n.extend=r["default"];w["default"]=n;d.exports=w["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var d=(function(){function o(s,q){for(var p=0;p<q.length;p++){var r=q[p];r.enumerable=r.enumerable||false;r.configurable=true;if("value" in r){r.writable=true}Object.defineProperty(s,r.key,r)}}return function(r,p,q){if(p){o(r.prototype,p)}if(q){o(r,q)}return r}})();function m(o){return o&&o.__esModule?o:{"default":o}}function g(o,p){if(!(o instanceof p)){throw new TypeError("Cannot call a class as a function")}}function l(p,o){if(typeof o!=="function"&&o!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof o)}p.prototype=Object.create(o&&o.prototype,{constructor:{value:p,enumerable:false,writable:true,configurable:true}});if(o){p.__proto__=o}}var h=b(9);var k=m(h);var n=b(72);var j=m(n);var i=(function(q){function r(){g(this,r);if(q!=null){q.apply(this,arguments)}}l(r,q);d(r,[{key:"_renderWebGL",value:function o(t){this._render(t)}},{key:"_renderCanvas",value:function p(t){this._render(t)}},{key:"_render",value:function s(t){this._selectedFilter.render(t)}}]);return r})(k["default"]);i.prototype.identifier="filters";i.prototype.availableOptions={filter:{type:"object","default":j["default"],setter:function e(o){this._selectedFilter=new o();return o}}};f["default"]=i;c.exports=f["default"]},function(d,h,c){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var j=function e(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var l=c(9);var m=o(l);var g=c(50);var k=o(g);var b=(function(r){function s(){for(var u=arguments.length,v=Array(u),w=0;w<u;w++){v[w]=arguments[w]}i(this,s);j(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,v);this.fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n      uniform vec2 u_cropStart;\n      uniform vec2 u_cropEnd;\n\n      void main() {\n        vec2 size = u_cropEnd - u_cropStart;\n        gl_FragColor = texture2D(u_image, v_texCoord * size + u_cropStart);\n      }\n    "}n(s,r);f(s,[{key:"_renderWebGL",value:function p(z){var x=z.getCanvas();var u=new k["default"](x.width,x.height);var A=this._options.start.clone();var v=this._options.end.clone();if(this._options.numberFormat==="absolute"){A.divide(u);v.divide(u)}var y=A.y;A.y=1-v.y;v.y=1-y;var w=this.getNewDimensions(z);x.width=w.x;x.height=w.y;z.runShader(null,this.fragmentShader,{uniforms:{u_cropStart:{type:"2f",value:[A.x,A.y]},u_cropEnd:{type:"2f",value:[v.x,v.y]}}})}},{key:"_renderCanvas",value:function q(z){var v=z.getCanvas();var y=new k["default"](v.width,v.height);var u=this.getNewDimensions(z);var w=z.createCanvas();w.width=u.x;w.height=u.y;var A=w.getContext("2d");var x=this._options.start.clone();if(this._options.numberFormat==="relative"){x.multiply(y)}A.drawImage(v,x.x,x.y,u.x,u.y,0,0,u.x,u.y);z.setCanvas(w)}},{key:"getNewDimensions",value:function t(x,w){var v=x.getCanvas();w=w||new k["default"](v.width,v.height);var u=this._options.end.clone().subtract(this._options.start);if(this._options.numberFormat==="relative"){u.multiply(w)}return u}}]);return s})(m["default"]);b.prototype.identifier="crop";b.prototype.availableOptions={start:{type:"vector2",required:true,"default":new k["default"](0,0)},end:{type:"vector2",required:true,"default":new k["default"](1,1)}};h["default"]=b;d.exports=h["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function q(u,s){for(var r=0;r<s.length;r++){var t=s[r];t.enumerable=t.enumerable||false;t.configurable=true;if("value" in t){t.writable=true}Object.defineProperty(u,t.key,t)}}return function(t,r,s){if(r){q(t.prototype,r)}if(s){q(t,s)}return t}})();var j=function d(x,w,v){var t=true;_function:while(t){var r=x,z=w,q=v;s=y=u=undefined;t=false;var s=Object.getOwnPropertyDescriptor(r,z);if(s===undefined){var y=Object.getPrototypeOf(r);if(y===null){return undefined}else{x=y;w=z;v=q;t=true;continue _function}}else{if("value" in s){return s.value}else{var u=s.get;if(u===undefined){return undefined}return u.call(q)}}}};function o(q){return q&&q.__esModule?q:{"default":q}}function i(q,r){if(!(q instanceof r)){throw new TypeError("Cannot call a class as a function")}}function n(r,q){if(typeof q!=="function"&&q!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof q)}r.prototype=Object.create(q&&q.prototype,{constructor:{value:r,enumerable:false,writable:true,configurable:true}});if(q){r.__proto__=q}}var l=b(9);var m=o(l);var g=b(50);var k=o(g);var p=(function(t){function s(){for(var v=arguments.length,w=Array(v),x=0;x<v;x++){w[x]=arguments[x]}i(this,s);j(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,w);this.vertexShader="\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n      uniform mat3 u_matrix;\n\n      void main() {\n        gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1);\n        v_texCoord = a_texCoord;\n      }\n    "}n(s,t);f(s,[{key:"_renderWebGL",value:function q(A){var x=A.getCanvas();var v=this._options.degrees%360;if(v%180!==0){var w=this.getNewDimensions(A);x.width=w.x;x.height=w.y}var B=v*(Math.PI/180);var C=Math.cos(B);var z=Math.sin(B);var y=[C,-z,0,z,C,0,0,0,1];A.runShader(this.vertexShader,null,{uniforms:{u_matrix:{type:"mat3fv",value:y}}})}},{key:"_renderCanvas",value:function r(A){var x=A.getCanvas();var v=this._options.degrees%360;var w=this.getNewDimensions(A);var y=A.createCanvas();y.width=w.x;y.height=w.y;var B=y.getContext("2d");B.save();B.translate(y.width/2,y.height/2);B.rotate(v*(Math.PI/180));var z=A.cloneCanvas();B.drawImage(z,-x.width/2,-x.height/2);B.restore();A.setCanvas(y)}},{key:"getNewDimensions",value:function u(z,y){var w=z.getCanvas();y=y||new k["default"](w.width,w.height);var v=this._options.degrees%360;if(v%180!==0){var x=y.x;y.x=y.y;y.y=x}return y}}]);return s})(m["default"]);p.prototype.identifier="rotation";p.prototype.availableOptions={degrees:{type:"number","default":0,validation:function e(q){if(q%90!==0){throw new Error("RotationOperation: `rotation` has to be a multiple of 90.")}}}};h["default"]=p;c.exports=h["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();function o(p){return p&&p.__esModule?p:{"default":p}}function g(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function k(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var i=c(9);var j=o(i);var h=c(60);var l=o(h);var n=c(61);var m=o(n);var b=(function(r){function t(){g(this,t);if(r!=null){r.apply(this,arguments)}}k(t,r);e(t,[{key:"_renderWebGL",value:function p(u){this._render(u)}},{key:"_renderCanvas",value:function q(u){this._render(u)}},{key:"_render",value:function s(u){if(!this._stack){this._stack=new l["default"]();this._primitive=new m["default"]({saturation:this._options.saturation});this._stack.add(this._primitive)}this._primitive.options.saturation=this._options.saturation;this._stack.render(u)}}]);return t})(j["default"]);b.prototype.identifier="saturation";b.prototype.availableOptions={saturation:{type:"number","default":1}};f["default"]=b;d.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();function n(p){return p&&p.__esModule?p:{"default":p}}function g(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var i=b(9);var k=n(i);var h=b(60);var m=n(h);var d=b(68);var j=n(d);var o=(function(s){function q(){g(this,q);if(s!=null){s.apply(this,arguments)}}l(q,s);e(q,[{key:"_renderWebGL",value:function p(u){this._render(u)}},{key:"_renderCanvas",value:function r(u){this._render(u)}},{key:"_render",value:function t(u){if(!this._stack){this._stack=new m["default"]();this._primitive=new j["default"]({contrast:this._options.contrast});this._stack.add(this._primitive)}this._primitive.options.contrast=this._options.contrast;this._stack.render(u)}}]);return q})(k["default"]);o.prototype.identifier="contrast";o.prototype.availableOptions={contrast:{type:"number","default":1}};f["default"]=o;c.exports=f["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();function n(p){return p&&p.__esModule?p:{"default":p}}function h(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function l(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var j=c(9);var k=n(j);var i=c(60);var m=n(i);var e=c(71);var b=n(e);var o=(function(r){function s(){h(this,s);if(r!=null){r.apply(this,arguments)}}l(s,r);f(s,[{key:"_renderWebGL",value:function p(u){this._render(u)}},{key:"_renderCanvas",value:function q(u){this._render(u)}},{key:"_render",value:function t(u){if(!this._stack){this._stack=new m["default"]();this._primitive=new b["default"]({brightness:this._options.brightness});this._stack.add(this._primitive)}this._primitive.options.brightness=this._options.brightness;this._stack.render(u)}}]);return s})(k["default"]);o.prototype.identifier="brightness";o.prototype.availableOptions={brightness:{type:"number","default":0}};g["default"]=o;d.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var h=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var i=b(9);var k=m(i);var j=(function(p){function q(){for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}g(this,q);h(Object.getPrototypeOf(q.prototype),"constructor",this).apply(this,s);this.fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n      uniform bool u_flipVertical;\n      uniform bool u_flipHorizontal;\n\n      void main() {\n        vec2 texCoord = vec2(v_texCoord);\n        if (u_flipVertical) {\n          texCoord.y = 1.0 - texCoord.y;\n        }\n        if (u_flipHorizontal) {\n          texCoord.x = 1.0 - texCoord.x;\n        }\n        gl_FragColor = texture2D(u_image, texCoord);\n      }\n    "}l(q,p);e(q,[{key:"_renderWebGL",value:function n(r){r.runShader(null,this.fragmentShader,{uniforms:{u_flipVertical:{type:"f",value:this._options.vertical},u_flipHorizontal:{type:"f",value:this._options.horizontal}}})}},{key:"_renderCanvas",value:function o(w){var t=w.getCanvas();var u=w.getContext();var s=1,r=1;var y=0,x=0;if(this._options.horizontal){s=-1;y=t.width}if(this._options.vertical){r=-1;x=t.height}u.save();u.translate(y,x);u.scale(s,r);var v=w.cloneCanvas();u.drawImage(v,0,0);u.restore()}}]);return q})(k["default"]);j.prototype.identifier="flip";j.prototype.availableOptions={horizontal:{type:"boolean","default":false},vertical:{type:"boolean","default":false}};f["default"]=j;c.exports=f["default"]},function(f,s,h){Object.defineProperty(s,"__esModule",{value:true});var p=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var o=function k(t,x,w,v){var y=Object.getOwnPropertyDescriptor(t,x);if(y===undefined){var u=Object.getPrototypeOf(t);if(u!==null){k(u,x,w,v)}}else{if("value" in y&&y.writable){y.value=w}else{var z=y.set;if(z!==undefined){z.call(v,w)}}}return w};var c=function q(A,z,y){var w=true;_function:while(w){var u=A,C=z,t=y;v=B=x=undefined;w=false;var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;y=t;w=true;continue _function}}else{if("value" in v){return v.value}else{var x=v.get;if(x===undefined){return undefined}return x.call(t)}}}};function d(t){return t&&t.__esModule?t:{"default":t}}function i(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function n(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){u.__proto__=t}}var j=h(9);var e=d(j);var l=h(50);var g=d(l);var r=h(74);var b=d(r);var m=(function(y){function x(){for(var A=arguments.length,B=Array(A),C=0;C<A;C++){B[C]=arguments[C]}i(this,x);c(Object.getPrototypeOf(x.prototype),"constructor",this).apply(this,B);this._fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      uniform float blurRadius;\n      uniform float gradientRadius;\n      uniform vec2 start;\n      uniform vec2 end;\n      uniform vec2 delta;\n      uniform vec2 texSize;\n      varying vec2 v_texCoord;\n\n      float random(vec3 scale, float seed) {\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n      }\n\n      void main() {\n          vec4 color = vec4(0.0);\n          float total = 0.0;\n\n          float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n          vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n          float radius = smoothstep(0.0, 1.0, abs(dot(v_texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;\n          for (float t = -30.0; t <= 30.0; t++) {\n              float percent = (t + offset - 0.5) / 30.0;\n              float weight = 1.0 - abs(percent);\n              vec4 sample = texture2D(u_image, v_texCoord + delta * percent * radius / texSize);\n\n              sample.rgb *= sample.a;\n\n              color += sample * weight;\n              total += weight;\n          }\n\n          gl_FragColor = color / total;\n          gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n      }\n    ";this._cachedBlurredCanvas=null;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}n(x,y);p(x,[{key:"_renderWebGL",value:function v(E){var D=E.getCanvas();var B=new g["default"](D.width,D.height);var H=this._options.start.clone();var C=this._options.end.clone();if(this._options.numberFormat==="relative"){H.multiply(B);C.multiply(B)}H.y=B.y-H.y;C.y=B.y-C.y;var G=C.clone().subtract(H);var F=Math.sqrt(G.x*G.x+G.y*G.y);var A={blurRadius:{type:"f",value:this._options.blurRadius},gradientRadius:{type:"f",value:this._options.gradientRadius},start:{type:"2f",value:[H.x,H.y]},end:{type:"2f",value:[C.x,C.y]},delta:{type:"2f",value:[G.x/F,G.y/F]},texSize:{type:"2f",value:[D.width,D.height]}};if(!this._glslPrograms[E.id]){this._glslPrograms[E.id]=E.setupGLSLProgram(null,this._fragmentShader)}E.runProgram(this._glslPrograms[E.id],{uniforms:A});A.delta.value=[-G.y/F,G.x/F];E.runProgram(this._glslPrograms[E.id],{uniforms:A})}},{key:"_renderCanvas",value:function w(E){var C=E.getCanvas();var A=this._options.blurRadius!==this._lastBlurRadius||this._options.gradientRadius!==this._lastGradientRadius;var B=undefined;if(A||this._cachedBlurredCanvas===null){B=this._blurCanvas(E);this._cachedBlurredCanvas=B;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}else{B=this._cachedBlurredCanvas}var D=this._createMask(E);this._applyMask(C,B,D)}},{key:"_blurCanvas",value:function z(D){var C=D.cloneCanvas();var B=C.getContext("2d");var A=B.getImageData(0,0,C.width,C.height);b["default"].stackBlurCanvasRGBA(A,0,0,C.width,C.height,this._options.blurRadius);B.putImageData(A,0,0);return C}},{key:"_createMask",value:function t(H){var B=H.getCanvas();var N=new g["default"](B.width,B.height);var C=this._options.gradientRadius;var E=H.createCanvas(B.width,B.height);var K=E.getContext("2d");var A=this._options.start.clone();var F=this._options.end.clone();if(this._options.numberFormat==="relative"){A.multiply(N);F.multiply(N)}var J=F.clone().subtract(A);var O=A.clone().add(J.clone().divide(2));var G=Math.sqrt(Math.pow(J.x,2)+Math.pow(J.y,2));var I=J.clone().divide(G);var M=O.clone().add(C*I.y,-C*I.x);var D=O.clone().add(-C*I.y,C*I.x);var L=K.createLinearGradient(M.x,M.y,D.x,D.y);L.addColorStop(0,"#000000");L.addColorStop(0.5,"#FFFFFF");L.addColorStop(1,"#000000");K.fillStyle=L;K.fillRect(0,0,B.width,B.height);return E}},{key:"_applyMask",value:function u(C,E,D){var H=C.getContext("2d");var I=E.getContext("2d");var J=D.getContext("2d");var K=H.getImageData(0,0,C.width,C.height);var A=K.data;var G=I.getImageData(0,0,C.width,C.height).data;var L=J.getImageData(0,0,C.width,C.height).data;for(var F=0;F<L.length;F++){var B=L[F]/255;A[F]=B*A[F]+(1-B)*G[F]}H.putImageData(K,0,0)}},{key:"dirty",set:function(A){o(Object.getPrototypeOf(x.prototype),"dirty",A,this);this._cachedBlurredCanvas=null},get:function(){return c(Object.getPrototypeOf(x.prototype),"dirty",this)}}]);return x})(e["default"]);m.prototype.identifier="tilt-shift";m.prototype.availableOptions={start:{type:"vector2","default":new g["default"](0,0.5)},end:{type:"vector2","default":new g["default"](1,0.5)},blurRadius:{type:"number","default":30},gradientRadius:{type:"number","default":50}};s["default"]=m;f.exports=s["default"]},function(f,s,h){Object.defineProperty(s,"__esModule",{value:true});var p=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var n=function k(t,x,w,v){var y=Object.getOwnPropertyDescriptor(t,x);if(y===undefined){var u=Object.getPrototypeOf(t);if(u!==null){k(u,x,w,v)}}else{if("value" in y&&y.writable){y.value=w}else{var z=y.set;if(z!==undefined){z.call(v,w)}}}return w};var c=function q(A,z,y){var w=true;_function:while(w){var u=A,C=z,t=y;v=B=x=undefined;w=false;var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;y=t;w=true;continue _function}}else{if("value" in v){return v.value}else{var x=v.get;if(x===undefined){return undefined}return x.call(t)}}}};function d(t){return t&&t.__esModule?t:{"default":t}}function i(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function m(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){u.__proto__=t}}var j=h(9);var e=d(j);var l=h(50);var g=d(l);var r=h(74);var b=d(r);var o=(function(x){function z(){for(var A=arguments.length,B=Array(A),C=0;C<A;C++){B[C]=arguments[C]}i(this,z);c(Object.getPrototypeOf(z.prototype),"constructor",this).apply(this,B);this._fragmentShader="\n      precision mediump float;\n      uniform sampler2D u_image;\n      uniform float blurRadius;\n      uniform float gradientRadius;\n      uniform vec2 position;\n      uniform vec2 delta;\n      uniform vec2 texSize;\n      varying vec2 v_texCoord;\n\n      float random(vec3 scale, float seed) {\n        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n      }\n\n      void main() {\n          vec4 color = vec4(0.0);\n          float total = 0.0;\n\n          float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n          float radius = smoothstep(0.0, 1.0, abs(distance(v_texCoord * texSize, position)) / (gradientRadius * 2.0)) * blurRadius;\n          for (float t = -30.0; t <= 30.0; t++) {\n              float percent = (t + offset - 0.5) / 30.0;\n              float weight = 1.0 - abs(percent);\n              vec4 sample = texture2D(u_image, v_texCoord + delta * percent * radius / texSize);\n\n              sample.rgb *= sample.a;\n\n              color += sample * weight;\n              total += weight;\n          }\n\n          gl_FragColor = color / total;\n          gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n      }\n    ";this._cachedBlurredCanvas=null;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}m(z,x);p(z,[{key:"_renderWebGL",value:function v(E){var D=E.getCanvas();var C=new g["default"](D.width,D.height);var B=this._options.position.clone();B.y=1-B.y;if(this._options.numberFormat==="relative"){B.multiply(C)}var A={blurRadius:{type:"f",value:this._options.blurRadius},gradientRadius:{type:"f",value:this._options.gradientRadius},position:{type:"2f",value:[B.x,B.y]},texSize:{type:"2f",value:[D.width,D.height]},delta:{type:"2f",value:[1,1]}};if(!this._glslPrograms[E.id]){this._glslPrograms[E.id]=E.setupGLSLProgram(null,this._fragmentShader)}E.runProgram(this._glslPrograms[E.id],{uniforms:A});A.delta.value=[-1,1];E.runProgram(this._glslPrograms[E.id],{uniforms:A})}},{key:"_renderCanvas",value:function w(D){var B=D.getCanvas();var E=this._options.blurRadius!==this._lastBlurRadius;var A=undefined;if(E||this._cachedBlurredCanvas===null){A=this._blurCanvas(D);this._cachedBlurredCanvas=A;this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius}else{A=this._cachedBlurredCanvas}var C=this._createMask(D);this._applyMask(B,A,C)}},{key:"_blurCanvas",value:function y(D){var C=D.cloneCanvas();var B=C.getContext("2d");var A=B.getImageData(0,0,C.width,C.height);b["default"].stackBlurCanvasRGBA(A,0,0,C.width,C.height,this._options.blurRadius);B.putImageData(A,0,0);return C}},{key:"_createMask",value:function t(G){var C=G.getCanvas();var B=new g["default"](C.width,C.height);var D=this._options.gradientRadius;var F=G.createCanvas(C.width,C.height);var E=F.getContext("2d");var A=this._options.position.clone();if(this._options.numberFormat==="relative"){A.multiply(B)}var H=E.createRadialGradient(A.x,A.y,0,A.x,A.y,D);H.addColorStop(0,"#FFFFFF");H.addColorStop(1,"#000000");E.fillStyle=H;E.fillRect(0,0,C.width,C.height);return F}},{key:"_applyMask",value:function u(C,E,D){var H=C.getContext("2d");var I=E.getContext("2d");var J=D.getContext("2d");var K=H.getImageData(0,0,C.width,C.height);var A=K.data;var F=I.getImageData(0,0,C.width,C.height).data;var M=J.getImageData(0,0,C.width,C.height).data;var G,B;for(var L=0;L<C.height;L++){for(var N=0;N<C.width;N++){G=(L*C.width+N)*4;B=M[G]/255;A[G]=B*A[G]+(1-B)*F[G];A[G+1]=B*A[G+1]+(1-B)*F[G+1];A[G+2]=B*A[G+2]+(1-B)*F[G+2]}}H.putImageData(K,0,0)}},{key:"dirty",set:function(A){n(Object.getPrototypeOf(z.prototype),"dirty",A,this);this._cachedBlurredCanvas=null},get:function(){return c(Object.getPrototypeOf(z.prototype),"dirty",this)}}]);return z})(e["default"]);o.prototype.identifier="radial-blur";o.prototype.availableOptions={position:{type:"vector2","default":new g["default"](0.5,0.5)},gradientRadius:{type:"number","default":50},blurRadius:{type:"number","default":20}};s["default"]=o;f.exports=s["default"]},function(d,h,c){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var j=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function i(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function p(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var m=c(9);var o=q(m);var g=c(50);var l=q(g);var n=c(7);var b=q(n);var k=(function(v){function u(){for(var z=arguments.length,A=Array(z),B=0;B<z;B++){A[B]=arguments[B]}i(this,u);j(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,A);this._textureIndex=1;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textImage;\n      uniform vec2 u_position;\n      uniform vec2 u_size;\n\n      void main() {\n        vec4 color0 = texture2D(u_image, v_texCoord);\n        vec2 relative = (v_texCoord - u_position) / u_size;\n\n        if (relative.x >= 0.0 && relative.x <= 1.0 &&\n          relative.y >= 0.0 && relative.y <= 1.0) {\n\n            vec4 color1 = texture2D(u_textImage, relative);\n\n            // GL_SOURCE_ALPHA, GL_ONE_MINUS_SOURCE_ALPHA\n            gl_FragColor = color1 + color0 * (1.0 - color1.a);\n\n        } else {\n\n          gl_FragColor = color0;\n\n        }\n      }\n    "}p(u,v);f(u,[{key:"_renderWebGL",value:function s(E){var B=this._renderTextCanvas(E);var C=E.getCanvas();var F=E.getContext();var A=this._options.position.clone();var z=new l["default"](C.width,C.height);var D=new l["default"](B.width,B.height).divide(z);if(this._options.numberFormat==="absolute"){A.divide(z)}A.y=1-A.y;A.y-=D.y;if(this._options.verticalAlignment==="center"){A.y+=D.y/2}else{if(this._options.verticalAlignment==="bottom"){A.y+=D.y}}if(this._options.alignment==="center"){A.x-=D.x/2}else{if(this._options.alignment==="right"){A.x-=D.x}}F.activeTexture(F.TEXTURE0+this._textureIndex);this._texture=F.createTexture();F.bindTexture(F.TEXTURE_2D,this._texture);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,F.LINEAR);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,F.LINEAR);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_S,F.CLAMP_TO_EDGE);F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_T,F.CLAMP_TO_EDGE);F.pixelStorei(F.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);F.texImage2D(F.TEXTURE_2D,0,F.RGBA,F.RGBA,F.UNSIGNED_BYTE,B);F.activeTexture(F.TEXTURE0);E.runShader(null,this._fragmentShader,{uniforms:{u_textImage:{type:"i",value:this._textureIndex},u_position:{type:"2f",value:[A.x,A.y]},u_size:{type:"2f",value:[D.x,D.y]}}})}},{key:"_renderCanvas",value:function t(D){var A=this._renderTextCanvas(D);var B=D.getCanvas();var C=D.getContext();var z=new l["default"](B.width,B.height);var E=this._options.position.clone();if(this._options.numberFormat==="relative"){E.multiply(z)}if(this._options.verticalAlignment==="center"){E.y-=A.height/2}else{if(this._options.verticalAlignment==="bottom"){E.y-=A.height}}if(this._options.alignment==="center"){E.x-=A.width/2}else{if(this._options.alignment==="right"){E.x-=A.width}}C.drawImage(A,E.x,E.y)}},{key:"_renderTextCanvas",value:function r(E){var K=undefined,D=undefined;var B=E.createCanvas();var z=B.getContext("2d");var H=E.getCanvas();var I=new l["default"](H.width,H.height);var G=this._options.maxWidth;var A=this._options.fontSize*I.y;var F=this._options.lineHeight*A;if(this._options.numberFormat==="relative"){G*=E.getCanvas().width}this._applyTextOptions(E,z);var C=new l["default"]();var J=this._options.text.split("\n");if(typeof G!=="undefined"){C.x=G;J=this._buildOutputLines(z,G)}else{for(D=0;D<J.length;D++){K=J[D];C.x=Math.max(C.x,z.measureText(K).width)}}C.y=F*J.length;B.width=C.x;B.height=C.y;z=B.getContext("2d");z.fillStyle=this._options.backgroundColor.toRGBA();z.fillRect(0,0,B.width,B.height);this._applyTextOptions(E,z);for(D=0;D<J.length;D++){K=J[D];this._drawText(z,K,F*D)}return B}},{key:"_applyTextOptions",value:function x(D,B){var A=D.getCanvas();var z=new l["default"](A.width,A.height);var C=this._options.fontSize*z.y;B.font=this._options.fontWeight+" "+C+"px "+this._options.fontFamily;B.textBaseline="top";B.textAlign=this._options.alignment;B.fillStyle=this._options.color.toRGBA()}},{key:"_buildOutputLines",value:function w(A,H){var B=this._options.text.split("\n");var J=[];var F=[];for(var D=0;D<B.length;D++){var E=B[D];var z=E.split("");if(z.length===0){J.push("")}for(var L=0;L<z.length;L++){var K=z[L];F.push(K);var G=F.join("");var C=A.measureText(G).width;if(C>H&&F.length===1){J.push(F[0]);F=[]}else{if(C>H){var I=F.pop();J.push(F.join(""));F=[];F=[I]}else{if(L===z.length-1){J.push(F.join(""));F=[]}}}}if(F.length){J.push(F.join(""));F=[]}}return J}},{key:"_drawText",value:function y(A,B,C){var z=A.canvas;if(this._options.alignment==="center"){A.fillText(B,z.width/2,C)}else{if(this._options.alignment==="left"){A.fillText(B,0,C)}else{if(this._options.alignment==="right"){A.fillText(B,z.width,C)}}}}}]);return u})(o["default"]);k.prototype.identifier="text";k.prototype.availableOptions={fontSize:{type:"number","default":0.1},lineHeight:{type:"number","default":1.1},fontFamily:{type:"string","default":"Times New Roman"},fontWeight:{type:"string","default":"normal"},alignment:{type:"string","default":"left",available:["left","center","right"]},verticalAlignment:{type:"string","default":"top",available:["top","center","bottom"]},color:{type:"color","default":new b["default"](1,1,1,1)},backgroundColor:{type:"color","default":new b["default"](0,0,0,0)},position:{type:"vector2","default":new l["default"](0,0)},text:{type:"string",required:true},maxWidth:{type:"number","default":1}};h["default"]=k;d.exports=h["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var j=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function i(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function p(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var l=b(9);var o=q(l);var g=b(50);var k=q(g);var n=b(58);var d=q(n);var m=(function(w){function v(){for(var z=arguments.length,A=Array(z),B=0;B<z;B++){A[B]=arguments[B]}i(this,v);j(Object.getPrototypeOf(v.prototype),"constructor",this).apply(this,A);this._textureIndex=1;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_stickerImage;\n      uniform vec2 u_position;\n      uniform vec2 u_size;\n\n      void main() {\n        vec4 color0 = texture2D(u_image, v_texCoord);\n        vec2 relative = (v_texCoord - u_position) / u_size;\n\n        if (relative.x >= 0.0 && relative.x <= 1.0 &&\n          relative.y >= 0.0 && relative.y <= 1.0) {\n\n            vec4 color1 = texture2D(u_stickerImage, relative);\n\n            // GL_SOURCE_ALPHA, GL_ONE_MINUS_SOURCE_ALPHA\n            gl_FragColor = color1 + color0 * (1.0 - color1.a);\n\n        } else {\n\n          gl_FragColor = color0;\n\n        }\n      }\n    ";this._loadedStickers={}}p(v,w);f(v,[{key:"render",value:function x(A){var z=this;return this._loadSticker().then(function(B){if(A.identifier==="webgl"){return z._renderWebGL(A,B)}else{return z._renderCanvas(A,B)}})}},{key:"_renderWebGL",value:function s(E,F){var B=E.getCanvas();var G=E.getContext();var A=this._options.position.clone();var z=new k["default"](B.width,B.height);if(this._options.numberFormat==="absolute"){A.divide(z)}var C=new k["default"](F.width,F.height);if(typeof this._options.size!=="undefined"){C.copy(this._options.size);if(this._options.numberFormat==="relative"){C.multiply(z)}var D=F.height/F.width;C.y=C.x*D}C.divide(z);A.y=1-A.y;A.y-=C.y;G.activeTexture(G.TEXTURE0+this._textureIndex);this._texture=G.createTexture();G.bindTexture(G.TEXTURE_2D,this._texture);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.LINEAR);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.LINEAR);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE);G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE);G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);G.texImage2D(G.TEXTURE_2D,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,F);G.activeTexture(G.TEXTURE0);E.runShader(null,this._fragmentShader,{uniforms:{u_stickerImage:{type:"i",value:this._textureIndex},u_position:{type:"2f",value:[A.x,A.y]},u_size:{type:"2f",value:[C.x,C.y]}}})}},{key:"_renderCanvas",value:function u(D,E){var A=D.getCanvas();var C=D.getContext();var z=new k["default"](A.width,A.height);var F=this._options.position.clone();if(this._options.numberFormat==="relative"){F.multiply(z)}var B=new k["default"](E.width,E.height);if(typeof this._options.size!=="undefined"){B.copy(this._options.size);if(this._options.numberFormat==="relative"){B.multiply(z)}}C.drawImage(E,0,0,E.width,E.height,F.x,F.y,B.x,B.y)}},{key:"_loadSticker",value:function t(){var z=typeof window!=="undefined";if(z){return this._loadImageBrowser(this._options.sticker)}else{return this._loadImageNode(this._options.sticker)}}},{key:"_loadImageBrowser",value:function y(A){var z=this;return new d["default"](function(C,B){if(z._loadedStickers[A]){return C(z._loadedStickers[A])}var D=new Image();D.addEventListener("load",function(){z._loadedStickers[A]=D;C(D)});D.addEventListener("error",function(){B(new Error("Could not load sticker: "+A))});D.src=z._kit.getAssetPath(A)})}},{key:"_loadImageNode",value:function r(E){var A=b(53);var z=b(52);var B=this;var D=new A.Image();var C=B._kit.getAssetPath(E);return new d["default"](function(G,F){z.readFile(C,function(I,H){if(I){return F(I)}D.src=H;G(D)})})}},{key:"stickers",get:function(){return this._stickers}}]);return v})(o["default"]);m.prototype.identifier="stickers";m.prototype.availableOptions={sticker:{type:"string"},position:{type:"vector2","default":new k["default"](0,0)},size:{type:"vector2","default":new k["default"](0,0)}};h["default"]=m;c.exports=h["default"]},function(e,h,d){Object.defineProperty(h,"__esModule",{value:true});var g=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var j=function f(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var k=d(9);var m=o(k);var l=d(7);var c=o(l);var b=(function(r){function s(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}i(this,s);j(Object.getPrototypeOf(s.prototype),"constructor",this).apply(this,u);this._textureIndex=1;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_frameImage;\n      uniform vec4 u_color;\n      uniform vec2 u_thickness;\n\n      void main() {\n        vec4 fragColor = texture2D(u_image, v_texCoord);\n        if (v_texCoord.x < u_thickness.x || v_texCoord.x > 1.0 - u_thickness.x ||\n          v_texCoord.y < u_thickness.y || v_texCoord.y > 1.0 - u_thickness.y) {\n            fragColor = mix(fragColor, u_color, u_color.a);\n          }\n\n        gl_FragColor = fragColor;\n      }\n    "}n(s,r);g(s,[{key:"_renderWebGL",value:function p(y){var w=y.getCanvas();var u=this._options.color;var x=this._options.thickness*w.height;var v=[x/w.width,x/w.height];var t={u_color:{type:"4f",value:u.toGLColor()},u_thickness:{type:"2f",value:v}};if(!this._glslPrograms[y.id]){this._glslPrograms[y.id]=y.setupGLSLProgram(null,this._fragmentShader)}y.runProgram(this._glslPrograms[y.id],{uniforms:t})}},{key:"_renderCanvas",value:function q(x){var u=x.getCanvas();var w=x.getContext();var t=this._options.color;var v=this._options.thickness*u.height;w.save();w.beginPath();w.lineWidth=v*2;w.strokeStyle=t.toRGBA();w.rect(0,0,u.width,u.height);w.stroke();w.restore()}}]);return s})(m["default"]);b.prototype.identifier="frames";b.prototype.availableOptions={color:{type:"color","default":new c["default"](0,0,0,1)},thickness:{type:"number","default":0.02}};h["default"]=b;e.exports=h["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var d=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Contrast({contrast:0.63}));o.add(new j["default"].Primitives.Brightness({brightness:0.12}));o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}}));o.render(p)}},{key:"name",get:function(){return"15"}}],[{key:"identifier",get:function(){return"a15"}}]);return l})(j["default"]);f["default"]=d;c.exports=f["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(8);var j=k(h);var b=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);e(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Desaturation({desaturation:0.5}));o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}}));o.render(p)}},{key:"name",get:function(){return"Breeze"}}],[{key:"identifier",get:function(){return"breeze"}}]);return m})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var g=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);d(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Grayscale());o.render(p)}},{key:"name",get:function(){return"B&W"}}],[{key:"identifier",get:function(){return"bw"}}]);return l})(j["default"]);e["default"]=g;c.exports=e["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(8);var j=k(h);var b=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Grayscale());o.add(new j["default"].Primitives.Contrast({contrast:1.5}));o.render(p)}},{key:"name",get:function(){return"1920"}}],[{key:"identifier",get:function(){return"bwhard"}}]);return l})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var d=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}}));o.render(p)}},{key:"name",get:function(){return"Celsius"}}],[{key:"identifier",get:function(){return"celsius"}}]);return l})(j["default"]);f["default"]=d;c.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var e=(function(m){function n(){g(this,n);if(m!=null){m.apply(this,arguments)}}i(n,m);d(n,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}}));o.render(p)}},{key:"name",get:function(){return"Chest"}}],[{key:"identifier",get:function(){return"chest"}}]);return n})(j["default"]);f["default"]=e;c.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var g=b(8);var j=k(g);var h=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);d(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}}));o.render(p)}},{key:"name",get:function(){return"Fixie"}}],[{key:"identifier",get:function(){return"fixie"}}]);return l})(j["default"]);e["default"]=h;c.exports=e["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var e=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);d(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Saturation({saturation:1.35}));o.add(new j["default"].Primitives.Contrast({contrast:1.1}));o.render(p)}},{key:"name",get:function(){return"Food"}}],[{key:"identifier",get:function(){return"food"}}]);return m})(j["default"]);f["default"]=e;c.exports=f["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(8);var j=k(h);var b=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}}));o.render(p)}},{key:"name",get:function(){return"Fridge"}}],[{key:"identifier",get:function(){return"fridge"}}]);return l})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function h(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var g=b(8);var j=k(g);var i=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}h(l,n);d(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}}));o.render(p)}},{key:"name",get:function(){return"Front"}}],[{key:"identifier",get:function(){return"front"}}]);return l})(j["default"]);e["default"]=i;c.exports=e["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function h(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var g=b(8);var j=k(g);var i=(function(n){function m(){f(this,m);if(n!=null){n.apply(this,arguments)}}h(m,n);d(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Contrast({contrast:1.1}));o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}));o.render(p)}},{key:"name",get:function(){return"Glam"}}],[{key:"identifier",get:function(){return"glam"}}]);return m})(j["default"]);e["default"]=i;c.exports=e["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(8);var j=k(h);var b=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Gobblin());o.render(p)}},{key:"name",get:function(){return"Gobblin"}}],[{key:"identifier",get:function(){return"gobblin"}}]);return l})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var g=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);d(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]}));o.add(new j["default"].Primitives.Saturation({saturation:0.9}));o.render(p)}},{key:"name",get:function(){return"K1"}}],[{key:"identifier",get:function(){return"k1"}}]);return l})(j["default"]);e["default"]=g;c.exports=e["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function m(n){return n&&n.__esModule?n:{"default":n}}function g(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function j(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var h=c(8);var l=m(h);var i=c(7);var b=m(i);var k=(function(p){function o(){g(this,o);if(p!=null){p.apply(this,arguments)}}j(o,p);e(o,[{key:"render",value:function n(r){var q=new l["default"].PrimitivesStack();q.add(new l["default"].Primitives.ToneCurve({controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]}));q.add(new l["default"].Primitives.SoftColorOverlay({color:new b["default"](40/255,40/255,40/255)}));q.render(r)}},{key:"name",get:function(){return"K2"}}],[{key:"identifier",get:function(){return"k2"}}]);return o})(l["default"]);f["default"]=k;d.exports=f["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(8);var j=k(h);var b=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);e(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Saturation({saturation:0.5}));o.render(p)}},{key:"name",get:function(){return"K6"}}],[{key:"identifier",get:function(){return"k6"}}]);return m})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var g=(function(n){function m(){f(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);d(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]}));o.add(new j["default"].Primitives.Saturation({saturation:0.7}));o.render(p)}},{key:"name",get:function(){return"KDynamic"}}],[{key:"identifier",get:function(){return"kdynamic"}}]);return m})(j["default"]);e["default"]=g;c.exports=e["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var e=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);d(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Desaturation({desaturation:0.4}));o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}}));o.render(p)}},{key:"name",get:function(){return"Lenin"}}],[{key:"identifier",get:function(){return"lenin"}}]);return m})(j["default"]);f["default"]=e;c.exports=f["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(8);var j=k(h);var b=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);e(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]}));o.render(p)}},{key:"name",get:function(){return"Lomo"}}],[{key:"identifier",get:function(){return"lomo"}}]);return m})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var g=b(8);var j=k(g);var h=(function(n){function m(){f(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);d(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}}));o.render(p)}},{key:"name",get:function(){return"Mellow"}}],[{key:"identifier",get:function(){return"mellow"}}]);return m})(j["default"]);e["default"]=h;c.exports=e["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var g=(function(m){function n(){f(this,n);if(m!=null){m.apply(this,arguments)}}i(n,m);d(n,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}}));o.add(new j["default"].Primitives.Glow());o.render(p)}},{key:"name",get:function(){return"Morning"}}],[{key:"identifier",get:function(){return"morning"}}]);return n})(j["default"]);e["default"]=g;c.exports=e["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var g=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);d(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]}}));o.add(new j["default"].Primitives.ToneCurve({controlPoints:[[0,0],[117,151],[189,217],[255,255]]}));o.add(new j["default"].Primitives.Desaturation({desaturation:0.65}));o.render(p)}},{key:"name",get:function(){return"Orchid"}}],[{key:"identifier",get:function(){return"orchid"}}]);return l})(j["default"]);e["default"]=g;c.exports=e["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var d=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);e(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}));o.add(new j["default"].Primitives.Saturation({saturation:0.8}));o.add(new j["default"].Primitives.Contrast({contrast:1.5}));o.render(p)}},{key:"name",get:function(){return"Pola SX"}}],[{key:"identifier",get:function(){return"pola"}}]);return m})(j["default"]);f["default"]=d;c.exports=f["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(8);var j=k(h);var b=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}}));o.add(new j["default"].Primitives.Saturation({saturation:0.8}));o.add(new j["default"].Primitives.Contrast({contrast:1.5}));o.render(p)}},{key:"name",get:function(){return"Pola 669"}}],[{key:"identifier",get:function(){return"pola669"}}]);return l})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var d=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.Desaturation({desaturation:0.65}));o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}}));o.render(p)}},{key:"name",get:function(){return"Quozi"}}],[{key:"identifier",get:function(){return"quozi"}}]);return l})(j["default"]);f["default"]=d;c.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var g=(function(m){function n(){f(this,n);if(m!=null){m.apply(this,arguments)}}i(n,m);d(n,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}}));o.add(new j["default"].Primitives.Glow());o.render(p)}},{key:"name",get:function(){return"Semi Red"}}],[{key:"identifier",get:function(){return"semired"}}]);return n})(j["default"]);e["default"]=g;c.exports=e["default"]},function(d,f,c){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=c(8);var j=k(h);var b=(function(n){function m(){g(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);e(m,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]}}));o.add(new j["default"].Primitives.ToneCurve({controlPoints:[[0,0],[55,20],[158,191],[255,255]]}));o.render(p)}},{key:"name",get:function(){return"Sunny"}}],[{key:"identifier",get:function(){return"sunny"}}]);return m})(j["default"]);f["default"]=b;d.exports=f["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var g=(function(m){function n(){f(this,n);if(m!=null){m.apply(this,arguments)}}i(n,m);d(n,[{key:"render",value:function l(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.ToneCurve({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}}));o.render(p)}},{key:"name",get:function(){return"Texas"}}],[{key:"identifier",get:function(){return"texas"}}]);return n})(j["default"]);e["default"]=g;c.exports=e["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(8);var j=k(h);var d=(function(n){function l(){g(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);e(l,[{key:"render",value:function m(p){var o=new j["default"].PrimitivesStack();o.add(new j["default"].Primitives.X400());o.render(p)}},{key:"name",get:function(){return"X400"}}],[{key:"identifier",get:function(){return"x400"}}]);return l})(j["default"]);f["default"]=d;c.exports=f["default"]},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function s(t,u){f(this,s);this.x=t;this.y=u;if(typeof this.x==="undefined"){this.x=0}if(typeof this.y==="undefined"){this.y=0}}d(s,[{key:"set",value:function q(t,u){this.x=t;this.y=u;return this}},{key:"clone",value:function o(){return new s(this.x,this.y)}},{key:"copy",value:function h(t){this.x=t.x;this.y=t.y;return this}},{key:"clamp",value:function n(u,w){var t=u!==null&&typeof u!=="undefined";var v=w!==null&&typeof w!=="undefined";if(!(u instanceof s)&&t){u=new s(u,u)}if(!(w instanceof s)&&v){w=new s(w,w)}if(t){this.x=Math.max(u.x,this.x);this.y=Math.max(u.y,this.y)}if(v){this.x=Math.min(w.x,this.x);this.y=Math.min(w.y,this.y)}return this}},{key:"divide",value:function l(u,t){if(u instanceof s){this.x/=u.x;this.y/=u.y}else{this.x/=u;this.y/=typeof t==="undefined"?u:t}return this}},{key:"subtract",value:function p(t,u){if(t instanceof s){this.x-=t.x;this.y-=t.y}else{this.x-=t;this.y-=typeof u==="undefined"?t:u}return this}},{key:"multiply",value:function i(t,u){if(t instanceof s){this.x*=t.x;this.y*=t.y}else{this.x*=t;this.y*=typeof u==="undefined"?t:u}return this}},{key:"add",value:function r(t,u){if(t instanceof s){this.x+=t.x;this.y+=t.y}else{this.x+=t;this.y+=typeof u==="undefined"?t:u}return this}},{key:"equals",value:function k(t,u){if(t instanceof s){return t.x===this.x&&t.y===this.y}else{return t===this.x&&u===this.y}}},{key:"flip",value:function m(){var t=this.x;this.x=this.y;this.y=t;return this}},{key:"toString",value:function j(){return"Vector2({ x: "+this.x+", y: "+this.y+" })"}}]);return s})();c["default"]=b;e.exports=c["default"]},function(e,x,f){Object.defineProperty(x,"__esModule",{value:true});var s=(function(){function y(C,A){for(var z=0;z<A.length;z++){var B=A[z];B.enumerable=B.enumerable||false;B.configurable=true;if("value" in B){B.writable=true}Object.defineProperty(C,B.key,B)}}return function(B,z,A){if(z){y(B.prototype,z)}if(A){y(B,A)}return B}})();var b=function w(F,E,B){var C=true;_function:while(C){var z=F,H=E,y=B;A=G=D=undefined;C=false;var A=Object.getOwnPropertyDescriptor(z,H);if(A===undefined){var G=Object.getPrototypeOf(z);if(G===null){return undefined}else{F=G;E=H;B=y;C=true;continue _function}}else{if("value" in A){return A.value}else{var D=A.get;if(D===undefined){return undefined}return D.call(y)}}}};function d(y){return y&&y.__esModule?y:{"default":y}}function h(y,z){if(!(y instanceof z)){throw new TypeError("Cannot call a class as a function")}}function p(z,y){if(typeof y!=="function"&&y!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof y)}z.prototype=Object.create(y&&y.prototype,{constructor:{value:z,enumerable:false,writable:true,configurable:true}});if(y){z.__proto__=y}}var o=f(1);var q=d(o);var v=f(76);var r=d(v);var n=f(77);var g=d(n);var i=f(78);var l=d(i);var k=f(79);var c=d(k);var u=f(80);var m=d(u);var t=f(5);var j=(function(Y){function I(){for(var ac=arguments.length,ad=Array(ac),ae=0;ae<ac;ae++){ad[ae]=arguments[ae]}h(this,I);b(Object.getPrototypeOf(I.prototype),"constructor",this).apply(this,ad);this._operationsMap={};this._template=function(ah){var ag='<div class="imglykit-container"> <div class="imglykit-loadingOverlay"> <div class="imglykit-loadingOverlay-content"> <img src="'+(ah.helpers.assetPath("ui/night/loading.gif"))+'" /> <span>Loading...</span> </div> </div> ';if(!ah.options.ui.hideHeader){ag+=' <div class="imglykit-header"> img.ly Photo Editor SDK ';if(ah.options.ui.showCloseButton){ag+=' <div class="imglykit-close-button"> <img src="'+(ah.helpers.assetPath("ui/night/close.png"))+'" /> </div> '}ag+=" </div> "}ag+=' <div class="imglykit-top-controls';if(!ah.options.ui.hideHeader){ag+=" imglykit-header-padding"}ag+='"> <div class="imglykit-top-controls-left"> ';if(ah.options.ui.showNewButton){ag+=' <div class="imglykit-new"> <img src="'+(ah.helpers.assetPath("ui/night/top/new.png"))+'" /> New </div> '}ag+=' <div class="imglykit-undo"> <img src="'+(ah.helpers.assetPath("ui/night/top/undo.png"))+'" /> Undo </div> ';if(ah.options.ui.showExportButton){ag+=' <div class="imglykit-export"> <img src="'+(ah.helpers.assetPath("ui/night/top/export.png"))+'" /> Export </div> '}ag+=' </div> <div class="imglykit-top-controls-right"> <div class="imglykit-zoom-fit"></div> <div class="imglykit-zoom-level">Zoom: <span class="imglykit-zoom-level-num">100</span>%</div> <div class="imglykit-zoom-in"> <img src="'+(ah.helpers.assetPath("ui/night/top/zoom-in.png"))+'" /> </div> <div class="imglykit-zoom-out"> <img src="'+(ah.helpers.assetPath("ui/night/top/zoom-out.png"))+'" /> </div> </div> </div> <div class="imglykit-canvas-container';if(!ah.options.ui.hideHeader){ag+=" imglykit-header-padding"}ag+='"> <div class="imglykit-canvas-inner-container"> <canvas class="imglykit-canvas-draggable"></canvas> <div class="imglykit-canvas-controls imglykit-canvas-controls-disabled"></div> </div> ';if(ah.renderDropArea){ag+=' <div class="imglykit-drop-area-container';if(!ah.options.ui.hideHeader){ag+=" imglykit-header-padding"}ag+='"> <div class="imglykit-drop-area"> <input type="file" class="imglykit-drop-area-hidden-input" /> <img src="'+(ah.helpers.assetPath("ui/night/upload.png"))+'" /> <div class="imglykit-drop-area-content"> <h1>Upload a picture</h1> <span>Click to upload a picture from your library or just drag and drop</span> </div> </div> </div> '}ag+=' </div> <div class="imglykit-controls-container"> <div class="imglykit-controls"> <div> <div class="imglykit-controls-overview"> <ul class="imglykit-controls-list"> ';for(var af in ah.controls){ag+=" ";var ai=ah.controls[af];ag+=' <li data-identifier="'+(ai.identifier)+'"';if(ah.controlsDisabled){ag+=" data-disabled"}ag+='> <img src="'+(ah.helpers.assetPath("ui/night/operations/"+ai.identifier+".png"))+'" /> </li> '}ag+=" </ul> </div> </div> </div> </div></div>";return ag};this._registeredControls={};this._history=[];this._preferredOperationOrder=["rotation","crop","flip","filters","contrast","brightness","saturation","radial-blur","tilt-shift","frames","stickers","text"];this._paused=false;this._options.ui=q["default"].defaults(this._options.ui,{showNewButton:!this._options.image,showHeader:true,showCloseButton:false,showExportButton:false,"export":{}});this._options.ui["export"]=q["default"].defaults(this._options.ui["export"],{type:t.ImageFormat.JPEG,quality:0.8})}p(I,Y);s(I,[{key:"run",value:function N(){this._registerControls();b(Object.getPrototypeOf(I.prototype),"run",this).call(this);var ac=this._options.container;this._controlsContainer=ac.querySelector(".imglykit-controls");this._canvasControlsContainer=ac.querySelector(".imglykit-canvas-controls");this._overviewControlsContainer=ac.querySelector(".imglykit-controls-overview");this._loadingOverlay=ac.querySelector(".imglykit-loadingOverlay");this._loadingSpan=ac.querySelector(".imglykit-loadingOverlay span");this._handleOverview();if(this._options.image){this._initCanvas()}if(this._options.ui.showNewButton){this._initFileLoader()}this._initTopControls();this._initControls();if(this._options.image){this.showZoom()}if(this._options.ui.showCloseButton){this._handleCloseButton()}this._topControls.updateExportButton()}},{key:"_initFileLoader",value:function K(){this._fileLoader=new l["default"](this._kit,this);this._fileLoader.on("file",this._onFileLoaded.bind(this))}},{key:"_onFileLoaded",value:function C(ad){var ae=this;var ac=new FileReader();ac.onload=(function(){return function(ah){var af=ah.target.result;var ag=new Image();ag.addEventListener("load",function(){ae._setImage(ag)});ag.src=af}})(ad);ac.readAsDataURL(ad)}},{key:"_setImage",value:function B(ac){this._options.image=ac;if(this._canvas){this._canvas.reset()}this._fileLoader.removeDOM();if(!this._canvas){this._initCanvas()}else{this._canvas.setImage(this._options.image)}this.showZoom();this._topControls.init();this._enableControls();this._topControls.updateExportButton()}},{key:"_initTopControls",value:function y(){var ac=this;this._topControls=new c["default"](this._kit,this);this._topControls.run();this._topControls.on("undo",function(){ac.undo()});this._topControls.on("export",function(){ac["export"]()});this._topControls.on("zoom-in",function(){ac._canvas.zoomIn().then(function(){if(ac._currentControl){ac._currentControl.onZoom()}})});this._topControls.on("zoom-out",function(){ac._canvas.zoomOut().then(function(){if(ac._currentControl){ac._currentControl.onZoom()}})})}},{key:"_initCanvas",value:function U(){var ac=this;this._canvas=new g["default"](this._kit,this,this._options);this._canvas.run();this._canvas.on("zoom",function(){ac._topControls.updateZoomLevel()})}},{key:"selectOperations",value:function P(ac){b(Object.getPrototypeOf(I.prototype),"selectOperations",this).call(this,ac)}},{key:"getOrCreateOperation",value:function H(ae){var ah=this._kit;var ag=ah.operationsStack;var ai=ah.registeredOperations;var ac=ai[ae];if(typeof this._operationsMap[ae]==="undefined"){var af=new ac(this._kit);this._operationsMap[ae]=af;var ad=this._preferredOperationOrder.indexOf(ae);if(ad===-1){ad=this._preferredOperationOrder.length}ag[ad]=af;return af}else{return this._operationsMap[ae]}}},{key:"removeOperation",value:function R(ae){if(!this._operationsMap[ae]){return}var ac=this._operationsMap[ae];delete this._operationsMap[ae];var ad=this._kit.operationsStack.indexOf(ac);this._kit.operationsStack.splice(ad,1)}},{key:"_registerControls",value:function S(){this.registerControl("filters","filters",f(81));this.registerControl("rotation","rotation",f(82));this.registerControl("flip","flip",f(83));this.registerControl("brightness","brightness",f(84));this.registerControl("contrast","contrast",f(85));this.registerControl("saturation","saturation",f(86));this.registerControl("crop","crop",f(87));this.registerControl("radial-blur","radial-blur",f(88));this.registerControl("tilt-shift","tilt-shift",f(89));this.registerControl("frames","frames",f(90));this.registerControl("stickers","stickers",f(91));this.registerControl("text","text",f(92))}},{key:"_handleOverview",value:function X(){var ad=this;var ag=this._overviewControlsContainer.querySelector("ul");if(!ag.parentNode===this._overviewControlsContainer){return}var ae=[].filter.call(ag.querySelectorAll("li"),function(ah){return ah.parentNode===ag});var af=function(ai){var aj=ae[ai];var ah=aj.dataset.identifier;aj.addEventListener("click",function(){ad.switchToControl(ah)})};for(var ac=0;ac<ae.length;ac++){af(ac)}}},{key:"_enableControls",value:function Q(){var af=this._overviewControlsContainer.querySelector("ul");if(!af.parentNode===this._overviewControlsContainer){return}var ae=[].filter.call(af.querySelectorAll("li"),function(ag){return ag.parentNode===af});for(var ac=0;ac<ae.length;ac++){var ad=ae[ac];ad.removeAttribute("data-disabled")}}},{key:"switchToControl",value:function J(ac){if(this.context.controlsDisabled){return}this._overviewControlsContainer.style.display="none";this._scrollbar.remove();if(this._currentControl){this._currentControl.leave()}this._currentControl=this._registeredControls[ac];this._currentControl.enter();this._currentControl.once("back",this._switchToOverview.bind(this))}},{key:"_switchToOverview",value:function E(){if(this._currentControl){this._currentControl.leave()}this._currentControl=null;this._overviewControlsContainer.style.display="";this._initScrollbar()}},{key:"registerControl",value:function O(ae,ad,af){if(!this.isOperationSelected(ad)){return}var ac=new af(this._kit,this);this._registeredControls[ae]=ac}},{key:"_initControls",value:function V(){for(var ac in this._registeredControls){var ad=this._registeredControls[ac];ad.setContainers(this._controlsContainer,this._canvasControlsContainer);ad.init()}this._initScrollbar()}},{key:"_initScrollbar",value:function L(){var ac=this._controlsContainer.querySelector(".imglykit-controls-list").parentNode;this._scrollbar=new m["default"](ac)}},{key:"_handleCloseButton",value:function W(){var ad=this;var ac=this._options.container.querySelector(".imglykit-close-button");ac.addEventListener("click",function(ae){ae.preventDefault();ad.emit("close")})}},{key:"render",value:function ab(){if(this._canvas){this._canvas.render()}}},{key:"pause",value:function F(){this._paused=true}},{key:"resume",value:function z(){var ac=arguments[0]===undefined?true:arguments[0];this._paused=false;if(ac){this.render()}}},{key:"addHistory",value:function T(ac,ad,ae){this._history.push({operation:ac,options:ad,existent:ae});this._topControls.updateUndoButton()}},{key:"hideZoom",value:function aa(){this._topControls.hideZoom()}},{key:"showZoom",value:function M(){this._topControls.showZoom()}},{key:"undo",value:function Z(){var ae=this._history.pop();if(ae){var ac=ae.operation;var af=ae.existent;var ad=ae.options;if(!af){this.removeOperation(ac.identifier)}else{ac=this.getOrCreateOperation(ac.identifier);ac.set(ad)}this.canvas.zoomToFit(true)}this._topControls.updateUndoButton()}},{key:"export",value:function A(){var ac=this;this.displayLoadingMessage("Exporting...");var ae=t.RenderType.DATAURL;var ad=document.createElement("canvas");if(typeof ad.msToBlob!=="undefined"){ae=t.RenderType.MSBLOB}setTimeout(function(){ac._kit.render(ae,ac._options.ui["export"].type,ac._options.ui["export"].dimensions,ac._options.ui["export"].quality).then(function(ag){switch(ae){case t.RenderType.DATAURL:var af=document.createElement("a");var ah=ac._options.ui["export"].type.split("/").pop();af.download="imglykit-export."+ah;af.href=ag;document.body.appendChild(af);af.click();document.body.removeChild(af);break;case t.RenderType.MSBLOB:navigator.msSaveBlob(ag,"imglykit-export.png");break}ac.hideLoadingMessage()})},1000)}},{key:"displayLoadingMessage",value:function G(ac){this._loadingSpan.innerText=ac;this._loadingOverlay.style.display="block"}},{key:"hideLoadingMessage",value:function D(){this._loadingOverlay.style.display="none"}},{key:"identifier",get:function(){return"night"}},{key:"operations",get:function(){return this._operationsMap}},{key:"controls",get:function(){return this._registeredControls}},{key:"context",get:function(){var ac=b(Object.getPrototypeOf(I.prototype),"context",this);ac.controls=this._registeredControls;ac.renderDropArea=this._options.ui.showNewButton;ac.controlsDisabled=!this._options.image;return ac}},{key:"history",get:function(){return this._history}},{key:"fileLoader",get:function(){return this._fileLoader}}]);return I})(r["default"]);j.Control=f(93);x["default"]=j;e.exports=x["default"]},function(c,b,d){},function(c,b,d){c.exports=a},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function h(l){f(this,h);this._modifiers={FIXED:"!"};this._dimensionsString=l;this._rules=this._parse();this._validateRules()}d(h,[{key:"_parse",value:function i(){if(typeof this._dimensionsString==="undefined"||this._dimensionsString===null){return null}var l=this._dimensionsString.match(/^([0-9]+)?x([0-9]+)?([\!])?$/i);if(!l){throw new Error("Invalid size option: "+this._dimensionsString)}return{x:isNaN(l[1])?null:parseInt(l[1],10),y:isNaN(l[2])?null:parseInt(l[2],10),modifier:l[3]}}},{key:"_validateRules",value:function j(){if(this._rules===null){return}var l=this._rules.x!==null;var m=this._rules.y!==null;if(this._rules.modifier===this._modifiers.FIXED&&!(l&&m)){throw new Error("Both `x` and `y` have to be set when using the fixed (!) modifier.")}if(!l&&!m){throw new Error("Neither `x` nor `y` are given.")}}},{key:"calculateFinalDimensions",value:function k(n){var m=n.clone(),l;if(this._rules===null){return m}if(this._rules.modifier===this._modifiers.FIXED){m.set(this._rules.x,this._rules.y)}else{if(this._rules.x!==null&&this._rules.y!==null){l=Math.min(this._rules.x/m.x,this._rules.y/m.y);m.multiply(l)}else{if(this._rules.x!==null){l=n.y/n.x;m.x=this._rules.x;m.y=m.x*l}else{if(this._rules.y!==null){l=n.x/n.y;m.y=this._rules.y;m.x=m.y*l}}}}return m}}]);return h})();c["default"]=b;e.exports=c["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();function o(p){return p&&p.__esModule?p:{"default":p}}function i(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var l=b(96);var e=o(l);var g=b(50);var j=o(g);var m=b(58);var d=o(m);var k=(function(t){function w(){i(this,w);if(t!=null){t.apply(this,arguments)}}n(w,t);f(w,[{key:"cache",value:function p(z){this._cache[z]={data:this._context.getImageData(0,0,this._canvas.width,this._canvas.height),size:new j["default"](this._canvas.width,this._canvas.height)}}},{key:"drawCached",value:function y(z){var B=this._cache[z];var C=B.data;var A=B.size;this._canvas.width=A.x;this._canvas.height=A.y;this._context.putImageData(C,0,0)}},{key:"_getContext",value:function q(){return this._canvas.getContext("2d")}},{key:"drawImage",value:function s(z){var A=this;return new d["default"](function(C,B){A._context.drawImage(z,0,0,z.width,z.height,0,0,A._canvas.width,A._canvas.height);C()})}},{key:"resizeTo",value:function u(A){var z=this.createCanvas();z.width=A.x;z.height=A.y;var B=z.getContext("2d");B.drawImage(this._canvas,0,0,this._canvas.width,this._canvas.height,0,0,z.width,z.height);this.setCanvas(z)}},{key:"cloneCanvas",value:function x(){var z=this.createCanvas();var A=z.getContext("2d");z.width=this._canvas.width;z.height=this._canvas.height;A.drawImage(this._canvas,0,0);return z}},{key:"reset",value:function v(){var z=arguments[0]===undefined?false:arguments[0];if(z){this._cache=[]}}}],[{key:"isSupported",value:function r(){var z=this.prototype.createCanvas();return !!(z.getContext&&z.getContext("2d"))}},{key:"identifier",get:function(){return"canvas"}}]);return w})(e["default"]);h["default"]=k;c.exports=h["default"]},function(e,s,h){Object.defineProperty(s,"__esModule",{value:true});var o=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var b=function r(A,z,w){var x=true;_function:while(x){var u=A,C=z,t=w;v=B=y=undefined;x=false;var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;w=t;x=true;continue _function}}else{if("value" in v){return v.value}else{var y=v.get;if(y===undefined){return undefined}return y.call(t)}}}};function d(t){return t&&t.__esModule?t:{"default":t}}function j(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function n(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){u.__proto__=t}}var q=h(96);var i=d(q);var m=h(50);var f=d(m);var c=h(57);var p=d(c);var k=h(58);var g=d(k);var l=(function(P){function F(){for(var U=arguments.length,V=Array(U),W=0;W<U;W++){V[W]=arguments[W]}j(this,F);b(Object.getPrototypeOf(F.prototype),"constructor",this).apply(this,V);this._defaultProgram=this.setupGLSLProgram();this.reset();this.id=F.contextId;F.contextId++}n(F,P);o(F,[{key:"cache",value:function H(U){var V=new f["default"](this._canvas.width,this._canvas.height);var Y=undefined,X=undefined,W=undefined;if(!this._cache[U]){W=this._createFramebuffer()}else{W=this._cache[U]}Y=W.fbo;X=W.texture;var Z=this._context;Z.useProgram(this._defaultProgram);Z.bindTexture(Z.TEXTURE_2D,X);Z.texImage2D(Z.TEXTURE_2D,0,Z.RGBA,V.x,V.y,0,Z.RGBA,Z.UNSIGNED_BYTE,null);Z.bindFramebuffer(Z.FRAMEBUFFER,Y);Z.viewport(0,0,V.x,V.y);Z.bindTexture(Z.TEXTURE_2D,this._lastTexture);Z.drawArrays(Z.TRIANGLES,0,6);this._cache[U]={fbo:Y,texture:X,size:V}}},{key:"_drawCachedFinal",value:function A(U){var W=this._cache[U];var X=W.texture;var V=W.size;var Y=this._context;Y.useProgram(this._defaultProgram);Y.bindFramebuffer(Y.FRAMEBUFFER,null);Y.bindTexture(Y.TEXTURE_2D,X);this._canvas.width=V.x;this._canvas.height=V.y;Y.viewport(0,0,V.x,V.y);Y.drawArrays(Y.TRIANGLES,0,6)}},{key:"drawCached",value:function D(Z){var W=this._cache[Z];var aa=W.texture;var ac=W.size;var V=this.getCurrentFramebuffer();var ab=this.getCurrentTexture();var Y=this._context;Y.useProgram(this._defaultProgram);this._canvas.width=ac.x;this._canvas.height=ac.y;for(var X=0;X<this._textures.length;X++){var U=this._textures[X];Y.bindTexture(Y.TEXTURE_2D,U);Y.texImage2D(Y.TEXTURE_2D,0,Y.RGBA,ac.x,ac.y,0,Y.RGBA,Y.UNSIGNED_BYTE,null)}Y.bindFramebuffer(Y.FRAMEBUFFER,V);Y.bindTexture(Y.TEXTURE_2D,ab);Y.texImage2D(Y.TEXTURE_2D,0,Y.RGBA,ac.x,ac.y,0,Y.RGBA,Y.UNSIGNED_BYTE,null);Y.bindTexture(Y.TEXTURE_2D,aa);Y.viewport(0,0,ac.x,ac.y);Y.clear(Y.COLOR_BUFFER_BIT|Y.DEPTH_BUFFER_BIT);Y.drawArrays(Y.TRIANGLES,0,6);this.setLastTexture(ab);this.selectNextBuffer()}},{key:"_getContext",value:function L(){var U=this._canvas.getContext("webgl",this._contextOptions)||this._canvas.getContext("experimental-webgl",this._contextOptions);U.disable(U.DEPTH_TEST);U.disable(U.CULL_FACE);this._maxTextureSize=U.getParameter(U.MAX_TEXTURE_SIZE);return U}},{key:"drawImage",value:function M(U){var V=this;return new g["default"](function(Y,X){var Z=V._context;Z.useProgram(V._defaultProgram);var W=V.createTexture();Z.pixelStorei(Z.UNPACK_FLIP_Y_WEBGL,true);V._inputTexture=W;V.setLastTexture(W);Z.pixelStorei(Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);Z.texImage2D(Z.TEXTURE_2D,0,Z.RGBA,Z.RGBA,Z.UNSIGNED_BYTE,U);V._clear(Z);Z.drawArrays(Z.TRIANGLES,0,6);Y()})}},{key:"prepareImage",value:function E(Y){if(Y.width<=this._maxTextureSize&&Y.height<=this._maxTextureSize){return g["default"].resolve(Y)}var ab=new f["default"](this._maxTextureSize,this._maxTextureSize);var ac=new f["default"](Y.width,Y.height);var X=Math.min(ab.x/ac.x,ab.y/ac.y);var aa=ac.clone().multiply(X);var V=this.createCanvas(aa.x,aa.y);var U=V.getContext("2d");U.drawImage(Y,0,0,ac.x,ac.y,0,0,aa.x,aa.y);var Z=V.toDataURL("image/jpeg");var W=/^data:image\/jpeg/i;if(Y.src.match(W)&&Z.match(W)){Z=p["default"].restore(Y.src,Z)}return new g["default"](function(ae,ad){var af=new Image();af.addEventListener("load",function(){ae(af)});af.src=Z})}},{key:"_clear",value:function z(U){U.clearColor(0,0,0,0);U.clear(U.COLOR_BUFFER_BIT)}},{key:"runProgram",value:function B(W,Y){var ab=this._context;ab.useProgram(W);var aa=this.getCurrentFramebuffer();var Z=this.getCurrentTexture();ab.bindFramebuffer(ab.FRAMEBUFFER,aa);ab.viewport(0,0,this._canvas.width,this._canvas.height);ab.bindTexture(ab.TEXTURE_2D,Z);ab.pixelStorei(ab.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);ab.texImage2D(ab.TEXTURE_2D,0,ab.RGBA,this._canvas.width,this._canvas.height,0,ab.RGBA,ab.UNSIGNED_BYTE,null);ab.bindTexture(ab.TEXTURE_2D,this._lastTexture);for(var X in Y.uniforms){var V=ab.getUniformLocation(W,X);var U=Y.uniforms[X];switch(U.type){case"i":case"1i":ab.uniform1i(V,U.value);break;case"f":case"1f":ab.uniform1f(V,U.value);break;case"2f":ab.uniform2f(V,U.value[0],U.value[1]);break;case"3f":ab.uniform3f(V,U.value[0],U.value[1],U.value[2]);break;case"4f":ab.uniform4f(V,U.value[0],U.value[1],U.value[2],U.value[3]);break;case"2fv":ab.uniform2fv(V,U.value);break;case"mat3fv":ab.uniformMatrix3fv(V,false,U.value);break;default:throw new Error("Unknown uniform type: "+U.type)}}ab.clear(ab.COLOR_BUFFER_BIT|ab.DEPTH_BUFFER_BIT);ab.drawArrays(ab.TRIANGLES,0,6);this.setLastTexture(Z);this.selectNextBuffer()}},{key:"runShader",value:function K(X,U,W){if(typeof W==="undefined"){W={}}if(typeof W.uniforms==="undefined"){W.uniforms={}}var V=this.setupGLSLProgram(X,U);this.runProgram(V,W)}},{key:"renderFinal",value:function O(){var V=this._context;var U=this._defaultProgram;V.useProgram(U);V.bindFramebuffer(V.FRAMEBUFFER,null);V.viewport(0,0,this._canvas.width,this._canvas.height);V.bindTexture(V.TEXTURE_2D,this._lastTexture);this._clear(V);V.drawArrays(V.TRIANGLES,0,6)}},{key:"setupGLSLProgram",value:function x(ad,X){var ab=this._context;var af=[];ad=this._createShader(ab.VERTEX_SHADER,ad||F.prototype.defaultVertexShader);af.push(ad);X=this._createShader(ab.FRAGMENT_SHADER,X||F.prototype.defaultFragmentShader);af.push(X);var aa=ab.createProgram();for(var Z=0;Z<af.length;Z++){ab.attachShader(aa,af[Z])}ab.linkProgram(aa);var V=ab.getProgramParameter(aa,ab.LINK_STATUS);if(!V){var ac=ab.getProgramInfoLog(aa);ab.deleteProgram(aa);throw new Error("WebGL program linking error: "+ac)}var ae=ab.getAttribLocation(aa,"a_position");var W=ab.getAttribLocation(aa,"a_texCoord");var U=ab.createBuffer();ab.bindBuffer(ab.ARRAY_BUFFER,U);ab.bufferData(ab.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),ab.STATIC_DRAW);ab.enableVertexAttribArray(W);ab.vertexAttribPointer(W,2,ab.FLOAT,false,0,0);var Y=ab.createBuffer();ab.bindBuffer(ab.ARRAY_BUFFER,Y);ab.enableVertexAttribArray(ae);ab.vertexAttribPointer(ae,2,ab.FLOAT,false,0,0);ab.bufferData(ab.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),ab.STATIC_DRAW);return aa}},{key:"_createShader",value:function u(X,Z){var W=this._context;var U=W.createShader(X);W.shaderSource(U,Z);W.compileShader(U);var V=W.getShaderParameter(U,W.COMPILE_STATUS);if(!V){var Y=W.getShaderInfoLog(U);W.deleteShader(U);throw new Error("WebGL shader compilation error: "+Y)}return U}},{key:"createTexture",value:function v(){var V=this._context;var U=V.createTexture();V.bindTexture(V.TEXTURE_2D,U);V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE);V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE);V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.NEAREST);V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.NEAREST);return U}},{key:"_createFramebuffers",value:function G(){for(var U=0;U<2;U++){var X=this._createFramebuffer();var W=X.fbo;var V=X.texture;this._textures.push(V);this._framebuffers.push(W)}}},{key:"_createFramebuffer",value:function N(){var W=this._context;var V=this.createTexture();W.pixelStorei(W.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);W.texImage2D(W.TEXTURE_2D,0,W.RGBA,this._canvas.width,this._canvas.height,0,W.RGBA,W.UNSIGNED_BYTE,null);var U=W.createFramebuffer();W.bindFramebuffer(W.FRAMEBUFFER,U);W.framebufferTexture2D(W.FRAMEBUFFER,W.COLOR_ATTACHMENT0,W.TEXTURE_2D,V,0);return{fbo:U,texture:V}}},{key:"resizeTo",value:function J(U){var V=this._context;this._canvas.width=U.x;this._canvas.height=U.y;V.viewport(0,0,this._canvas.width,this._canvas.height);V.drawArrays(V.TRIANGLES,0,6)}},{key:"getCurrentFramebuffer",value:function C(){return this._framebuffers[this._bufferIndex%2]}},{key:"getCurrentTexture",value:function y(){return this._textures[this._bufferIndex%2]}},{key:"selectNextBuffer",value:function t(){this._bufferIndex++}},{key:"getDefaultProgram",value:function I(){return this._defaultProgram}},{key:"getLastTexture",value:function S(){return this._lastTexture}},{key:"getTextures",value:function w(){return this._textures}},{key:"setLastTexture",value:function R(U){this._lastTexture=U}},{key:"reset",value:function Q(){var U=arguments[0]===undefined?false:arguments[0];this._lastTexture=null;this._textures=[];this._framebuffers=[];this._bufferIndex=0;if(U){this._cache=[]}this._createFramebuffers();this.setLastTexture(this._inputTexture)}},{key:"_contextOptions",get:function(){return{alpha:true,premultipliedAlpha:true}}},{key:"identifier",get:function(){return"webgl"}},{key:"defaultVertexShader",get:function(){var U="\n      attribute vec2 a_position;\n      attribute vec2 a_texCoord;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_Position = vec4(a_position, 0, 1);\n        v_texCoord = a_texCoord;\n      }\n    ";return U}},{key:"defaultFragmentShader",get:function(){var U="\n      precision mediump float;\n      uniform sampler2D u_image;\n      varying vec2 v_texCoord;\n\n      void main() {\n        gl_FragColor = texture2D(u_image, v_texCoord);\n      }\n    ";return U}},{key:"maxTextureSize",get:function(){return this._maxTextureSize}}],[{key:"isSupported",value:function T(){if(typeof window==="undefined"){return false}var U=document.createElement("canvas");var V=U.getContext("webgl")||U.getContext("experimental-webgl");return !!V}}]);return F})(i["default"]);l.contextId=0;s["default"]=l;e.exports=s["default"]},function(e,g,d){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function h(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}var c=d(95);var i=k(c);var j="data:image/jpeg;base64,";var b=(function(){function m(){h(this,m)}f(m,null,[{key:"restore",value:function n(t,s){if(!t.match(j)){return s}var v=i["default"].decode(t.replace(j,""));var r=this._sliceIntoSegments(v);var u=this._exifManipulation(s,r);return j+i["default"].encode(u)}},{key:"_exifManipulation",value:function p(v,u){var r=this._getExifArray(u);var t=this._insertExif(v,r);var s=new Uint8Array(t);return s}},{key:"_getExifArray",value:function q(s){var r=undefined;for(var t=0;t<s.length;t++){r=s[t];if(r[0]===255&&r[1]===225){return r}}return[]}},{key:"_insertExif",value:function l(v,r){var y=v.replace(j,"");var t=i["default"].decode(y);var s=t.indexOf(255,3);var w=t.slice(0,s);var u=t.slice(s);var x=w;x=x.concat(r);x=x.concat(u);return x}},{key:"_sliceIntoSegments",value:function o(v){var u=0;var s=[];while(1){if(v[u]===255&&v[u+1]===218){break}if(v[u]===255&&v[u+1]===216){u+=2}else{var w=v[u+2]*256+v[u+3];var t=u+w+2;var r=v.slice(u,t);s.push(r);u=t}if(u>v.length){break}}return s}}]);return m})();g["default"]=b;e.exports=g["default"]},function(c,b,d){(function(f){Object.defineProperty(b,"__esModule",{value:true});var e=typeof f!=="undefined"?f:typeof window!=="undefined"?window:null;var g=e.Promise;if(!g){g=d(98)}b["default"]=g;c.exports=b["default"]}.call(b,(function(){return this}())))},function(c,b,d){c.exports=function(h,e){var g=this;var j;if(h&&h.hasOwnProperty("constructor")){j=h.constructor}else{j=function(){return g.apply(this,arguments)}}var f;for(f in g){j[f]=g[f]}if(typeof e!=="undefined"){for(f in e){j[f]=e[f]}}var i=function i(){this.constructor=j};i.prototype=g.prototype;j.prototype=new i();if(h){for(f in h){j.prototype[f]=h[f]}}j.__super__=g.prototype;return j}},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function h(){for(var k=arguments.length,l=Array(k),m=0;m<k;m++){l[m]=arguments[m]}f(this,h);this._stack=[]}d(h,[{key:"add",value:function j(k){this._stack.push(k)}},{key:"render",value:function i(m){for(var l=0;l<this._stack.length;l++){var k=this._stack[l];k.render(m)}}}]);return h})();c["default"]=b;e.exports=c["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var l=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function k(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var j=b(1);var e=o(j);var i=b(97);var n=o(i);var g=(function(p){function r(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}k(this,r);l(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=e["default"].defaults(this._options,{saturation:0});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_saturation;\n\n      const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float luminance = dot(texColor.rgb, luminanceWeighting);\n\n        vec3 greyScaleColor = vec3(luminance);\n\n        gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);\n      }\n    "}m(r,p);f(r,[{key:"renderWebGL",value:function s(t){if(!this._glslPrograms[t.id]){this._glslPrograms[t.id]=t.setupGLSLProgram(null,this._fragmentShader)}t.runProgram(this._glslPrograms[t.id],{uniforms:{u_saturation:{type:"f",value:this._options.saturation}}})}},{key:"renderCanvas",value:function q(A){var w=A.getCanvas();var C=A.getContext().getImageData(0,0,w.width,w.height);var z=this._options.saturation;for(var t=0;t<w.width;t++){for(var B=0;B<w.height;B++){var v=(w.width*B+t)*4;var u=C.data[v]*0.2125+C.data[v+1]*0.7154+C.data[v+2]*0.0721;C.data[v]=u*(1-z)+C.data[v]*z;C.data[v+1]=u*(1-z)+C.data[v+1]*z;C.data[v+2]=u*(1-z)+C.data[v+2]*z}}A.getContext().putImageData(C,0,0)}}]);return r})(n["default"]);h["default"]=g;c.exports=h["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var j=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function i(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var h=c(97);var l=m(h);var b=(function(n){function r(){for(var s=arguments.length,t=Array(s),u=0;u<s;u++){t[u]=arguments[u]}i(this,r);j(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,t);this._textureIndex=3;this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform sampler2D u_lookupTable;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;\n        float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;\n        float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;\n\n        gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);\n      }\n    "}k(r,n);f(r,[{key:"renderWebGL",value:function q(s){this._updateTexture(s);s.runShader(null,this._fragmentShader,{uniforms:{u_lookupTable:{type:"i",value:3}}})}},{key:"renderCanvas",value:function o(z){var u=z.getCanvas();var s=z.getContext().getImageData(0,0,u.width,u.height);var D=this._options.data;for(var C=0;C<u.width;C++){for(var B=0;B<u.height;B++){var w=(u.width*B+C)*4;var t=s.data[w];s.data[w]=D[t*4];var v=s.data[w+1];s.data[w+1]=D[1+v*4];var A=s.data[w+2];s.data[w+2]=D[2+A*4]}}z.getContext().putImageData(s,0,0)}},{key:"_updateTexture",value:function p(t){var u=t.getContext();if(typeof this._options.data==="undefined"){throw new Error("LookupTable: No data specified.")}var s=new Uint8Array(this._options.data);u.activeTexture(u.TEXTURE0+this._textureIndex);if(!this._texture){this._texture=u.createTexture()}u.bindTexture(u.TEXTURE_2D,this._texture);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE);u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE);u.texImage2D(u.TEXTURE_2D,0,u.RGBA,256,1,0,u.RGBA,u.UNSIGNED_BYTE,s);u.activeTexture(u.TEXTURE0)}}]);return r})(l["default"]);g["default"]=b;d.exports=g["default"]},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var h=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var l=function f(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function k(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var j=d(1);var g=o(j);var m=d(62);var b=o(m);var c=(function(r){function u(){for(var w=arguments.length,x=Array(w),y=0;y<w;y++){x[y]=arguments[y]}k(this,u);l(Object.getPrototypeOf(u.prototype),"constructor",this).apply(this,x);this._options=g["default"].defaults(this._options,{rgbControlPoints:{red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}});if(typeof this._options.rgbControlPoints!=="undefined"){this._updateLookupTable()}}n(u,r);h(u,[{key:"_updateLookupTable",value:function t(){var y=this._calculateSplineCurve(this._options.rgbControlPoints.red);var x=this._calculateSplineCurve(this._options.rgbControlPoints.green);var w=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(y,x,w)}},{key:"_buildLookupTable",value:function q(z,y,w){var A=[];for(var x=0;x<256;x++){A.push(Math.min(Math.max(x+z[x],0),255));A.push(Math.min(Math.max(x+y[x],0),255));A.push(Math.min(Math.max(x+w[x],0),255));A.push(255)}return A}},{key:"_calculateSplineCurve",value:function v(B){B=B.sort(function(F,E){return F[0]>E[0]});var w=this._getSplineCurve(B);var C=w[0];var z;if(C[0]>0){for(z=0;z<C[0];z++){w.unshift([0,0])}}var y=[];for(z=0;z<w.length;z++){var x=w[z];var A=[x[0],x[0]];var D=Math.sqrt(Math.pow(A[0]-x[0],2)+Math.pow(A[1]-x[1],2));if(A[1]>x[1]){D=-D}y.push(D)}return y}},{key:"_getSplineCurve",value:function s(K){var A=this._secondDerivative(K);var w=A.length;var E=[];var B;for(B=0;B<w;B++){E[B]=A[B]}var z=[];for(B=0;B<w-1;B++){var J=K[B];var D=K[B+1];for(var I=J[0];I<D[0];I++){var L=(I-J[0])/(D[0]-J[0]);var H=1-L;var G=L;var C=D[0]-J[0];var F=H*J[1]+G*D[1]+C*C/6*((H*H*H-H)*E[B]+(G*G*G-G)*E[B+1]);if(F>255){F=255}else{if(F<0){F=0}}z.push([I,F])}}if(z.length===255){z.push(K[K.length-1])}return z}},{key:"_secondDerivative",value:function p(C){var x=C.length;if(x<=0||x===1){return null}var B=[];var F=[];var z,y;B[0]=[0,1,0];for(z=1;z<x-1;z++){var w=C[z-1];var E=C[z];var D=C[z+1];B[z]=B[z]||[];B[z][0]=(E[0]-w[0])/6;B[z][1]=(D[0]-w[0])/3;B[z][2]=(D[0]-E[0])/6;F[z]=(D[1]-E[1])/(D[0]-E[0])-(E[1]-w[1])/(E[0]-w[0])}F[0]=0;F[x-1]=0;B[x-1]=[0,1,0];for(z=1;z<x;z++){y=B[1][0]/B[z-1][1];B[z][1]-=y*B[z-1][2];B[z][0]=0;F[z]-=y*F[z-1]}for(z=x-2;z>0;z--){y=B[z][2]/B[z+1][1];B[z][1]-=y*B[z+1][0];B[z][2]=0;F[z]-=y*F[z+1]}var A=[];for(z=0;z<x;z++){A[z]=F[z]/B[z][1]}return A}}]);return u})(b["default"]);i["default"]=c;e.exports=i["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var h=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var m=function e(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function l(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var k=c(1);var g=q(k);var j=c(97);var p=q(j);var n=c(7);var b=q(n);var f=(function(s){function r(){for(var v=arguments.length,w=Array(v),x=0;x<v;x++){w[x]=arguments[x]}l(this,r);m(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,w);this._options=g["default"].defaults(this._options,{color:new b["default"](1,1,1)});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform vec3 u_overlay;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        vec4 overlayVec4 = vec4(u_overlay, texColor.a);\n        gl_FragColor = max(overlayVec4 * texColor.a, texColor);\n      }\n    "}o(r,s);h(r,[{key:"renderWebGL",value:function u(v){v.runShader(null,this._fragmentShader,{uniforms:{u_overlay:{type:"3f",value:this._options.color.toRGBGLColor()}}})}},{key:"renderCanvas",value:function t(A){var z=A.getCanvas();var C=A.getContext().getImageData(0,0,z.width,z.height);for(var v=0;v<z.width;v++){for(var B=0;B<z.height;B++){var w=(z.width*B+v)*4;C.data[w]=Math.max(this._options.color.r,C.data[w]);C.data[w+1]=Math.max(this._options.color.g,C.data[w+1]);C.data[w+2]=Math.max(this._options.color.b,C.data[w+2])}}A.getContext().putImageData(C,0,0)}}]);return r})(p["default"]);i["default"]=f;d.exports=i["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var l=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function k(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var j=b(1);var e=o(j);var i=b(97);var n=o(i);var g=(function(p){function r(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}k(this,r);l(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=e["default"].defaults(this._options,{desaturation:1});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_desaturation;\n\n      const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        vec3 grayXfer = vec3(0.3, 0.59, 0.11);\n        vec3 gray = vec3(dot(grayXfer, texColor.xyz));\n        gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);\n      }\n    "}m(r,p);f(r,[{key:"renderWebGL",value:function s(t){t.runShader(null,this._fragmentShader,{uniforms:{u_desaturation:{type:"f",value:this._options.desaturation}}})}},{key:"renderCanvas",value:function q(A){var w=A.getCanvas();var C=A.getContext().getImageData(0,0,w.width,w.height);var z=this._options.desaturation;for(var t=0;t<w.width;t++){for(var B=0;B<w.height;B++){var v=(w.width*B+t)*4;var u=C.data[v]*0.3+C.data[v+1]*0.59+C.data[v+2]*0.11;C.data[v]=u*(1-z)+C.data[v]*z;C.data[v+1]=u*(1-z)+C.data[v+1]*z;C.data[v+2]=u*(1-z)+C.data[v+2]*z}}A.getContext().putImageData(C,0,0)}}]);return r})(n["default"]);h["default"]=g;c.exports=h["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var g=b(97);var l=m(g);var j=(function(n){function p(){for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}h(this,p);i(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,s);this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;\n        gray -= 0.2;\n        gray = clamp(gray, 0.0, 1.0);\n        gray += 0.15;\n        gray *= 1.4;\n        gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);\n      }\n    "}k(p,n);e(p,[{key:"renderWebGL",value:function q(r){r.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function o(v){var u=v.getCanvas();var z=v.getContext().getImageData(0,0,u.width,u.height);for(var s=0;s<u.width;s++){for(var w=0;w<u.height;w++){var t=(u.width*w+s)*4;var r=z.data[t]/255*0.3+z.data[t+1]/255*0.3+z.data[t+2]/255*0.3;r-=0.2;r=Math.max(0,Math.min(1,r));r+=0.15;r*=1.4;r*=255;z.data[t]=r;z.data[t+1]=r;z.data[t+2]=r}}v.getContext().putImageData(z,0,0)}}]);return p})(l["default"]);f["default"]=j;c.exports=f["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var j=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function i(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var h=b(97);var l=m(h);var e=(function(n){function p(){for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}i(this,p);j(Object.getPrototypeOf(p.prototype),"constructor",this).apply(this,s);this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      vec3 W = vec3(0.2125, 0.7154, 0.0721);\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        float luminance = dot(texColor.rgb, W);\n        gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);\n      }\n    "}k(p,n);f(p,[{key:"renderWebGL",value:function q(r){r.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function o(v){var u=v.getCanvas();var z=v.getContext().getImageData(0,0,u.width,u.height);for(var r=0;r<u.width;r++){for(var w=0;w<u.height;w++){var t=(u.width*w+r)*4;var s=z.data[t]*0.2125+z.data[t+1]*0.7154+z.data[t+2]*0.0721;z.data[t]=s;z.data[t+1]=s;z.data[t+2]=s}}v.getContext().putImageData(z,0,0)}}]);return p})(l["default"]);g["default"]=e;c.exports=g["default"]},function(d,h,c){Object.defineProperty(h,"__esModule",{value:true});var g=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var l=function e(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function k(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var j=c(1);var f=o(j);var i=c(97);var n=o(i);var b=(function(p){function r(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}k(this,r);l(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=f["default"].defaults(this._options,{contrast:1});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_contrast;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);\n      }\n    "}m(r,p);g(r,[{key:"renderWebGL",value:function s(t){if(!this._glslPrograms[t.id]){this._glslPrograms[t.id]=t.setupGLSLProgram(null,this._fragmentShader)}t.runProgram(this._glslPrograms[t.id],{uniforms:{u_contrast:{type:"f",value:this._options.contrast}}})}},{key:"renderCanvas",value:function q(z){var v=z.getCanvas();var B=z.getContext().getImageData(0,0,v.width,v.height);var w=this._options.contrast;for(var t=0;t<v.width;t++){for(var A=0;A<v.height;A++){var u=(v.width*A+t)*4;B.data[u]=(B.data[u]-127)*w+127;B.data[u+1]=(B.data[u+1]-127)*w+127;B.data[u+2]=(B.data[u+2]-127)*w+127}}z.getContext().putImageData(B,0,0)}}]);return r})(n["default"]);h["default"]=b;d.exports=h["default"]},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var h=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var m=function f(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function q(r){return r&&r.__esModule?r:{"default":r}}function l(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var k=d(1);var g=q(k);var j=d(97);var p=q(j);var n=d(7);var c=q(n);var b=(function(r){function t(){for(var v=arguments.length,w=Array(v),x=0;x<v;x++){w[x]=arguments[x]}l(this,t);m(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,w);this._options=g["default"].defaults(this._options,{color:new c["default"](1,1,1)});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      uniform vec3 u_color;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n\n        vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);\n        textureCoord /= 0.75;\n\n        float d = 1.0 - dot(textureCoord, textureCoord);\n        d = clamp(d, 0.2, 1.0);\n        vec3 newColor = texColor.rgb * d * u_color.rgb;\n        gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);\n      }\n    "}o(t,r);h(t,[{key:"renderWebGL",value:function u(v){v.runShader(null,this._fragmentShader,{uniforms:{u_color:{type:"3f",value:this._options.color.toRGBGLColor()}}})}},{key:"renderCanvas",value:function s(I){var w=I.getCanvas();var v=I.getContext().getImageData(0,0,w.width,w.height);var A=this._options.color;var H;for(var K=0;K<w.width;K++){for(var J=0;J<w.height;J++){var E=(w.width*J+K)*4;var z=K/w.width;var C=J/w.height;var D=(z-0.5)/0.75;var B=(C-0.5)/0.75;var G=D*D;var F=B*B;H=1-(G+F);H=Math.min(Math.max(H,0.1),1);v.data[E]=v.data[E]*(H*A.r);v.data[E+1]=v.data[E+1]*(H*A.g);v.data[E+2]=v.data[E+2]*(H*A.b);v.data[E+3]=255}}I.getContext().putImageData(v,0,0)}}]);return t})(p["default"]);i["default"]=b;e.exports=i["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function d(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function k(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var g=b(97);var l=m(g);var j=(function(n){function q(){for(var r=arguments.length,s=Array(r),t=0;t<r;t++){s[t]=arguments[t]}h(this,q);i(Object.getPrototypeOf(q.prototype),"constructor",this).apply(this,s);this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        texColor.b = texColor.g * 0.33;\n        texColor.r = texColor.r * 0.6;\n        texColor.b += texColor.r * 0.33;\n        texColor.g = texColor.g * 0.7;\n        gl_FragColor = texColor;\n      }\n    "}k(q,n);e(q,[{key:"renderWebGL",value:function p(r){r.runShader(null,this._fragmentShader)}},{key:"renderCanvas",value:function o(u){var t=u.getCanvas();var w=u.getContext().getImageData(0,0,t.width,t.height);for(var r=0;r<t.width;r++){for(var v=0;v<t.height;v++){var s=(t.width*v+r)*4;w.data[s+2]=w.data[s+1]*0.33;w.data[s]=w.data[s]*0.6;w.data[s+2]+=w.data[s]*0.33;w.data[s+1]=w.data[s+1]*0.7;w.data[s+3]=255}}u.getContext().putImageData(w,0,0)}}]);return q})(l["default"]);f["default"]=j;c.exports=f["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var i=b(1);var e=o(i);var h=b(97);var n=o(h);var l=(function(p){function r(){for(var t=arguments.length,u=Array(t),v=0;v<t;v++){u[v]=arguments[v]}j(this,r);k(Object.getPrototypeOf(r.prototype),"constructor",this).apply(this,u);this._options=e["default"].defaults(this._options,{brightness:1});this._fragmentShader="\n      precision mediump float;\n      varying vec2 v_texCoord;\n      uniform sampler2D u_image;\n      uniform float u_brightness;\n\n      void main() {\n        vec4 texColor = texture2D(u_image, v_texCoord);\n        gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;\n      }\n    "}m(r,p);f(r,[{key:"renderWebGL",value:function s(t){if(!this._glslPrograms[t.id]){this._glslPrograms[t.id]=t.setupGLSLProgram(null,this._fragmentShader)}t.runProgram(this._glslPrograms[t.id],{uniforms:{u_brightness:{type:"f",value:this._options.brightness}}})}},{key:"renderCanvas",value:function q(w){var v=w.getCanvas();var B=w.getContext().getImageData(0,0,v.width,v.height);var z=this._options.brightness;for(var t=0;t<v.width;t++){for(var A=0;A<v.height;A++){var u=(v.width*A+t)*4;B.data[u]=B.data[u]+z*255;B.data[u+1]=B.data[u+1]+z*255;B.data[u+2]=B.data[u+2]+z*255}}w.getContext().putImageData(B,0,0)}}]);return r})(n["default"]);g["default"]=l;c.exports=g["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var g=b(8);var j=k(g);var h=(function(n){function m(){f(this,m);if(n!=null){n.apply(this,arguments)}}i(m,n);d(m,[{key:"render",value:function l(){}},{key:"name",get:function(){return"Original"}}],[{key:"identifier",get:function(){return"identity"}}]);return m})(j["default"]);e["default"]=h;c.exports=e["default"]},function(e,b,i){Object.defineProperty(b,"__esModule",{value:true});var d=(function(){function j(n,l){for(var k=0;k<l.length;k++){var m=l[k];m.enumerable=m.enumerable||false;m.configurable=true;if("value" in m){m.writable=true}Object.defineProperty(n,m.key,m)}}return function(m,k,l){if(k){j(m.prototype,k)}if(l){j(m,l)}return m}})();function h(j,k){if(!(j instanceof k)){throw new TypeError("Cannot call a class as a function")}}var g=12;function c(m){for(var j=arguments.length,k=Array(j>1?j-1:0),l=1;l<j;l++){k[l-1]=arguments[l]}console.error.apply(console,[m].concat(k));console.trace()}var f=(function(){function n(){h(this,n);this._maxListeners=g;this._events={}}d(n,[{key:"on",value:function j(q,r){if(typeof r!=="function"){throw new TypeError()}var p=this._events[q]||(this._events[q]=[]);if(p.indexOf(r)!==-1){return this}p.push(r);if(p.length>this._maxListeners){c("possible memory leak, added %i %s listeners,\n        use EventEmitter#setMaxListeners(number) if you\n        want to increase the limit (%i now)",p.length,q,this._maxListeners)}return this}},{key:"once",value:function m(q,s){var r=this;function p(){r.off(q,p);s.apply(null,arguments)}return this.on(q,p)}},{key:"off",value:function o(t){for(var p=arguments.length,r=Array(p>1?p-1:0),q=1;q<p;q++){r[q-1]=arguments[q]}if(r.length===0){this._events[t]=null;return this}var v=r[0];if(typeof v!=="function"){throw new TypeError()}var s=this._events[t];if(!s||!s.length){return this}var u=s.indexOf(v);if(u===-1){return this}s.splice(u,1);return this}},{key:"emit",value:function k(s){for(var t=arguments.length,q=Array(t>1?t-1:0),p=1;p<t;p++){q[p-1]=arguments[p]}var r=this._events[s];if(!r||!r.length){return false}r.forEach(function(u){return u.apply(null,q)});return true}},{key:"setMaxListeners",value:function l(p){if(parseInt(p,10)!==p){throw new TypeError()}this._maxListeners=p}}]);return n})();b["default"]=f;e.exports=b["default"]},function(d,c,f){
/*!
	
	StackBlur - a fast almost Gaussian Blur For Canvas
	
	Version:  0.5
	Author:   Mario Klingemann
	Contact:  mario@quasimondo.com
	Website:  http://www.quasimondo.com/StackBlurForCanvas
	Twitter:  @quasimondo
	
	In case you find this class useful - especially in commercial projects -
	I am not totally unhappy for a small donation to my PayPal account
	mario@quasimondo.de
	
	Or support me on flattr:
	https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript
	
	Copyright (c) 2010 Mario Klingemann
	
	Permission is hereby granted, free of charge, to any person
	obtaining a copy of this software and associated documentation
	files (the "Software"), to deal in the Software without
	restriction, including without limitation the rights to use,
	copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the
	Software is furnished to do so, subject to the following
	conditions:
	
	The above copyright notice and this permission notice shall be
	included in all copies or substantial portions of the Software.
	
	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
	EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
	OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
	NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
	HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
	WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
	FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
	OTHER DEALINGS IN THE SOFTWARE.
	*/
var b=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259];var h=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function g(Z,M,K,j,l,U){if(isNaN(U)||U<1){return}U|=0;var q=Z.data;var S,R,ab,Y,A,D,u,n,o,J,X,w,L,H,k,P,T,B,v,t,C,E,F,O;var ac=U+U+1;var z=j-1;var W=l-1;var s=U+1;var V=s*(s+1)/2;var N=new e();var r;var I=N;for(ab=1;ab<ac;ab++){I=I.next=new e();if(ab==s){r=I}}I.next=N;var aa=null;var Q=null;u=D=0;var G=b[U];var m=h[U];for(R=0;R<l;R++){P=T=B=v=n=o=J=X=0;w=s*(t=q[D]);L=s*(C=q[D+1]);H=s*(E=q[D+2]);k=s*(F=q[D+3]);n+=V*t;o+=V*C;J+=V*E;X+=V*F;I=N;for(ab=0;ab<s;ab++){I.r=t;I.g=C;I.b=E;I.a=F;I=I.next}for(ab=1;ab<s;ab++){Y=D+((z<ab?z:ab)<<2);n+=(I.r=t=q[Y])*(O=s-ab);o+=(I.g=C=q[Y+1])*O;J+=(I.b=E=q[Y+2])*O;X+=(I.a=F=q[Y+3])*O;P+=t;T+=C;B+=E;v+=F;I=I.next}aa=N;Q=r;for(S=0;S<j;S++){q[D+3]=F=X*G>>m;if(F!==0){F=255/F;q[D]=(n*G>>m)*F;q[D+1]=(o*G>>m)*F;q[D+2]=(J*G>>m)*F}else{q[D]=q[D+1]=q[D+2]=0}n-=w;o-=L;J-=H;X-=k;w-=aa.r;L-=aa.g;H-=aa.b;k-=aa.a;Y=u+((Y=S+U+1)<z?Y:z)<<2;P+=aa.r=q[Y];T+=aa.g=q[Y+1];B+=aa.b=q[Y+2];v+=aa.a=q[Y+3];n+=P;o+=T;J+=B;X+=v;aa=aa.next;w+=t=Q.r;L+=C=Q.g;H+=E=Q.b;k+=F=Q.a;P-=t;T-=C;B-=E;v-=F;Q=Q.next;D+=4}u+=j}for(S=0;S<j;S++){T=B=v=P=o=J=X=n=0;D=S<<2;w=s*(t=q[D]);L=s*(C=q[D+1]);H=s*(E=q[D+2]);k=s*(F=q[D+3]);n+=V*t;o+=V*C;J+=V*E;X+=V*F;I=N;for(ab=0;ab<s;ab++){I.r=t;I.g=C;I.b=E;I.a=F;I=I.next}A=j;for(ab=1;ab<=U;ab++){D=A+S<<2;n+=(I.r=t=q[D])*(O=s-ab);o+=(I.g=C=q[D+1])*O;J+=(I.b=E=q[D+2])*O;X+=(I.a=F=q[D+3])*O;P+=t;T+=C;B+=E;v+=F;I=I.next;if(ab<W){A+=j}}D=S;aa=N;Q=r;for(R=0;R<l;R++){Y=D<<2;q[Y+3]=F=X*G>>m;if(F>0){F=255/F;q[Y]=(n*G>>m)*F;q[Y+1]=(o*G>>m)*F;q[Y+2]=(J*G>>m)*F}else{q[Y]=q[Y+1]=q[Y+2]=0}n-=w;o-=L;J-=H;X-=k;w-=aa.r;L-=aa.g;H-=aa.b;k-=aa.a;Y=S+((Y=R+s)<W?Y:W)*j<<2;n+=P+=aa.r=q[Y];o+=T+=aa.g=q[Y+1];J+=B+=aa.b=q[Y+2];X+=v+=aa.a=q[Y+3];aa=aa.next;w+=t=Q.r;L+=C=Q.g;H+=E=Q.b;k+=F=Q.a;P-=t;T-=C;B-=E;v-=F;Q=Q.next;D+=j}}}function e(){this.r=0;this.g=0;this.b=0;this.a=0;this.next=null}d.exports={stackBlurCanvasRGBA:g}},function(d,c,h){var g=d.exports={};var b=[];var i=false;function f(){if(i){return}i=true;var l;var j=b.length;while(j){l=b;b=[];var k=-1;while(++k<j){l[k]()}j=b.length}i=false}g.nextTick=function(j){b.push(j);if(!i){setTimeout(f,0)}};g.title="browser";g.browser=true;g.env={};g.argv=[];g.version="";g.versions={};function e(){}g.on=e;g.addListener=e;g.once=e;g.off=e;g.removeListener=e;g.removeAllListeners=e;g.emit=e;g.binding=function(j){throw new Error("process.binding is not supported")};g.cwd=function(){return"/"};g.chdir=function(j){throw new Error("process.chdir is not supported")};g.umask=function(){return 0}},function(e,i,d){Object.defineProperty(i,"__esModule",{value:true});var g=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function f(y,x,w){var u=true;_function:while(u){var s=y,A=x,r=w;t=z=v=undefined;u=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;w=r;u=true;continue _function}}else{if("value" in t){return t.value}else{var v=t.get;if(v===undefined){return undefined}return v.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var h=d(6);var q=p(h);var c=d(73);var l=p(c);var b=d(99);var m=p(b);var n=(function(v){function u(A,z){j(this,u);k(Object.getPrototypeOf(u.prototype),"constructor",this).call(this);this._kit=A;this._options=z;this._options.ui=this._options.ui||{};this._operations=[];this._helpers=new m["default"](this.kit,this,z);this.selectOperations(null)}o(u,v);g(u,[{key:"run",value:function x(){this._attach()}},{key:"_attach",value:function t(){if(this._options.container===null){throw new Error("BaseUI#attach: No container set.")}var z=this._render();this._options.container.innerHTML=z;this._options.container.style.position="relative"}},{key:"_render",value:function y(){if(typeof this._template==="undefined"){throw new Error("BaseUI#_render: No template set.")}return this._template(this.context)}},{key:"selectOperations",value:function w(z){var C=this._kit.registeredOperations;var B=Object.keys(C);var A=q["default"].select(B,z);this._operations=A.map(function(D){return C[D]})}},{key:"addOperation",value:function r(z){this._operations.push(z)}},{key:"isOperationSelected",value:function s(z){var A=this._operations.map(function(B){return B.prototype.identifier});return A.indexOf(z)!==-1}},{key:"identifier",get:function(){return null}},{key:"context",get:function(){return{operations:this._operations,helpers:this._helpers,options:this._options}}},{key:"container",get:function(){return this._options.container}},{key:"operations",get:function(){return this._operations}},{key:"options",get:function(){return this._options}},{key:"canvas",get:function(){return this._canvas}},{key:"helpers",get:function(){return this._helpers}},{key:"image",get:function(){return this._options.image}}]);return u})(l["default"]);i["default"]=n;e.exports=i["default"]},function(d,u,g){Object.defineProperty(u,"__esModule",{value:true});var q=(function(){function v(z,x){for(var w=0;w<x.length;w++){var y=x[w];y.enumerable=y.enumerable||false;y.configurable=true;if("value" in y){y.writable=true}Object.defineProperty(z,y.key,y)}}return function(y,w,x){if(w){v(y.prototype,w)}if(x){v(y,x)}return y}})();var b=function t(C,z,y){var A=true;_function:while(A){var w=C,E=z,v=y;x=D=B=undefined;A=false;var x=Object.getOwnPropertyDescriptor(w,E);if(x===undefined){var D=Object.getPrototypeOf(w);if(D===null){return undefined}else{C=D;z=E;y=v;A=true;continue _function}}else{if("value" in x){return x.value}else{var B=x.get;if(B===undefined){return undefined}return B.call(v)}}}};function c(v){return v&&v.__esModule?v:{"default":v}}function i(v,w){if(!(v instanceof w)){throw new TypeError("Cannot call a class as a function")}}function p(w,v){if(typeof v!=="function"&&v!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof v)}w.prototype=Object.create(v&&v.prototype,{constructor:{value:w,enumerable:false,writable:true,configurable:true}});if(v){w.__proto__=v}}var l=g(56);var h=c(l);var s=g(55);var j=c(s);var n=g(50);var e=c(n);var r=g(73);var k=c(r);var m=g(58);var f=c(m);var o=(function(P){function M(X,Y,W){i(this,M);b(Object.getPrototypeOf(M.prototype),"constructor",this).call(this);this._kit=X;this._ui=Y;this._options=W;var V=this._ui.container;this._canvasContainer=V.querySelector(".imglykit-canvas-container");this._canvasInnerContainer=V.querySelector(".imglykit-canvas-inner-container");this._canvas=this._canvasContainer.querySelector("canvas");this._image=this._options.image;this._roundZoomBy=0.1;this._isFirstRender=true;this._dragOnMousedown=this._dragOnMousedown.bind(this);this._dragOnMousemove=this._dragOnMousemove.bind(this);this._dragOnMouseup=this._dragOnMouseup.bind(this)}p(M,P);q(M,[{key:"run",value:function K(){this._initRenderer();this._zoomLevel=this._getInitialZoomLevel();this._initialZoomLevel=this._zoomLevel;this._isInitialZoom=true;this._size=null;this.render();this._centerCanvas();this._handleDrag()}},{key:"render",value:function U(){var ab=this;this._initialZoomLevel=this._getInitialZoomLevel();if(this._isInitialZoom){this.setZoomLevel(this._initialZoomLevel,false)}var Z=new e["default"](this._image.width,this._image.height);var aa=Z.multiply(this._zoomLevel);this._setCanvasSize(aa);this._renderer.reset();var V=this.sanitizedStack;this._updateStackDirtyStates(V);var Y=[];for(var X=0;X<V.length;X++){var W=V[X];Y.push(W.validateSettings())}return f["default"].all(Y).then(function(){if(ab._isFirstRender&&ab._renderer.identifier==="webgl"){if(ab._image.width>ab._renderer.maxTextureSize||ab._image.height>ab._renderer.maxTextureSize){ab._ui.displayLoadingMessage("Resizing...");return new f["default"](function(ad,ac){setTimeout(function(){ab._renderer.prepareImage(ab._image).then(function(ae){ab._ui.hideLoadingMessage();ab._options.image=ae;ab._image=ab._options.image;ad()})["catch"](function(ae){ac(ae)})},100)})}}}).then(function(){if(ab._isFirstRender||ab._renderer.constructor.identifier==="canvas"){ab._isFirstRender=false;return ab._renderer.drawImage(ab._image)}}).then(function(){var ae=[];for(var ad=0;ad<V.length;ad++){var ac=V[ad];ae.push(ac.render(ab._renderer))}return f["default"].all(ae)}).then(function(){return ab._renderer.renderFinal()}).then(function(){ab._storeCanvasSize();ab._updateContainerSize();ab._updateCanvasMargins();ab._applyBoundaries()})["catch"](function(ac){console.log(ac)})}},{key:"setImage",value:function v(V){this._image=V;this.reset();this.render();this._centerCanvas()}},{key:"zoomIn",value:function Q(){this._isInitialZoom=false;var W=Math.round(this._zoomLevel*100);var V=Math.round(this._roundZoomBy*100);var X=Math.round(this._initialZoomLevel*100);if(W%V!==0){W=Math.ceil(W/V)*V}else{W+=V}W=Math.min(X*2,W);return this.setZoomLevel(W/100)}},{key:"zoomOut",value:function J(){this._isInitialZoom=false;var W=Math.round(this._zoomLevel*100);var V=Math.round(this._roundZoomBy*100);var X=Math.round(this._initialZoomLevel*100);if(W%V!==0){W=Math.floor(W/V)*V}else{W-=V}W=Math.max(X,W);return this.setZoomLevel(W/100)}},{key:"_setCanvasSize",value:function y(V){V=V||new e["default"](this._canvas.width,this._canvas.height);this._canvas.width=V.x;this._canvas.height=V.y;this._storeCanvasSize();this._updateContainerSize()}},{key:"_updateContainerSize",value:function C(){var V=this._size;this._canvasInnerContainer.style.width=""+V.x+"px";this._canvasInnerContainer.style.height=""+V.y+"px"}},{key:"_storeCanvasSize",value:function x(){this._size=new e["default"](this._canvas.width,this._canvas.height)}},{key:"_centerCanvas",value:function G(){var V=this._maxSize.divide(2);this._canvasInnerContainer.style.left=""+V.x+"px";this._canvasInnerContainer.style.top=""+V.y+"px";this._updateCanvasMargins()}},{key:"_updateCanvasMargins",value:function R(){var V=new e["default"](this._canvas.width,this._canvas.height);var W=V.divide(2).multiply(-1);this._canvasInnerContainer.style.marginLeft=""+W.x+"px";this._canvasInnerContainer.style.marginTop=""+W.y+"px"}},{key:"setZoomLevel",value:function F(X){var W=this;var V=arguments[1]===undefined?true:arguments[1];this._zoomLevel=X;if(V){this.setAllOperationsToDirty();return this.render().then(function(){W._updateCanvasMargins();W._applyBoundaries();W.emit("zoom")})}else{this._updateCanvasMargins();this._applyBoundaries();this.emit("zoom")}}},{key:"setAllOperationsToDirty",value:function H(){var X=this._kit.operationsStack;for(var W=0;W<X.length;W++){var V=X[W];if(!V){continue}V.dirty=true}}},{key:"_getInitialZoomLevel",value:function E(){var aa=new e["default"](this._image.width,this._image.height);var Y=this._ui.operations.crop;var X=this._ui.operations.rotation;var W=undefined,V=undefined,ac=undefined,ab=undefined;if(Y){W=Y.getEnd().clone().subtract(Y.getStart())}else{W=new e["default"](1,1)}V=aa.clone().multiply(W);if(X&&X.getDegrees()%180!==0){var Z=V.x;V.x=V.y;V.y=Z}ac=this._resizeVectorToFit(V);if(X&&X.getDegrees()%180!==0){var Z=ac.x;ac.x=ac.y;ac.y=Z}ab=ac.clone().divide(W);return ab.x/aa.x}},{key:"_resizeVectorToFit",value:function N(W){var Y=this._maxSize;var X=Math.min(Y.x/W.x,Y.y/W.y);var V=W.clone().multiply(X);return V}},{key:"_initRenderer",value:function T(){var V=this;if(h["default"].isSupported()&&this._options.renderer!=="canvas"){this._renderer=new h["default"](null,this._canvas);this._webglEnabled=true}else{if(j["default"].isSupported()){this._renderer=new j["default"](null,this._canvas);this._webglEnabled=false}}if(this._renderer===null){throw new Error("Neither Canvas nor WebGL renderer are supported.")}this._renderer.on("new-canvas",function(W){V._setCanvas(W)})}},{key:"_setCanvas",value:function B(V){var W=this._canvas.parentNode;W.removeChild(this._canvas);this._canvas=V;W.appendChild(this._canvas);this._updateCanvasMargins();this._applyBoundaries();this._updateContainerSize()}},{key:"_handleDrag",value:function L(){this._canvas.addEventListener("mousedown",this._dragOnMousedown);this._canvas.addEventListener("touchstart",this._dragOnMousedown)}},{key:"_dragOnMousedown",value:function D(Y){if(Y.type==="mousedown"&&Y.button!==0){return}Y.preventDefault();var V=Y.pageX,Z=Y.pageY;if(Y.type==="touchstart"){V=Y.touches[0].pageX;Z=Y.touches[0].pageY}var X=parseInt(this._canvasInnerContainer.style.left,10);var W=parseInt(this._canvasInnerContainer.style.top,10);document.addEventListener("mousemove",this._dragOnMousemove);document.addEventListener("touchmove",this._dragOnMousemove);document.addEventListener("mouseup",this._dragOnMouseup);document.addEventListener("touchend",this._dragOnMouseup);this._initialMousePosition=new e["default"](V,Z);this._initialCanvasPosition=new e["default"](X,W)}},{key:"_dragOnMousemove",value:function I(Y){Y.preventDefault();var V=Y.pageX,aa=Y.pageY;if(Y.type==="touchmove"){V=Y.touches[0].pageX;aa=Y.touches[0].pageY}var X=new e["default"](V,aa);var Z=X.clone().subtract(this._initialMousePosition);var W=this._initialCanvasPosition.clone().add(Z);this._canvasInnerContainer.style.left=""+W.x+"px";this._canvasInnerContainer.style.top=""+W.y+"px";this._applyBoundaries()}},{key:"_applyBoundaries",value:function A(){var V=parseInt(this._canvasInnerContainer.style.left,10);var Y=parseInt(this._canvasInnerContainer.style.top,10);var X=new e["default"](V,Y);var W=this._boundaries;X.x=Math.min(W.max.x,Math.max(W.min.x,X.x));X.y=Math.min(W.max.y,Math.max(W.min.y,X.y));this._canvasInnerContainer.style.left=""+X.x+"px";this._canvasInnerContainer.style.top=""+X.y+"px"}},{key:"_dragOnMouseup",value:function w(V){V.preventDefault();document.removeEventListener("mousemove",this._dragOnMousemove);document.removeEventListener("touchmove",this._dragOnMousemove);document.removeEventListener("mouseup",this._dragOnMouseup);document.removeEventListener("touchend",this._dragOnMouseup)}},{key:"_updateStackDirtyStates",value:function z(V){var X=false;for(var Y=0;Y<V.length;Y++){var W=V[Y];if(!W){continue}if(W.dirty){X=true}if(X){W.dirty=true}}}},{key:"zoomToFit",value:function O(){var V=arguments[0]===undefined?true:arguments[0];var W=this._getInitialZoomLevel();return this.setZoomLevel(W,V)}},{key:"reset",value:function S(){this._renderer.reset(true);this._kit.operationsStack=[];this._isFirstRender=true}},{key:"_boundaries",get:function(){var V=new e["default"](this._canvas.width,this._canvas.height);var Z=this._maxSize;var X=V.clone().subtract(Z).multiply(-1);var W={min:new e["default"](X.x,X.y),max:new e["default"](0,0)};if(V.x<Z.x){W.min.x=X.x/2;W.max.x=X.x/2}if(V.y<Z.y){W.min.y=X.y/2;W.max.y=X.y/2}var Y=V.clone().divide(2);W.min.add(Y);W.max.add(Y);return W}},{key:"_maxSize",get:function(){var W=window.getComputedStyle(this._canvasContainer);var X=new e["default"](this._canvasContainer.offsetWidth,this._canvasContainer.offsetHeight);var Z=parseInt(W.getPropertyValue("padding-left"),10);Z+=parseInt(W.getPropertyValue("padding-right"),10);var Y=parseInt(W.getPropertyValue("padding-top"),10);Y+=parseInt(W.getPropertyValue("padding-bottom"),10);X.x-=Z;X.y-=Y;var V=this._ui._controlsContainer.offsetHeight;X.y-=V;return X}},{key:"sanitizedStack",get:function(){var X=[];for(var W=0;W<this._kit.operationsStack.length;W++){var V=this._kit.operationsStack[W];if(!V){continue}X.push(V)}return X}},{key:"zoomLevel",get:function(){return this._zoomLevel}},{key:"size",get:function(){return this._size}}]);return M})(k["default"]);u["default"]=o;d.exports=u["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var b=c(73);var k=m(b);var j=(function(n){function v(z,A){h(this,v);i(Object.getPrototypeOf(v.prototype),"constructor",this).call(this);this._kit=z;this._ui=A;this._dragCounter=0;this._container=this._ui.container.querySelector(".imglykit-drop-area-container");this._onDropAreaDragEnter=this._onDropAreaDragEnter.bind(this);this._onDropAreaDragOver=this._onDropAreaDragOver.bind(this);this._onDropAreaDragLeave=this._onDropAreaDragLeave.bind(this);this._onDropAreaDrop=this._onDropAreaDrop.bind(this);this._onDropAreaClick=this._onDropAreaClick.bind(this);this._onFileInputChange=this._onFileInputChange.bind(this);this._hiddenInputField=this._ui.container.querySelector(".imglykit-drop-area .imglykit-drop-area-hidden-input");this._hiddenInputField.addEventListener("change",this._onFileInputChange);this._handleDropArea();if(this._ui.options.image){this.removeDOM()}}l(v,n);f(v,[{key:"openFileDialog",value:function x(){this._hiddenInputField.click()}},{key:"_handleDropArea",value:function u(){var z=this._ui.container;this._dropArea=z.querySelector(".imglykit-drop-area");this._dropArea.addEventListener("dragenter",this._onDropAreaDragEnter);this._dropArea.addEventListener("dragover",this._onDropAreaDragOver);this._dropArea.addEventListener("dragleave",this._onDropAreaDragLeave);this._dropArea.addEventListener("drop",this._onDropAreaDrop);this._dropArea.addEventListener("dragdrop",this._onDropAreaDrop);this._dropArea.addEventListener("click",this._onDropAreaClick)}},{key:"_onDropAreaClick",value:function s(){this.openFileDialog()}},{key:"_onDropAreaDragEnter",value:function y(z){z.preventDefault();this._dragCounter++;this._dropArea.classList.add("imglykit-drop-area-active")}},{key:"_onDropAreaDragOver",value:function o(z){z.preventDefault()}},{key:"_onDropAreaDragLeave",value:function q(z){z.preventDefault();this._dragCounter--;if(this._dragCounter===0){this._dropArea.classList.remove("imglykit-drop-area-active")}}},{key:"_onDropAreaDrop",value:function t(z){z.stopPropagation();z.preventDefault();z.returnValue=false;this._dropArea.classList.remove("imglykit-drop-area-active");if(!z.dataTransfer){return}this._handleFile(z.dataTransfer.files[0])}},{key:"_onFileInputChange",value:function p(){this._handleFile(this._hiddenInputField.files[0])}},{key:"_handleFile",value:function r(z){this.emit("file",z)}},{key:"removeDOM",value:function w(){this._dropArea.removeEventListener("dragenter",this._onDropAreaDragEnter);this._dropArea.removeEventListener("dragover",this._onDropAreaDragOver);this._dropArea.removeEventListener("dragleave",this._onDropAreaDragLeave);this._dropArea.removeEventListener("drop",this._onDropAreaDrop);this._dropArea.removeEventListener("dragdrop",this._onDropAreaDrop);this._dropArea.removeEventListener("click",this._onDropAreaClick);if(this._container){this._container.style.display="none"}}}]);return v})(k["default"]);g["default"]=j;d.exports=g["default"]},function(d,g,c){Object.defineProperty(g,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();var i=function e(u,t,s){var q=true;_function:while(q){var o=u,w=t,n=s;p=v=r=undefined;q=false;var p=Object.getOwnPropertyDescriptor(o,w);if(p===undefined){var v=Object.getPrototypeOf(o);if(v===null){return undefined}else{u=v;t=w;s=n;q=true;continue _function}}else{if("value" in p){return p.value}else{var r=p.get;if(r===undefined){return undefined}return r.call(n)}}}};function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var b=c(73);var j=m(b);var k=(function(A){function o(F,G){h(this,o);i(Object.getPrototypeOf(o.prototype),"constructor",this).call(this);this._kit=F;this._ui=G;this.init()}l(o,A);f(o,[{key:"init",value:function B(){this._canvas=this._ui.canvas}},{key:"run",value:function u(){var F=this._ui.container;this._rightControls=F.querySelector(".imglykit-top-controls-right");this._leftControls=F.querySelector(".imglykit-top-controls-left");this._undoButton=F.querySelector(".imglykit-undo");this._zoomIn=F.querySelector(".imglykit-zoom-in");this._zoomOut=F.querySelector(".imglykit-zoom-out");this._zoomLevel=F.querySelector(".imglykit-zoom-level-num");this._newButton=F.querySelector(".imglykit-new");this._exportButton=F.querySelector(".imglykit-export");this._handleZoom();this._handleUndo();this._handleNew();this._handleExport()}},{key:"_handleZoom",value:function D(){this._zoomIn.addEventListener("click",this._onZoomInClick.bind(this));this._zoomOut.addEventListener("click",this._onZoomOutClick.bind(this))}},{key:"_handleUndo",value:function C(){this._undoButton.addEventListener("click",this._undo.bind(this));this._undo()}},{key:"_handleNew",value:function w(){if(!this._newButton){return}this._newButton.addEventListener("click",this._onNewClick.bind(this))}},{key:"_handleExport",value:function p(){if(!this._exportButton){return}this._exportButton.addEventListener("click",this._onExportClick.bind(this))}},{key:"_onNewClick",value:function y(G){G.preventDefault();var F=this._ui.fileLoader;F.openFileDialog()}},{key:"_onExportClick",value:function n(F){F.preventDefault();this.emit("export")}},{key:"_undo",value:function v(){this.emit("undo")}},{key:"updateUndoButton",value:function s(){var F=this._ui.history;if(F.length===0){this._undoButton.style.display="none"}else{this._undoButton.style.display="inline-block"}}},{key:"updateExportButton",value:function q(){if(!this._exportButton){return}var F=this._ui.image;if(F){this._exportButton.style.display="inline-block"}else{this._exportButton.style.display="none"}}},{key:"_onZoomInClick",value:function x(F){F.preventDefault();this.emit("zoom-in");this.updateZoomLevel()}},{key:"_onZoomOutClick",value:function r(F){F.preventDefault();this.emit("zoom-out");this.updateZoomLevel()}},{key:"showZoom",value:function t(){this._rightControls.style.display="inline-block"}},{key:"hideZoom",value:function E(){this._rightControls.style.display="none"}},{key:"updateZoomLevel",value:function z(){var F=this._canvas.zoomLevel;this._zoomLevel.innerHTML=Math.round(F*100)}}]);return o})(j["default"]);g["default"]=k;d.exports=g["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function l(n){return n&&n.__esModule?n:{"default":n}}function j(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}var g=c(6);var m=l(g);var h=c(50);var k=l(h);var e=18;var b=(function(){function o(C){j(this,o);this._container=C;this._isDragging=false;this._isHovering=false;this._appendDOM();this._resizeButton();this._updateValues();this._onButtonDown=this._onButtonDown.bind(this);this._onButtonMove=this._onButtonMove.bind(this);this._onButtonUp=this._onButtonUp.bind(this);this._onContainerEnter=this._onContainerEnter.bind(this);this._onContainerLeave=this._onContainerLeave.bind(this);this._onBackgroundClick=this._onBackgroundClick.bind(this);this._container.addEventListener("mouseenter",this._onContainerEnter);this._container.addEventListener("mouseleave",this._onContainerLeave);this._container.addEventListener("mousemove",this._onContainerEnter);this._dom.button.addEventListener("mousedown",this._onButtonDown);this._dom.button.addEventListener("touchstart",this._onButtonDown);this._dom.background.addEventListener("click",this._onBackgroundClick);this._list.addEventListener("scroll",this._onListScroll.bind(this));this._onListScroll()}f(o,[{key:"_onBackgroundClick",value:function A(E){E.preventDefault();if(E.target!==this._dom.background){return}var C=m["default"].getEventPosition(E);var F=this._dom.background.getBoundingClientRect();F=new k["default"](F.left,F.top);var D=C.clone().subtract(F);D.x-=this._values.button.width*0.5;this._setButtonPosition(D.x)}},{key:"_onContainerEnter",value:function u(){this._isHovering=true;this.show()}},{key:"_onContainerLeave",value:function x(){this._isHovering=false;this.hide()}},{key:"show",value:function y(){if(!this._isScrollingNecessary){return}this._dom.background.classList.add("visible")}},{key:"hide",value:function v(){if(this._isDragging){return}this._dom.background.classList.remove("visible")}},{key:"_updateValues",value:function r(){this._values={list:{totalWidth:this._list.scrollWidth,visibleWidth:this._list.offsetWidth,scrollableWidth:this._list.scrollWidth-this._list.offsetWidth},button:{width:this._dom.button.offsetWidth,scrollableWidth:this._dom.background.offsetWidth-this._dom.button.offsetWidth}}}},{key:"_onButtonDown",value:function B(C){C.preventDefault();this._isDragging=true;this._initialMousePosition=m["default"].getEventPosition(C);this._initialButtonPosition=this._buttonPosition||0;document.addEventListener("mousemove",this._onButtonMove);document.addEventListener("touchmove",this._onButtonMove);document.addEventListener("mouseup",this._onButtonUp);document.addEventListener("touchend",this._onButtonUp)}},{key:"_onButtonMove",value:function s(C){C.preventDefault();var F=m["default"].getEventPosition(C);var D=F.clone().subtract(this._initialMousePosition);var E=this._initialButtonPosition+D.x;this._setButtonPosition(E)}},{key:"_setButtonPosition",value:function q(E){E=Math.max(0,E);E=Math.min(E,this._values.button.scrollableWidth);this._buttonPosition=E;this._dom.button.style.left=""+this._buttonPosition+"px";var D=E/this._values.button.scrollableWidth;var C=this._values.list.scrollableWidth*D;this._list.scrollLeft=C}},{key:"_onButtonUp",value:function n(){this._isDragging=false;document.removeEventListener("mousemove",this._onButtonMove);document.removeEventListener("touchmove",this._onButtonMove);document.removeEventListener("mouseup",this._onButtonUp);document.removeEventListener("touchend",this._onButtonUp)}},{key:"_onListScroll",value:function p(){if(this._isDragging){return}var F=this._list.scrollWidth-this._list.offsetWidth;var C=this._list.scrollLeft;var E=this._dom.background.offsetWidth-this._dom.button.offsetWidth;var D=C/F;this._buttonPosition=E*D;this._dom.button.style.left=""+this._buttonPosition+"px"}},{key:"_resizeButton",value:function w(){var C=this._list.scrollWidth;var D=this._list.offsetWidth;this._buttonWidth=D/C*D;this._dom.button.style.width=""+this._buttonWidth+"px"}},{key:"_appendDOM",value:function z(){var E=document.createElement("div");E.classList.add("imglykit-scrollbar-background");E.style.bottom=""+e+"px";var D=document.createElement("div");D.classList.add("imglykit-scrollbar-button");E.appendChild(D);this._container.appendChild(E);this._container.style.position="relative";this._list=this._container.querySelector(".imglykit-controls-list");this._dom={background:E,button:D};this._list.style.height="";var C=this._list.offsetHeight;C+=e;this._container.style.height=""+C+"px";this._list.style.height=""+C+"px"}},{key:"remove",value:function t(){this._dom.button.removeEventListener("mousedown",this._onButtonDown);this._dom.button.removeEventListener("touchstart",this._onButtonDown);this._dom.background.parentNode.removeChild(this._dom.background)}},{key:"_isScrollingNecessary",get:function(){return this._list.scrollWidth>this._list.offsetWidth}}]);return o})();i["default"]=b;d.exports=i["default"]},function(c,i,b){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function n(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var h=b(93);var l=n(h);var g=b(6);var o=n(g);var e=(function(p){function s(){j(this,s);if(p!=null){p.apply(this,arguments)}}m(s,p);f(s,[{key:"init",value:function z(){var A=function(G){var E='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';for(var D in G.filters){E+=" ";var F=G.filters[D];E+=" ";var C=F.prototype.name;E+=" ";var B=G.activeFilter.identifier===D;E+=' <li data-identifier="'+(D)+'" class="imglykit-controls-item-with-label';if(B){E+=" imglykit-controls-item-active"}E+='"> <img src="'+(G.helpers.assetPath("ui/night/filters/"+D+".png"))+'" /> <div class="imglykit-controls-item-label">'+(C)+"</div> </li> "}E+=" </ul></div>";return E};this._controlsTemplate=A;this._availableFilters={};this._filters={};this._addDefaultFilters();this.selectFilters(null)}},{key:"_renderAllControls",value:function w(){for(var A=arguments.length,B=Array(A),C=0;C<A;C++){B[C]=arguments[C]}this._operationExistedBefore=!!this._ui.operations.filters;this._operation=this._ui.getOrCreateOperation("filters");k(Object.getPrototypeOf(s.prototype),"_renderAllControls",this).apply(this,B)}},{key:"_onEnter",value:function t(){var D=this;this._initialFilter=this._operation.getFilter();this._defaultFilter=this._operation.availableOptions.filter["default"];var B=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(B);var C=function(E){var F=D._listItems[E];F.addEventListener("click",function(){D._onListItemClick(F)})};for(var A=0;A<this._listItems.length;A++){C(A)}}},{key:"_onBack",value:function x(){var A=this._operation.getFilter();if(A!==this._initialFilter){this._ui.addHistory(this._operation,{filter:this._initialFilter},this._operationExistedBefore)}if(A===this._defaultFilter){this._ui.removeOperation("filters")}this._ui.canvas.render()}},{key:"_onListItemClick",value:function u(B){this._deactivateAllItems();var A=B.dataset.identifier;this._operation.setFilter(this._filters[A]);this._ui.canvas.render();B.classList.add("imglykit-controls-item-active")}},{key:"_deactivateAllItems",value:function q(){for(var A=0;A<this._listItems.length;A++){var B=this._listItems[A];B.classList.remove("imglykit-controls-item-active")}}},{key:"_addDefaultFilters",value:function y(){this.addFilter(b(72));this.addFilter(b(34));this.addFilter(b(35));this.addFilter(b(36));this.addFilter(b(37));this.addFilter(b(30));this.addFilter(b(23));this.addFilter(b(42));this.addFilter(b(27));this.addFilter(b(31));this.addFilter(b(28));this.addFilter(b(49));this.addFilter(b(24));this.addFilter(b(25));this.addFilter(b(38));this.addFilter(b(45));this.addFilter(b(44));this.addFilter(b(43));this.addFilter(b(29));this.addFilter(b(32));this.addFilter(b(26));this.addFilter(b(48));this.addFilter(b(41));this.addFilter(b(39));this.addFilter(b(33));this.addFilter(b(40));this.addFilter(b(47));this.addFilter(b(22));this.addFilter(b(46))}},{key:"addFilter",value:function v(A){this._availableFilters[A.identifier]=A}},{key:"selectFilters",value:function r(A){this._filters={};var E=Object.keys(this._availableFilters);var B=o["default"].select(E,A);for(var D=0;D<B.length;D++){var C=B[D];this._filters[C]=this._availableFilters[C]}if(this._active){this._renderControls()}}},{key:"context",get:function(){return{filters:this._filters,activeFilter:this._operation.getFilter()}}}]);return s})(l["default"]);e.prototype.identifier="filters";i["default"]=e;c.exports=i["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var d=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function m(n){return n&&n.__esModule?n:{"default":n}}function h(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var e=b(93);var k=m(e);var f=b(50);var i=m(f);var j=(function(n){function r(){h(this,r);if(n!=null){n.apply(this,arguments)}}l(r,n);d(r,[{key:"init",value:function v(){var w=function(z){var y='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> <li data-degrees="-90"> <img src="'+(z.helpers.assetPath("ui/night/rotation/left.png"))+'" /> </li> <li data-degrees="90"> <img src="'+(z.helpers.assetPath("ui/night/rotation/right.png"))+'" /> </li> </ul></div>';return y};this._controlsTemplate=w;var x=function(z){var y='<div class="imglykit-canvas-crop-container imglykit-canvas-crop-container-hidden"> <div class="imglykit-canvas-crop-top"> <div class="imglykit-canvas-crop-top-left"></div> <div class="imglykit-canvas-crop-top-center"></div> <div class="imglykit-canvas-crop-top-right"></div> </div> <div class="imglykit-canvas-crop-center"> <div class="imglykit-canvas-crop-center-left"></div> <div class="imglykit-canvas-crop-center-center imglykit-canvas-crop-center-center-nomove"> </div> <div class="imglykit-canvas-crop-center-right"></div> </div> <div class="imglykit-canvas-crop-bottom"> <div class="imglykit-canvas-crop-bottom-left"></div> <div class="imglykit-canvas-crop-bottom-center"></div> <div class="imglykit-canvas-crop-bottom-right"></div> </div></div>';return y};this._canvasControlsTemplate=x}},{key:"_onEnter",value:function o(){var A=this;this._operationExistedBefore=!!this._ui.operations.rotation;this._operation=this._ui.getOrCreateOperation("rotation");this._cropOperation=this._ui.operations.crop;this._initialZoomLevel=this._ui.canvas.zoomLevel;this._ui.canvas.zoomToFit(false);if(this._cropOperation){this._initialStart=this._cropOperation.getStart().clone();this._initialEnd=this._cropOperation.getEnd().clone();this._cropOperation.set({start:new i["default"](0,0),end:new i["default"](1,1)})}this._initialDegrees=this._operation.getDegrees();var y=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(y);var z=function(B){var C=A._listItems[B];C.addEventListener("click",function(){A._onListItemClick(C)})};for(var w=0;w<this._listItems.length;w++){z(w)}var x=".imglykit-canvas-crop";this._cropAreas={topLeft:this._canvasControls.querySelector(""+x+"-top-left"),topCenter:this._canvasControls.querySelector(""+x+"-top-center"),centerLeft:this._canvasControls.querySelector(""+x+"-center-left"),centerCenter:this._canvasControls.querySelector(""+x+"-center-center")};this._ui.canvas.render().then(function(){A._showCropContainer();A._updateCropDOM()})}},{key:"_showCropContainer",value:function p(){var w=this._canvasControls.querySelector(".imglykit-canvas-crop-container");w.classList.remove("imglykit-canvas-crop-container-hidden")}},{key:"_onListItemClick",value:function q(x){var w=this;var z=x.dataset.degrees;z=parseInt(z,10);var y=this._operation.getDegrees();this._operation.setDegrees(y+z);this._ui.canvas.zoomToFit().then(function(){w._updateCropDOM()})}},{key:"onZoom",value:function u(){this._updateCropDOM()}},{key:"_updateCropDOM",value:function s(){var x=undefined,z=undefined;if(this._cropOperation){x=this._initialStart.clone();z=this._initialEnd.clone()}else{x=new i["default"](0,0);z=new i["default"](1,1)}var E=this._ui.canvas.size;var C=x.multiply(E);var B=z.multiply(E);var F=B.clone().subtract(C);var A=Math.max(1,C.y);var y=Math.max(1,C.x);var w=Math.max(1,F.x);var D=Math.max(1,F.y);this._cropAreas.topLeft.style.width=""+y+"px";this._cropAreas.topCenter.style.width=""+w+"px";this._cropAreas.topLeft.style.height=""+A+"px";this._cropAreas.centerLeft.style.height=""+D+"px"}},{key:"_onBack",value:function t(){var w=this._operation.getDegrees();if(this._initialDegrees!==w){this._ui.addHistory(this._operation,{degrees:this._initialDegrees},this._operationExistedBefore)}if(w===0){this._ui.removeOperation("rotation")}if(this._cropOperation){this._cropOperation.set({start:this._initialStart,end:this._initialEnd})}this._ui.canvas.render()}}]);return r})(k["default"]);j.prototype.identifier="rotation";g["default"]=j;c.exports=g["default"]},function(c,f,b){Object.defineProperty(f,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function g(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function j(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var e=b(93);var i=k(e);var h=(function(n){function p(){g(this,p);if(n!=null){n.apply(this,arguments)}}j(p,n);d(p,[{key:"init",value:function r(){var s=function(u){var t='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> <li data-direction="horizontal"> <img src="'+(u.helpers.assetPath("ui/night/flip/horizontal.png"))+'" /> </li> <li data-direction="vertical"> <img src="'+(u.helpers.assetPath("ui/night/flip/vertical.png"))+'" /> </li> </ul></div>';return t};this._controlsTemplate=s}},{key:"_onEnter",value:function q(){var v=this;this._operationExistedBefore=!!this._ui.operations.flip;this._operation=this._ui.getOrCreateOperation("flip");this._initialHorizontal=this._operation.getHorizontal();this._initialVertical=this._operation.getVertical();var t=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(t);var u=function(w){var x=v._listItems[w];x.addEventListener("click",function(){v._onListItemClick(x)});var y=x.dataset.direction;if(y==="horizontal"&&v._operation.getHorizontal()){v._toggleItem(x,true)}else{if(y==="vertical"&&v._operation.getVertical()){v._toggleItem(x,true)}}};for(var s=0;s<this._listItems.length;s++){u(s)}}},{key:"_onListItemClick",value:function m(t){var v=t.dataset.direction;var u=false;if(v==="horizontal"){var s=this._operation.getHorizontal();this._operation.setHorizontal(!s);this._ui.canvas.render();u=!s}else{if(v==="vertical"){var w=this._operation.getVertical();this._operation.setVertical(!w);this._ui.canvas.render();u=!w}}this._toggleItem(t,u)}},{key:"_toggleItem",value:function l(t,u){var s="imglykit-controls-item-active";if(u){t.classList.add(s)}else{t.classList.remove(s)}}},{key:"_onBack",value:function o(){var t=this._operation.getVertical();var s=this._operation.getHorizontal();if(this._initialVertical!==t||this._initialHorizontal!==s){this._ui.addHistory(this._operation,{vertical:this._initialVertical,horizontal:this._initialHorizontal},this._operationExistedBefore)}if(!t&&!s){this._ui.removeOperation("flip")}this._ui.canvas.render()}}]);return p})(i["default"]);h.prototype.identifier="flip";f["default"]=h;c.exports=f["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function m(n){return n&&n.__esModule?n:{"default":n}}function j(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var f=b(93);var k=m(f);var i=b(100);var g=m(i);var d=(function(o){function s(){j(this,s);if(o!=null){o.apply(this,arguments)}}l(s,o);e(s,[{key:"init",value:function r(){var t=function(v){var u="<div> "+(v.partials.slider)+"</div>";return u};this._controlsTemplate=t;this._partialTemplates.slider=g["default"].template}},{key:"_onEnter",value:function q(){this._operationExistedBefore=!!this._ui.operations.brightness;this._operation=this._ui.getOrCreateOperation("brightness");var t=this._operation.getBrightness();this._initialBrightness=t;var u=this._controls.querySelector(".imglykit-slider");this._slider=new g["default"](u,{minValue:-1,maxValue:1,defaultValue:t});this._slider.on("update",this._onUpdate.bind(this));this._slider.setValue(this._initialBrightness)}},{key:"_onBack",value:function p(){var t=this._operation.getBrightness();if(this._initialBrightness!==t){this._ui.addHistory(this._operation,{brightness:this._initialBrightness},this._operationExistedBefore)}if(t===1){this._ui.removeOperation("brightness")}this._ui.canvas.render()}},{key:"_onUpdate",value:function n(t){this._operation.setBrightness(t);this._ui.canvas.render()}}]);return s})(k["default"]);d.prototype.identifier="brightness";h["default"]=d;c.exports=h["default"]},function(c,g,b){Object.defineProperty(g,"__esModule",{value:true});var d=(function(){function n(r,p){for(var o=0;o<p.length;o++){var q=p[o];q.enumerable=q.enumerable||false;q.configurable=true;if("value" in q){q.writable=true}Object.defineProperty(r,q.key,q)}}return function(q,o,p){if(o){n(q.prototype,o)}if(p){n(q,p)}return q}})();function m(n){return n&&n.__esModule?n:{"default":n}}function j(n,o){if(!(n instanceof o)){throw new TypeError("Cannot call a class as a function")}}function l(o,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof n)}o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,enumerable:false,writable:true,configurable:true}});if(n){o.__proto__=n}}var e=b(93);var k=m(e);var i=b(100);var f=m(i);var h=(function(p){function n(){j(this,n);if(p!=null){p.apply(this,arguments)}}l(n,p);d(n,[{key:"init",value:function s(){var t=function(v){var u="<div> "+(v.partials.slider)+"</div>";return u};this._controlsTemplate=t;this._partialTemplates.slider=f["default"].template}},{key:"_onEnter",value:function r(){this._operationExistedBefore=!!this._ui.operations.contrast;this._operation=this._ui.getOrCreateOperation("contrast");var t=this._operation.getContrast();this._initialContrast=t;var u=this._controls.querySelector(".imglykit-slider");this._slider=new f["default"](u,{minValue:0,maxValue:2,defaultValue:t});this._slider.on("update",this._onUpdate.bind(this));this._slider.setValue(this._initialContrast)}},{key:"_onBack",value:function q(){var t=this._operation.getContrast();if(this._initialContrast!==t){this._ui.addHistory(this._operation,{contrast:this._initialContrast},this._operationExistedBefore)}if(t===1){this._ui.removeOperation("contrast")}this._ui.canvas.render()}},{key:"_onUpdate",value:function o(t){this._operation.setContrast(t);this._ui.canvas.render()}}]);return n})(k["default"]);h.prototype.identifier="contrast";g["default"]=h;c.exports=g["default"]},function(c,h,b){Object.defineProperty(h,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function d(w,v,u){var s=true;_function:while(s){var q=w,y=v,p=u;r=x=t=undefined;s=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;u=p;s=true;continue _function}}else{if("value" in r){return r.value}else{var t=r.get;if(t===undefined){return undefined}return t.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var i=b(100);var g=o(i);var f=b(93);var l=o(f);var m=(function(q){function s(){j(this,s);if(q!=null){q.apply(this,arguments)}}n(s,q);e(s,[{key:"init",value:function u(){var v=function(x){var w="<div> "+(x.partials.slider)+"</div>";return w};this._controlsTemplate=v;this._partialTemplates.slider=g["default"].template}},{key:"_onEnter",value:function t(){k(Object.getPrototypeOf(s.prototype),"_onEnter",this).call(this);this._operationExistedBefore=!!this._ui.operations.saturation;this._operation=this._ui.getOrCreateOperation("saturation");var v=this._operation.getSaturation();this._initialSaturation=v;var w=this._controls.querySelector(".imglykit-slider");this._slider=new g["default"](w,{minValue:0,maxValue:2,defaultValue:v});this._slider.on("update",this._onUpdate.bind(this));this._slider.setValue(this._initialSaturation)}},{key:"_onBack",value:function r(){var v=this._operation.getSaturation();if(this._initialSaturation!==v){this._ui.addHistory(this._operation,{saturation:this._initialSaturation},this._operationExistedBefore)}if(v===1){this._ui.removeOperation("saturation")}this._ui.canvas.render()}},{key:"_onUpdate",value:function p(v){this._operation.setSaturation(v);this._ui.canvas.render()}}]);return s})(l["default"]);m.prototype.identifier="saturation";h["default"]=m;c.exports=h["default"]},function(c,j,b){Object.defineProperty(j,"__esModule",{value:true});var e=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var l=function d(y,x,u){var v=true;_function:while(v){var s=y,A=x,r=u;t=z=w=undefined;v=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;u=r;v=true;continue _function}}else{if("value" in t){return t.value}else{var w=t.get;if(w===undefined){return undefined}return w.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var h=b(93);var n=p(h);var i=b(50);var m=p(i);var g=b(6);var q=p(g);var f=(function(z){function B(){k(this,B);if(z!=null){z.apply(this,arguments)}}o(B,z);e(B,[{key:"init",value:function E(){this._availableRatios={};this._ratios={};var O=function(U){var S='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';for(var R in U.ratios){S+=" ";var T=U.ratios[R];S+=" ";var Q=T.selected;S+=' <li data-identifier="'+(R)+'" data-ratio="'+(T.ratio)+'"';if(Q){S+=" data-selected"}S+='> <img src="'+(U.helpers.assetPath("ui/night/crop/"+R+".png"))+'" /> </li> '}S+=" </ul></div>"+(U.partials.doneButton);return S};this._controlsTemplate=O;var P=function(R){var Q='<div class="imglykit-canvas-crop-container"> <div class="imglykit-canvas-crop-top"> <div class="imglykit-canvas-crop-top-left"></div> <div class="imglykit-canvas-crop-top-center"></div> <div class="imglykit-canvas-crop-top-right"></div> </div> <div class="imglykit-canvas-crop-center"> <div class="imglykit-canvas-crop-center-left"></div> <div class="imglykit-canvas-crop-center-center"> <div class="imglykit-canvas-crop-knobs"> <div data-corner="top-left"></div> <div data-corner="top-right"></div> <div data-corner="bottom-left"></div> <div data-corner="bottom-right"></div> </div> </div> <div class="imglykit-canvas-crop-center-right"></div> </div> <div class="imglykit-canvas-crop-bottom"> <div class="imglykit-canvas-crop-bottom-left"></div> <div class="imglykit-canvas-crop-bottom-center"></div> <div class="imglykit-canvas-crop-bottom-right"></div> </div></div>';return Q};this._canvasControlsTemplate=P;this._onKnobDown=this._onKnobDown.bind(this);this._onKnobDrag=this._onKnobDrag.bind(this);this._onKnobUp=this._onKnobUp.bind(this);this._onCenterDown=this._onCenterDown.bind(this);this._onCenterDrag=this._onCenterDrag.bind(this);this._onCenterUp=this._onCenterUp.bind(this);this._addDefaultRatios();this.selectRatios(null)}},{key:"selectRatios",value:function K(O){this._ratios={};var P=Object.keys(this._availableRatios);var S=q["default"].select(P,O);for(var R=0;R<S.length;R++){var Q=S[R];this._ratios[Q]=this._availableRatios[Q]}if(this._active){this._renderControls()}}},{key:"_addDefaultRatios",value:function s(){this.addRatio("custom","*",true);this.addRatio("square","1");this.addRatio("4-3","1.33");this.addRatio("16-9","1.77")}},{key:"addRatio",value:function w(O,Q,P){this._availableRatios[O]={ratio:Q,selected:P}}},{key:"_onEnter",value:function I(){var R=this;l(Object.getPrototypeOf(B.prototype),"_onEnter",this).call(this);this._operationExistedBefore=!!this._ui.operations.crop;this._operation=this._ui.getOrCreateOperation("crop");this._defaultStart=new m["default"](0.1,0.1);this._defaultEnd=new m["default"](0.9,0.9);this._initialOptions={start:this._operation.getStart(),end:this._operation.getEnd()};this._start=this._initialOptions.start||this._defaultStart;this._end=this._initialOptions.end||this._defaultEnd;this._minimumSize=new m["default"](50,50);this._initialZoomLevel=this._ui.canvas.zoomLevel;this._ui.canvas.zoomToFit(false);var Q=".imglykit-canvas-crop";var O=this._canvasControls;var P=O.querySelector(""+Q+"-knobs");this._initialStart=this._operation.getStart().clone();this._initialEnd=this._operation.getEnd().clone();this._operation.set({start:new m["default"](0,0),end:new m["default"](1,1)});this._knobs={topLeft:P.querySelector("[data-corner=top-left]"),topRight:P.querySelector("[data-corner=top-right]"),bottomLeft:P.querySelector("[data-corner=bottom-left]"),bottomRight:P.querySelector("[data-corner=bottom-right]")};this._areas={topLeft:this._canvasControls.querySelector(""+Q+"-top-left"),topCenter:this._canvasControls.querySelector(""+Q+"-top-center"),centerLeft:this._canvasControls.querySelector(""+Q+"-center-left"),centerCenter:this._canvasControls.querySelector(""+Q+"-center-center")};this._handleControls();this._handleKnobs();this._handleCenter();this._ui.canvas.render().then(function(){R._updateDOM()})}},{key:"_handleControls",value:function A(){var P=this;var Q=this._controls.querySelectorAll("ul > li");this._ratioItems=Array.prototype.slice.call(Q);var R=function(T){var W=P._ratioItems[T];var X=W.dataset;var V=X.selected;var U=X.ratio;var S=X.identifier;if(typeof V!=="undefined"&&!P._operationExistedBefore){P._setRatio(S,U,false);P._selectRatio(W)}W.addEventListener("click",function(Y){Y.preventDefault();P._onRatioClick(W)})};for(var O=0;O<this._ratioItems.length;O++){R(O)}}},{key:"_onRatioClick",value:function L(O){this._unselectAllRatios();this._selectRatio(O)}},{key:"_unselectAllRatios",value:function J(){for(var O=0;O<this._ratioItems.length;O++){var P=this._ratioItems[O];P.classList.remove("imglykit-controls-item-active")}}},{key:"_selectRatio",value:function r(R){R.classList.add("imglykit-controls-item-active");var Q=R.dataset;var P=Q.ratio;var O=Q.identifier;this._setRatio(O,P)}},{key:"_setRatio",value:function N(R,T){var Q=arguments[2]===undefined?true:arguments[2];var P=this._ui.canvas.size;this._selectedRatio=R;if(T==="*"){this._ratio=null;this._start=new m["default"](0.1,0.1);this._end=new m["default"](0.9,0.9)}else{if(T==="original"){this._ratio=P.x/P.y}else{T=parseFloat(T);this._ratio=T}if(Q){if(P.x/P.y<=this._ratio){this._start.x=0.1;this._end.x=0.9;var O=1/P.y*(P.x/this._ratio*0.8);this._start.y=(1-O)/2;this._end.y=1-this._start.y}else{this._start.y=0.1;this._end.y=0.9;var S=1/P.x*(this._ratio*P.y*0.8);this._start.x=(1-S)/2;this._end.x=1-this._start.x}}}this._updateDOM()}},{key:"_updateDOM",value:function M(){var P=this._ui.canvas.size;var R=this._start.clone().multiply(P);var T=this._end.clone().multiply(P);var Q=T.clone().subtract(R);var V=Math.max(1,R.y);var U=Math.max(1,R.x);var S=Math.max(1,Q.x);var O=Math.max(1,Q.y);this._areas.topLeft.style.width=""+U+"px";this._areas.topCenter.style.width=""+S+"px";this._areas.topLeft.style.height=""+V+"px";this._areas.centerLeft.style.height=""+O+"px"}},{key:"_handleKnobs",value:function v(){var P=this;var Q=function(S){var R=P._knobs[S];R.addEventListener("mousedown",function(T){P._onKnobDown(T,R)});R.addEventListener("touchstart",function(T){P._onKnobDown(T,R)})};for(var O in this._knobs){Q(O)}}},{key:"_onKnobDown",value:function H(P,O){P.preventDefault();P.stopPropagation();this._currentKnob=O;this._initialMousePosition=q["default"].getEventPosition(P);this._startBeforeDrag=this._start.clone();this._endBeforeDrag=this._end.clone();document.addEventListener("mousemove",this._onKnobDrag);document.addEventListener("touchmove",this._onKnobDrag);document.addEventListener("mouseup",this._onKnobUp);document.addEventListener("touchend",this._onKnobUp)}},{key:"_onKnobDrag",value:function u(S){S.preventDefault();var X=q["default"].getEventPosition(S);var R=X.subtract(this._initialMousePosition);var V=this._currentKnob.dataset.corner;var Y=this._ui.canvas.size;var U=this._startBeforeDrag.clone().multiply(Y);var P=this._endBeforeDrag.clone().multiply(Y);var O=undefined,W=undefined,Q=undefined,T=undefined;switch(V){case"top-left":U.add(R);Q=P.clone().subtract(this._minimumSize);U.clamp(null,Q);break;case"top-right":P.x+=R.x;U.y+=R.y;P.x=Math.max(U.x+this._minimumSize.x,P.x);U.y=Math.min(P.y-this._minimumSize.y,U.y);break;case"bottom-right":P.add(R);T=U.clone().add(this._minimumSize);P.clamp(T);break;case"bottom-left":U.x+=R.x;P.y+=R.y;U.x=Math.min(P.x-this._minimumSize.x,U.x);P.y=Math.max(U.y+this._minimumSize.y,P.y);break}this._start.copy(U).divide(Y);this._end.copy(P).divide(Y);this._start.clamp(0,1);this._end.clamp(0,1);if(this._ratio!==null){switch(V){case"top-left":O=(this._end.x-this._start.x)*Y.x;W=O/this._ratio;this._start.y=this._end.y-W/Y.y;if(this._start.y<=0){this._start.y=0;W=(this._end.y-this._start.y)*Y.y;O=W*this._ratio;this._start.x=this._end.x-O/Y.x}break;case"top-right":O=(this._end.x-this._start.x)*Y.x;W=O/this._ratio;this._start.y=this._end.y-W/Y.y;if(this._start.y<=0){this._start.y=0;W=(this._end.y-this._start.y)*Y.y;O=W*this._ratio;this._end.x=this._start.x+O/Y.x}break;case"bottom-right":O=(this._end.x-this._start.x)*Y.x;W=O/this._ratio;this._end.y=this._start.y+W/Y.y;if(this._end.y>=1){this._end.y=1;W=(this._end.y-this._start.y)*Y.y;O=W*this._ratio;this._end.x=this._start.x+O/Y.x}break;case"bottom-left":O=(this._end.x-this._start.x)*Y.x;W=O/this._ratio;this._end.y=this._start.y+W/Y.y;if(this._end.y>=1){this._end.y=1;W=(this._end.y-this._start.y)*Y.y;O=W*this._ratio;this._start.x=this._end.x-O/Y.x}break}}this._updateDOM()}},{key:"_onKnobUp",value:function D(){this._currentKnob=null;document.removeEventListener("mousemove",this._onKnobDrag);document.removeEventListener("touchmove",this._onKnobDrag);document.removeEventListener("mouseup",this._onKnobUp);document.removeEventListener("touchend",this._onKnobUp)}},{key:"_handleCenter",value:function x(){this._areas.centerCenter.addEventListener("mousedown",this._onCenterDown);this._areas.centerCenter.addEventListener("touchstart",this._onCenterDown)}},{key:"_onCenterDown",value:function G(O){this._initialMousePosition=q["default"].getEventPosition(O);this._startBeforeDrag=this._start.clone();this._endBeforeDrag=this._end.clone();document.addEventListener("mousemove",this._onCenterDrag);document.addEventListener("touchmove",this._onCenterDrag);document.addEventListener("mouseup",this._onCenterUp);document.addEventListener("touchend",this._onCenterUp)}},{key:"_onCenterDrag",value:function t(R){var V=q["default"].getEventPosition(R);var P=V.subtract(this._initialMousePosition);var W=this._ui.canvas.size;var S=this._endBeforeDrag.clone().subtract(this._startBeforeDrag);var Q=S.clone().multiply(W);var T=this._startBeforeDrag.clone().multiply(W);var O=this._endBeforeDrag.clone().multiply(W);T.add(P);var U=W.clone().subtract(Q);T.clamp(new m["default"](0,0),U);O.copy(T).add(Q);this._start.copy(T).divide(W);this._end.copy(O).divide(W);this._updateDOM()}},{key:"_onCenterUp",value:function y(){document.removeEventListener("mousemove",this._onCenterDrag);document.removeEventListener("touchmove",this._onCenterDrag);document.removeEventListener("mouseup",this._onCenterUp);document.removeEventListener("touchend",this._onCenterUp)}},{key:"_onBack",value:function F(){this._ui.canvas.setZoomLevel(this._initialZoomLevel,false);if(this._operationExistedBefore){this._operation.set({start:this._initialStart,end:this._initialEnd})}else{this._ui.removeOperation("crop")}this._ui.canvas.render()}},{key:"_onDone",value:function C(){this._operation.set({start:this._start,end:this._end});this._ui.canvas.zoomToFit(true);this._ui.addHistory(this._operation,{start:this._initialStart.clone(),end:this._initialEnd.clone()},this._operationExistedBefore)}},{key:"context",get:function(){var O=l(Object.getPrototypeOf(B.prototype),"context",this);O.ratios=this._ratios;return O}},{key:"selectedRatio",get:function(){return this._selectedRatio}}]);return B})(n["default"]);f.prototype.identifier="crop";j["default"]=f;c.exports=j["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var e=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();function p(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var g=c(93);var l=p(g);var h=c(50);var k=p(h);var f=c(6);var q=p(f);var b=c(101);var o=p(b);var m=(function(r){function E(){j(this,E);if(r!=null){r.apply(this,arguments)}}n(E,r);e(E,[{key:"init",value:function G(){var H=function(K){var J='<div class="imglykit-controls-icon"> <img src="'+(K.helpers.assetPath("ui/night/blur/blur.png"))+'" /></div><div> '+(K.partials.slider)+"</div>"+(K.partials.doneButton);return J};this._controlsTemplate=H;var I=function(K){var J='<div class="imglykit-canvas-radial-blur-container"> <div class="imglykit-canvas-radial-blur-dot" id="imglykit-radial-blur-position"></div> <div class="imglykit-canvas-radial-blur-dot" id="imglykit-radial-blur-gradient"></div> <div class="imglykit-canvas-radial-blur-circle-container"> <div class="imglykit-canvas-radial-blur-circle"></div> </div></div>';return J};this._canvasControlsTemplate=I;this._partialTemplates.slider=o["default"].template;this._partialTemplates.slider.additionalContext={id:"imglykit-blur-radius-slider"}}},{key:"_onEnter",value:function x(){var H=this;this._operationExistedBefore=!!this._ui.operations["radial-blur"];this._operation=this._ui.getOrCreateOperation("radial-blur");this._initialSettings={position:this._operation.getPosition().clone(),gradientRadius:this._operation.getGradientRadius(),blurRadius:this._operation.getBlurRadius()};this._onPositionKnobDown=this._onPositionKnobDown.bind(this);this._onPositionKnobDrag=this._onPositionKnobDrag.bind(this);this._onPositionKnobUp=this._onPositionKnobUp.bind(this);this._onGradientKnobDown=this._onGradientKnobDown.bind(this);this._onGradientKnobDrag=this._onGradientKnobDrag.bind(this);this._onGradientKnobUp=this._onGradientKnobUp.bind(this);this._positionKnob=this._canvasControls.querySelector("#imglykit-radial-blur-position");this._gradientKnob=this._canvasControls.querySelector("#imglykit-radial-blur-gradient");this._circle=this._canvasControls.querySelector(".imglykit-canvas-radial-blur-circle");this._handleKnobs();this._initSliders();this._ui.canvas.render().then(function(){H._updateDOM()})}},{key:"_initSliders",value:function B(){var H=this._controls.querySelector("#imglykit-blur-radius-slider");this._blurRadiusSlider=new o["default"](H,{minValue:0,maxValue:40});this._blurRadiusSlider.on("update",this._onBlurRadiusUpdate.bind(this));this._blurRadiusSlider.setValue(this._initialSettings.blurRadius)}},{key:"_onBlurRadiusUpdate",value:function v(H){this._operation.setBlurRadius(H);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_handleKnobs",value:function D(){var I=this._ui.canvas.size;var H=this._operation.getPosition().clone().multiply(I);this._gradientKnobPosition=H.clone().add(this._initialSettings.gradientRadius,0);this._positionKnob.addEventListener("mousedown",this._onPositionKnobDown);this._positionKnob.addEventListener("touchstart",this._onPositionKnobDown);this._gradientKnob.addEventListener("mousedown",this._onGradientKnobDown);this._gradientKnob.addEventListener("touchstart",this._onGradientKnobDown)}},{key:"_onPositionKnobDown",value:function y(I){I.preventDefault();var H=this._ui.canvas.size;this._initialMousePosition=q["default"].getEventPosition(I);this._initialPosition=this._operation.getPosition().clone();this._gradientKnobDistance=this._gradientKnobPosition.clone().subtract(this._initialPosition.clone().multiply(H));document.addEventListener("mousemove",this._onPositionKnobDrag);document.addEventListener("touchmove",this._onPositionKnobDrag);document.addEventListener("mouseup",this._onPositionKnobUp);document.addEventListener("touchend",this._onPositionKnobUp)}},{key:"_onPositionKnobDrag",value:function u(K){K.preventDefault();var H=this._ui.canvas.size;var M=q["default"].getEventPosition(K);var J=M.subtract(this._initialMousePosition);var I=this._initialPosition.clone().multiply(H).add(J);var L=H.clone().subtract(this._gradientKnobDistance);I.clamp(new k["default"](0,0),L);this._gradientKnobPosition.copy(I).add(this._gradientKnobDistance);I.divide(H);this._operation.setPosition(I);this._updateDOM();this._ui.canvas.render()}},{key:"_onPositionKnobUp",value:function A(H){H.preventDefault();document.removeEventListener("mousemove",this._onPositionKnobDrag);document.removeEventListener("touchmove",this._onPositionKnobDrag);document.removeEventListener("mouseup",this._onPositionKnobUp);document.removeEventListener("touchend",this._onPositionKnobUp)}},{key:"_onGradientKnobDown",value:function w(H){H.preventDefault();this._initialMousePosition=q["default"].getEventPosition(H);this._initialGradientKnobPosition=this._gradientKnobPosition.clone();document.addEventListener("mousemove",this._onGradientKnobDrag);document.addEventListener("touchmove",this._onGradientKnobDrag);document.addEventListener("mouseup",this._onGradientKnobUp);document.addEventListener("touchend",this._onGradientKnobUp)}},{key:"_onGradientKnobDrag",value:function F(L){L.preventDefault();var I=this._ui.canvas.size;var N=q["default"].getEventPosition(L);var K=N.subtract(this._initialMousePosition);this._gradientKnobPosition=this._initialGradientKnobPosition.clone().add(K);this._gradientKnobPosition.clamp(new k["default"](0,0),I);var H=this._operation.getPosition().clone().multiply(I);var M=this._gradientKnobPosition.clone().subtract(H);var J=Math.sqrt(Math.pow(M.x,2)+Math.pow(M.y,2));this._operation.setGradientRadius(J);this._updateDOM();this._ui.canvas.render()}},{key:"_onGradientKnobUp",value:function t(H){H.preventDefault();document.removeEventListener("mousemove",this._onGradientKnobDrag);document.removeEventListener("touchmove",this._onGradientKnobDrag);document.removeEventListener("mouseup",this._onGradientKnobUp);document.removeEventListener("touchend",this._onGradientKnobUp)}},{key:"_updateDOM",value:function s(){var I=this._ui.canvas.size;var H=this._operation.getPosition().clone().multiply(I);this._positionKnob.style.left=""+H.x+"px";this._positionKnob.style.top=""+H.y+"px";this._gradientKnob.style.left=""+this._gradientKnobPosition.x+"px";this._gradientKnob.style.top=""+this._gradientKnobPosition.y+"px";var J=this._operation.getGradientRadius()*2;this._circle.style.left=""+H.x+"px";this._circle.style.top=""+H.y+"px";this._circle.style.width=""+J+"px";this._circle.style.height=""+J+"px";this._circle.style.marginLeft="-"+J/2+"px";this._circle.style.marginTop="-"+J/2+"px"}},{key:"_onBack",value:function C(){if(this._operationExistedBefore){this._operation.set(this._initialSettings)}else{this._ui.removeOperation("radial-blur")}this._ui.canvas.render()}},{key:"_onDone",value:function z(){this._ui.addHistory(this._operation,{position:this._initialSettings.position.clone(),gradientRadius:this._initialSettings.gradientRadius,blurRadius:this._initialSettings.blurRadius},this._operationExistedBefore)}}]);return E})(l["default"]);m.prototype.identifier="radial-blur";i["default"]=m;d.exports=i["default"]},function(d,j,c){Object.defineProperty(j,"__esModule",{value:true});var f=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();function p(r){return r&&r.__esModule?r:{"default":r}}function k(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function n(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var h=c(93);var m=p(h);var i=c(50);var l=p(i);var g=c(6);var q=p(g);var b=c(101);var o=p(b);var e=(function(r){function w(){k(this,w);if(r!=null){r.apply(this,arguments)}}n(w,r);f(w,[{key:"init",value:function H(){var I=function(M){var L='<div class="imglykit-controls-icon"> <img src="'+(M.helpers.assetPath("ui/night/blur/blur.png"))+'" /></div><div> ';var K="imglykit-blur-radius-slider";L+=" "+(M.partials.slider)+"</div>"+(M.partials.doneButton);return L};this._controlsTemplate=I;var J=function(L){var K='<div class="imglykit-canvas-tilt-shift-container"> <div class="imglykit-canvas-tilt-shift-dot" data-option="position"></div> <div class="imglykit-canvas-tilt-shift-dot" data-option="gradient"></div> <div class="imglykit-canvas-tilt-shift-rect-container"> <div class="imglykit-canvas-tilt-shift-rect"></div> </div></div>';return K};this._canvasControlsTemplate=J;this._partialTemplates.slider=o["default"].template;this._partialTemplates.slider.additionalContext={id:"imglykit-blur-radius-slider"};this._currentKnob=null}},{key:"_onEnter",value:function y(){var J=this;this._operationExistedBefore=!!this._ui.operations["tilt-shift"];this._operation=this._ui.getOrCreateOperation("tilt-shift");this._initialSettings={start:this._operation.getStart().clone(),end:this._operation.getEnd().clone(),gradientRadius:this._operation.getGradientRadius(),blurRadius:this._operation.getBlurRadius()};this._onPositionKnobDown=this._onPositionKnobDown.bind(this);this._onPositionKnobDrag=this._onPositionKnobDrag.bind(this);this._onPositionKnobUp=this._onPositionKnobUp.bind(this);this._onGradientKnobDown=this._onGradientKnobDown.bind(this);this._onGradientKnobDrag=this._onGradientKnobDrag.bind(this);this._onGradientKnobUp=this._onGradientKnobUp.bind(this);var I=".imglykit-canvas-tilt-shift-dot";this._positionKnob=this._canvasControls.querySelector(""+I+"[data-option='position']");this._gradientKnob=this._canvasControls.querySelector(""+I+"[data-option='gradient']");this._rect=this._canvasControls.querySelector(".imglykit-canvas-tilt-shift-rect");this._initSliders();this._ui.canvas.render().then(function(){J._handleKnobs();J._updateDOM()})}},{key:"_initSliders",value:function D(){var I=this._controls.querySelector("#imglykit-blur-radius-slider");this._blurRadiusSlider=new o["default"](I,{minValue:0,maxValue:40});this._blurRadiusSlider.on("update",this._onBlurRadiusUpdate.bind(this));this._blurRadiusSlider.setValue(this._initialSettings.blurRadius)}},{key:"_onBlurRadiusUpdate",value:function v(I){this._operation.setBlurRadius(I);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_handleKnobs",value:function F(){this._positionKnob.addEventListener("mousedown",this._onPositionKnobDown);this._positionKnob.addEventListener("touchstart",this._onPositionKnobDown);this._gradientKnob.addEventListener("mousedown",this._onGradientKnobDown);this._gradientKnob.addEventListener("touchstart",this._onGradientKnobDown);var P=this._ui.canvas.size;var M=this._initialSettings;var I=M.start;var K=M.end;I=I.clone().multiply(P);K=K.clone().multiply(P);var N=K.clone().subtract(I);var Q=I.clone().add(N.clone().divide(2));var L=Math.sqrt(Math.pow(N.x,2)+Math.pow(N.y,2));var O=N.clone().divide(L).divide(2);this._knobPosition=Q.clone();var J=this._initialSettings.gradientRadius;this._gradientKnobPosition=Q.clone().add(-J*O.y,J*O.x);this._updateStartAndEnd();this._updateDOM();this._ui.canvas.render()}},{key:"_updateStartAndEnd",value:function z(){var I=this._ui.canvas.size;var K=this._gradientKnobPosition.clone().subtract(this._knobPosition);var L=this._knobPosition.clone().add(-K.y,K.x).divide(I);var J=this._knobPosition.clone().add(K.y,-K.x).divide(I);this._operation.set({start:L,end:J})}},{key:"_onPositionKnobDown",value:function A(I){I.preventDefault();this._initialMousePosition=q["default"].getEventPosition(I);this._initialPosition=this._knobPosition.clone();this._initialDistanceToGradientKnob=this._gradientKnobPosition.clone().subtract(this._initialPosition);document.addEventListener("mousemove",this._onPositionKnobDrag);document.addEventListener("touchmove",this._onPositionKnobDrag);document.addEventListener("mouseup",this._onPositionKnobUp);document.addEventListener("touchend",this._onPositionKnobUp)}},{key:"_onPositionKnobDrag",value:function u(L){L.preventDefault();var I=this._ui.canvas.size;var O=q["default"].getEventPosition(L);var K=O.subtract(this._initialMousePosition);var J=this._initialPosition.clone().add(K);this._knobPosition.copy(J);var N=new l["default"]().subtract(this._initialDistanceToGradientKnob);N.clamp(new l["default"](0,0));var M=I.clone().subtract(this._initialDistanceToGradientKnob);M.clamp(null,I);this._knobPosition.clamp(N,M);this._gradientKnobPosition.copy(this._knobPosition).add(this._initialDistanceToGradientKnob);this._updateStartAndEnd();this._updateDOM();this._ui.canvas.render()}},{key:"_onPositionKnobUp",value:function C(I){I.preventDefault();document.removeEventListener("mousemove",this._onPositionKnobDrag);document.removeEventListener("touchmove",this._onPositionKnobDrag);document.removeEventListener("mouseup",this._onPositionKnobUp);document.removeEventListener("touchend",this._onPositionKnobUp)}},{key:"_onGradientKnobDown",value:function x(I){I.preventDefault();this._initialMousePosition=q["default"].getEventPosition(I);this._initialGradientKnobPosition=this._gradientKnobPosition.clone();document.addEventListener("mousemove",this._onGradientKnobDrag);document.addEventListener("touchmove",this._onGradientKnobDrag);document.addEventListener("mouseup",this._onGradientKnobUp);document.addEventListener("touchend",this._onGradientKnobUp)}},{key:"_onGradientKnobDrag",value:function G(K){K.preventDefault();var I=this._ui.canvas.size;var N=q["default"].getEventPosition(K);var J=N.subtract(this._initialMousePosition);this._gradientKnobPosition.copy(this._initialGradientKnobPosition).add(J);this._gradientKnobPosition.clamp(new l["default"](0,0),I);var M=this._gradientKnobPosition.clone().subtract(this._knobPosition);var L=2*Math.sqrt(Math.pow(M.x,2)+Math.pow(M.y,2));this._operation.setGradientRadius(L);this._updateStartAndEnd();this._updateDOM();this._ui.canvas.render()}},{key:"_onGradientKnobUp",value:function t(I){I.preventDefault();document.removeEventListener("mousemove",this._onGradientKnobDrag);document.removeEventListener("touchmove",this._onGradientKnobDrag);document.removeEventListener("mouseup",this._onGradientKnobUp);document.removeEventListener("touchend",this._onGradientKnobUp)}},{key:"_updateDOM",value:function s(){var J=this._knobPosition;this._positionKnob.style.left=""+J.x+"px";this._positionKnob.style.top=""+J.y+"px";var O=this._gradientKnobPosition;this._gradientKnob.style.left=""+O.x+"px";this._gradientKnob.style.top=""+O.y+"px";var I=this._ui.canvas.size;var K=this._operation.getGradientRadius();var L=new l["default"](Math.sqrt(Math.pow(I.x,2)+Math.pow(I.y,2))*2,K);this._rect.style.width=""+L.x+"px";this._rect.style.height=""+L.y+"px";this._rect.style.marginLeft="-"+L.x/2+"px";this._rect.style.marginTop="-"+L.y/2+"px";this._rect.style.left=""+J.x+"px";this._rect.style.top=""+J.y+"px";var N=O.clone().subtract(J);var M=Math.atan2(N.x,N.y)*(180/Math.PI);this._rect.style.transform="rotate("+(-M).toFixed(2)+"deg)"}},{key:"_onBack",value:function E(){if(this._operationExistedBefore){this._operation.set(this._initialSettings)}else{this._ui.removeOperation("tilt-shift")}this._ui.canvas.render()}},{key:"_onDone",value:function B(){this._ui.addHistory(this._operation,{start:this._initialSettings.start.clone(),end:this._initialSettings.end.clone(),blurRadius:this._initialSettings.blurRadius,gradientRadius:this._initialSettings.gradientRadius},this._operationExistedBefore)}}]);return w})(m["default"]);e.prototype.identifier="tilt-shift";j["default"]=e;d.exports=j["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var e=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();function o(p){return p&&p.__esModule?p:{"default":p}}function k(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function m(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var h=c(93);var l=o(h);var b=c(101);var n=o(b);var g=c(102);var j=o(g);var f=(function(t){function r(){k(this,r);if(t!=null){t.apply(this,arguments)}}m(r,t);e(r,[{key:"init",value:function w(){var x=function(z){var y="<div> "+(z.partials.slider)+'</div><div class="imglykit-controls-button"> '+(z.partials.colorPicker)+"</div>"+(z.partials.doneButton);return y};this._controlsTemplate=x;this._partialTemplates.slider=n["default"].template;this._partialTemplates.colorPicker=j["default"].template;this._partialTemplates.colorPicker.additionalContext={label:"Color"}}},{key:"_onEnter",value:function v(){this._operationExistedBefore=!!this._ui.operations.frames;this._operation=this._ui.getOrCreateOperation("frames");this._initialOptions={thickness:this._operation.getThickness(),color:this._operation.getColor()};this._ui.canvas.render();var y=this._controls.querySelector(".imglykit-slider");this._slider=new n["default"](y,{minValue:0,maxValue:0.5});this._slider.on("update",this._onThicknessUpdate.bind(this));this._slider.setValue(this._initialOptions.thickness);var x=this._controls.querySelector(".imglykit-color-picker");this._colorPicker=new j["default"](this._ui,x);this._colorPicker.on("update",this._onColorUpdate.bind(this));this._colorPicker.setValue(this._initialOptions.color)}},{key:"_onBack",value:function u(){if(this._operationExistedBefore){this._operation.set(this._initialOptions)}else{this._ui.removeOperation("frames")}this._ui.canvas.render()}},{key:"_onThicknessUpdate",value:function p(x){this._operation.setThickness(x);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_onColorUpdate",value:function q(x){this._operation.setColor(x);this._ui.canvas.render();this._highlightDoneButton()}},{key:"_onDone",value:function s(){this._ui.addHistory(this._operation,{color:this._initialOptions.color,thickness:this._initialOptions.thickness},this._operationExistedBefore)}}]);return r})(l["default"]);f.prototype.identifier="frames";i["default"]=f;d.exports=i["default"]},function(c,i,b){Object.defineProperty(i,"__esModule",{value:true});var e=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();var k=function d(y,x,u){var v=true;_function:while(v){var s=y,A=x,r=u;t=z=w=undefined;v=false;var t=Object.getOwnPropertyDescriptor(s,A);if(t===undefined){var z=Object.getPrototypeOf(s);if(z===null){return undefined}else{y=z;x=A;u=r;v=true;continue _function}}else{if("value" in t){return t.value}else{var w=t.get;if(w===undefined){return undefined}return w.call(r)}}}};function p(r){return r&&r.__esModule?r:{"default":r}}function j(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}function o(s,r){if(typeof r!=="function"&&r!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof r)}s.prototype=Object.create(r&&r.prototype,{constructor:{value:s,enumerable:false,writable:true,configurable:true}});if(r){s.__proto__=r}}var g=b(93);var n=p(g);var h=b(50);var l=p(h);var f=b(6);var q=p(f);var m=(function(w){function u(){j(this,u);if(w!=null){w.apply(this,arguments)}}o(u,w);e(u,[{key:"init",value:function G(){var N=function(S){var R='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';for(var Q in S.stickers){R+=" ";var T=S.stickers[Q];R+=" ";var P=S.activeSticker===Q;R+=' <li data-identifier="'+(Q)+'"';if(P){R+=' class="imglykit-controls-item-active"'}R+=" style=\"background-image: url('"+(S.helpers.assetPath(T))+"');\"> </li> "}R+=" </ul></div>"+(S.partials.doneButton);return R};this._controlsTemplate=N;var O=function(Q){var P='<div class="imglykit-canvas-stickers-container"> <div class="imglykit-canvas-stickers"> <img class="imglykit-canvas-sticker-image" /> <div class="imglykit-knob"></div> </div></div>';return P};this._canvasControlsTemplate=O;this._availableStickers={};this._stickers={};this._addDefaultStickers();this.selectStickers(null)}},{key:"_addDefaultStickers",value:function B(){this.addSticker("glasses-nerd","stickers/sticker-glasses-nerd.png");this.addSticker("glasses-normal","stickers/sticker-glasses-normal.png");this.addSticker("glasses-shutter-green","stickers/sticker-glasses-shutter-green.png");this.addSticker("glasses-shutter-yellow","stickers/sticker-glasses-shutter-yellow.png");this.addSticker("glasses-sun","stickers/sticker-glasses-sun.png");this.addSticker("hat-cap","stickers/sticker-hat-cap.png");this.addSticker("hat-cylinder","stickers/sticker-hat-cylinder.png");this.addSticker("hat-party","stickers/sticker-hat-party.png");this.addSticker("hat-sheriff","stickers/sticker-hat-sheriff.png");this.addSticker("heart","stickers/sticker-heart.png");this.addSticker("mustache-long","stickers/sticker-mustache-long.png");this.addSticker("mustache1","stickers/sticker-mustache1.png");this.addSticker("mustache2","stickers/sticker-mustache2.png");this.addSticker("mustache3","stickers/sticker-mustache3.png");this.addSticker("pipe","stickers/sticker-pipe.png");this.addSticker("snowflake","stickers/sticker-snowflake.png");this.addSticker("star","stickers/sticker-star.png")}},{key:"addSticker",value:function H(N,O){this._availableStickers[N]=O;this._stickers[N]=this._availableStickers[N];if(this._active){this._renderControls()}}},{key:"selectStickers",value:function y(O){this._stickers={};var R=Object.keys(this._availableStickers);var N=q["default"].select(R,O);for(var Q=0;Q<N.length;Q++){var P=N[Q];this._stickers[P]=this._availableStickers[P]}if(this._active){this._renderControls()}}},{key:"_onEnter",value:function L(){var O=this;this._operationExistedBefore=!!this._ui.operations.stickers;this._operation=this._ui.getOrCreateOperation("stickers");this._ui.removeOperation("stickers");this._initialSettings={sticker:this._operation.getSticker(),position:this._operation.getPosition().clone(),size:this._operation.getSize().clone()};var N=this._ui.canvas.size;this._size=this._initialSettings.size.clone();this._position=this._initialSettings.position.clone().multiply(N);this._initialZoomLevel=this._ui.canvas.zoomLevel;this._ui.canvas.zoomToFit();this._container=this._canvasControls.querySelector(".imglykit-canvas-stickers");this._stickerImage=this._canvasControls.querySelector("img");this._stickerImage.addEventListener("load",function(){O._stickerSize=new l["default"](O._stickerImage.width,O._stickerImage.height);O._onStickerLoad()});this._knob=this._canvasControls.querySelector("div.imglykit-knob");this._onImageDown=this._onImageDown.bind(this);this._onImageDrag=this._onImageDrag.bind(this);this._onImageUp=this._onImageUp.bind(this);this._onKnobDown=this._onKnobDown.bind(this);this._onKnobDrag=this._onKnobDrag.bind(this);this._onKnobUp=this._onKnobUp.bind(this);this._handleListItems();this._handleImage();this._handleKnob()}},{key:"_handleListItems",value:function D(){var O=this;var P=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(P);var Q=function(S){var T=O._listItems[S];var R=T.dataset.identifier;T.addEventListener("click",function(){O._onListItemClick(T)});if(!O._operationExistedBefore&&S===0||O._operationExistedBefore&&O._stickers[R]===O._initialSettings.sticker){O._onListItemClick(T,false)}};for(var N=0;N<this._listItems.length;N++){Q(N)}}},{key:"_applySettings",value:function J(){var N=this._stickerSize.y/this._stickerSize.x;this._size.y=this._size.x*N;this._stickerImage.style.width=""+this._size.x+"px";this._stickerImage.style.height=""+this._size.y+"px";this._container.style.left=""+this._position.x+"px";this._container.style.top=""+this._position.y+"px"}},{key:"_onBack",value:function I(){if(this._operationExistedBefore){this._operation=this._ui.getOrCreateOperation("stickers");this._operation.set(this._initialSettings)}else{this._ui.removeOperation("stickers")}this._ui.canvas.setZoomLevel(this._initialZoomLevel)}},{key:"_onDone",value:function C(){var O=this._ui.canvas.size;var N=this._position.clone().divide(O);var P=this._size.clone().divide(O);this._ui.canvas.setZoomLevel(this._initialZoomLevel,false);this._operation=this._ui.getOrCreateOperation("stickers");this._operation.set({sticker:this._availableStickers[this._sticker],position:N,size:P});this._ui.canvas.render();this._ui.addHistory(this,{sticker:this._initialSettings.sticker,position:this._initialSettings.position.clone(),size:this._initialSettings.size.clone()},this._operationExistedBefore)}},{key:"_handleKnob",value:function t(){this._knob.addEventListener("mousedown",this._onKnobDown);this._knob.addEventListener("touchstart",this._onKnobDown)}},{key:"_onKnobDown",value:function K(N){N.preventDefault();this._initialMousePosition=q["default"].getEventPosition(N);this._initialSize=this._size.clone();document.addEventListener("mousemove",this._onKnobDrag);document.addEventListener("touchmove",this._onKnobDrag);document.addEventListener("mouseup",this._onKnobUp);document.addEventListener("touchend",this._onKnobUp)}},{key:"_onKnobDrag",value:function s(Q){Q.preventDefault();var R=q["default"].getEventPosition(Q);var P=R.clone().subtract(this._initialMousePosition);var N=this._initialSize.clone();var O=this._stickerImage.height/this._stickerImage.width;N.x+=P.x;N.y=N.x*O;this._size.copy(N);this._applySettings();this._highlightDoneButton()}},{key:"_onKnobUp",value:function F(){document.removeEventListener("mousemove",this._onKnobDrag);document.removeEventListener("touchmove",this._onKnobDrag);document.removeEventListener("mouseup",this._onKnobUp);document.removeEventListener("touchend",this._onKnobUp)}},{key:"_handleImage",value:function r(){this._stickerImage.addEventListener("mousedown",this._onImageDown);this._stickerImage.addEventListener("touchstart",this._onImageDown)}},{key:"_onImageDown",value:function A(N){N.preventDefault();this._initialMousePosition=q["default"].getEventPosition(N);this._initialPosition=this._position.clone();document.addEventListener("mousemove",this._onImageDrag);document.addEventListener("touchmove",this._onImageDrag);document.addEventListener("mouseup",this._onImageUp);document.addEventListener("touchend",this._onImageUp)}},{key:"_onImageDrag",value:function M(P){P.preventDefault();var Q=q["default"].getEventPosition(P);var O=Q.clone().subtract(this._initialMousePosition);var N=this._initialPosition.clone();N.add(O);this._position.copy(N);this._applySettings();this._highlightDoneButton()}},{key:"_onImageUp",value:function x(){document.removeEventListener("mousemove",this._onImageDrag);document.removeEventListener("touchmove",this._onImageDrag);document.removeEventListener("mouseup",this._onImageUp);document.removeEventListener("touchend",this._onImageUp)}},{key:"_onStickerLoad",value:function E(){this._size=new l["default"](this._stickerImage.width,this._stickerImage.height);if(typeof this._position==="undefined"){this._position=new l["default"](0,0)}this._applySettings()}},{key:"_onListItemClick",value:function z(Q){var N=arguments[1]===undefined?true:arguments[1];this._deactivateAllItems();var O=Q.dataset.identifier;var P=this._availableStickers[O];P=this._kit.getAssetPath(P);try{this._stickerImage.attributes.removeNamedItem("style")}catch(R){}this._sticker=O;this._stickerImage.src=P;Q.classList.add("imglykit-controls-item-active");if(N){this._highlightDoneButton()}}},{key:"_deactivateAllItems",value:function v(){for(var N=0;N<this._listItems.length;N++){var O=this._listItems[N];O.classList.remove("imglykit-controls-item-active")}}},{key:"context",get:function(){var N=k(Object.getPrototypeOf(u.prototype),"context",this);N.stickers=this._stickers;return N}}]);return u})(n["default"]);m.prototype.identifier="stickers";i["default"]=m;c.exports=i["default"]},function(d,s,g){Object.defineProperty(s,"__esModule",{value:true});var n=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var b=function q(A,z,w){var x=true;_function:while(x){var u=A,C=z,t=w;v=B=y=undefined;x=false;var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;w=t;x=true;continue _function}}else{if("value" in v){return v.value}else{var y=v.get;if(y===undefined){return undefined}return y.call(t)}}}};function c(t){return t&&t.__esModule?t:{"default":t}}function h(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function l(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){u.__proto__=t}}var p=g(93);var f=c(p);var j=g(102);var i=c(j);var k=g(50);var e=c(k);var r=g(6);var m=c(r);var o=(function(A){function P(){h(this,P);if(A!=null){A.apply(this,arguments)}}l(P,A);n(P,[{key:"init",value:function L(){var T=function(Z){var Y='<div> <ul class="imglykit-controls-list imgly-controls-list-with-buttons"> ';var X=Z.fonts;if(X){var aa,W=-1,V=X.length-1;while(W<V){aa=X[W+=1];Y+=' <li data-name="'+(aa.name)+'" data-weight="'+(aa.weight)+'" style="font-family: '+(aa.name)+"; font-weight: "+(aa.weight)+'">'+(aa.name.substr(0,2))+"</li> "}}Y+=' </ul></div><div class="imglykit-controls-button"> '+(Z.partials.fgColorPicker)+'</div><div class="imglykit-controls-button"> '+(Z.partials.bgColorPicker)+"</div>"+(Z.partials.doneButton);return Y};this._controlsTemplate=T;var U=function(W){var V='<div class="imglykit-canvas-text-container"> <div class="imglykit-canvas-text"> <div class="imglykit-crosshair"> <img src="'+(W.helpers.assetPath("ui/night/crosshair.png"))+'" /> </div> <div class="imglykit-canvas-text-textarea"> <textarea></textarea> <div class="imglykit-knob"></div> </div> </div></div>';return V};this._canvasControlsTemplate=U;this._partialTemplates.fgColorPicker=i["default"].template;this._partialTemplates.fgColorPicker.additionalContext={id:"imglykit-text-foreground-color-picker",label:"Foreground"};this._partialTemplates.bgColorPicker=i["default"].template;this._partialTemplates.bgColorPicker.additionalContext={id:"imglykit-text-background-color-picker",label:"Background"};this._fonts=[];this._addFonts()}},{key:"_onEnter",value:function Q(){var U=this;this._operationExistedBefore=!!this._ui.operations.text;this._operation=this._ui.getOrCreateOperation("text");this._ui.removeOperation("text");var T=this._ui.canvas.size;this._initialSettings={lineHeight:this._operation.getLineHeight(),fontSize:this._operation.getFontSize(),fontFamily:this._operation.getFontFamily(),fontWeight:this._operation.getFontWeight(),color:this._operation.getColor(),position:this._operation.getPosition(),text:this._operation.getText()||"",maxWidth:this._operation.getMaxWidth(),backgroundColor:this._operation.getBackgroundColor()};this._settings={lineHeight:this._initialSettings.lineHeight,fontSize:this._initialSettings.fontSize,fontFamily:this._initialSettings.fontFamily,fontWeight:this._initialSettings.fontWeight,color:this._initialSettings.color.clone(),position:this._initialSettings.position.clone().multiply(T),text:this._initialSettings.text,maxWidth:this._initialSettings.maxWidth*T.x,backgroundColor:this._initialSettings.backgroundColor.clone()};this._initialZoomLevel=this._ui.canvas.zoomLevel;this._container=this._canvasControls.querySelector(".imglykit-canvas-text");this._textarea=this._canvasControls.querySelector("textarea");this._textarea.focus();this._moveKnob=this._canvasControls.querySelector(".imglykit-crosshair");this._resizeKnob=this._canvasControls.querySelector(".imglykit-knob");if(this._operationExistedBefore){this._settings.position.x-=2;this._settings.position.y-=2}this._onTextareaKeyUp=this._onTextareaKeyUp.bind(this);this._onResizeKnobDown=this._onResizeKnobDown.bind(this);this._onResizeKnobDrag=this._onResizeKnobDrag.bind(this);this._onResizeKnobUp=this._onResizeKnobUp.bind(this);this._onMoveKnobDown=this._onMoveKnobDown.bind(this);this._onMoveKnobDrag=this._onMoveKnobDrag.bind(this);this._onMoveKnobUp=this._onMoveKnobUp.bind(this);this._onForegroundColorUpdate=this._onForegroundColorUpdate.bind(this);this._onBackgroundColorUpdate=this._onBackgroundColorUpdate.bind(this);this._initColorPickers();this._handleListItems();this._handleTextarea();this._handleResizeKnob();this._handleMoveKnob();setTimeout(function(){U._resizeTextarea()},1);this._ui.canvas.zoomToFit().then(function(){U._applySettings()})}},{key:"_initColorPickers",value:function w(){var U=this;var V=this._controls.querySelector("#imglykit-text-foreground-color-picker");this._foregroundColorPicker=new i["default"](this._ui,V);this._foregroundColorPicker.setValue(this._operation.getColor());this._foregroundColorPicker.on("update",this._onForegroundColorUpdate);this._foregroundColorPicker.on("show",function(){U._backgroundColorPicker.hide()});var T=this._controls.querySelector("#imglykit-text-background-color-picker");this._backgroundColorPicker=new i["default"](this._ui,T);this._backgroundColorPicker.setValue(this._operation.getBackgroundColor());this._backgroundColorPicker.on("update",this._onBackgroundColorUpdate);this._backgroundColorPicker.on("show",function(){U._foregroundColorPicker.hide()})}},{key:"_handleListItems",value:function J(){var U=this;var V=this._controls.querySelectorAll("li");this._listItems=Array.prototype.slice.call(V);var W=function(Y){var Z=U._listItems[Y];var X=Z.dataset.name;Z.addEventListener("click",function(){U._onListItemClick(Z)});if(!U._operationExistedBefore&&Y===0||U._operationExistedBefore&&X===U._initialSettings.fontFamily){U._onListItemClick(Z,false)}};for(var T=0;T<this._listItems.length;T++){W(T)}}},{key:"_handleTextarea",value:function C(){this._textarea.addEventListener("keyup",this._onTextareaKeyUp)}},{key:"_onTextareaKeyUp",value:function H(){this._resizeTextarea();this._settings.text=this._textarea.value;this._highlightDoneButton()}},{key:"_resizeTextarea",value:function v(){var W=this._textarea.scrollTop;if(!W){var V=undefined,T=undefined;do{V=this._textarea.scrollHeight;T=this._textarea.offsetHeight;this._textarea.style.height=""+(T-5)+"px"}while(V&&V!==this._textarea.scrollHeight)}var U=this._textarea.scrollHeight;this._textarea.style.height=""+(U+20)+"px"}},{key:"_handleMoveKnob",value:function y(){this._moveKnob.addEventListener("mousedown",this._onMoveKnobDown);this._moveKnob.addEventListener("touchstart",this._onMoveKnobDown)}},{key:"_onMoveKnobDown",value:function S(T){T.preventDefault();this._initialMousePosition=m["default"].getEventPosition(T);this._initialPosition=this._settings.position.clone();document.addEventListener("mousemove",this._onMoveKnobDrag);document.addEventListener("touchmove",this._onMoveKnobDrag);document.addEventListener("mouseup",this._onMoveKnobUp);document.addEventListener("tochend",this._onMoveKnobUp)}},{key:"_onMoveKnobDrag",value:function x(W){W.preventDefault();var U=this._ui.canvas.size;var aa=m["default"].getEventPosition(W);var V=aa.clone().subtract(this._initialMousePosition);var Z=new e["default"](0,0);var Y=new e["default"](this._container.offsetWidth,this._container.offsetHeight);var X=U.clone().subtract(Y);var T=this._initialPosition.clone().add(V).clamp(Z,X);this._settings.position=T;this._container.style.left=""+T.x+"px";this._container.style.top=""+T.y+"px"}},{key:"_onMoveKnobUp",value:function G(){document.removeEventListener("mousemove",this._onMoveKnobDrag);document.removeEventListener("touchmove",this._onMoveKnobDrag);document.removeEventListener("mouseup",this._onMoveKnobUp);document.removeEventListener("touchend",this._onMoveKnobUp)}},{key:"_handleResizeKnob",value:function K(){this._resizeKnob.addEventListener("mousedown",this._onResizeKnobDown);this._resizeKnob.addEventListener("touchstart",this._onResizeKnobDown)}},{key:"_onResizeKnobDown",value:function D(T){T.preventDefault();this._initialMousePosition=m["default"].getEventPosition(T);this._initialMaxWidth=this._settings.maxWidth;document.addEventListener("mousemove",this._onResizeKnobDrag);document.addEventListener("touchmove",this._onResizeKnobDrag);document.addEventListener("mouseup",this._onResizeKnobUp);document.addEventListener("touchend",this._onResizeKnobUp)}},{key:"_onResizeKnobDrag",value:function N(Y){Y.preventDefault();var U=this._ui.canvas.size;var Z=m["default"].getEventPosition(Y);var X=Z.subtract(this._initialMousePosition);var T=this._settings.position.clone();var V=U.x-T.x;var W=this._initialMaxWidth+X.x;W=Math.max(100,Math.min(V,W));this._settings.maxWidth=W;this._textarea.style.width=""+W+"px";this._resizeTextarea()}},{key:"_onResizeKnobUp",value:function t(){document.removeEventListener("mousemove",this._onResizeKnobDrag);document.removeEventListener("touchmove",this._onResizeKnobDrag);document.removeEventListener("mouseup",this._onResizeKnobUp);document.removeEventListener("touchend",this._onResizeKnobUp)}},{key:"_onForegroundColorUpdate",value:function R(T){this._settings.color=T;this._applySettings();this._highlightDoneButton()}},{key:"_onBackgroundColorUpdate",value:function u(T){this._settings.backgroundColor=T;this._applySettings();this._highlightDoneButton()}},{key:"_applySettings",value:function O(){var U=this._textarea;var W=this._settings;var T=this._ui.canvas.size;var V=W.fontSize*T.y;this._container.style.left=""+W.position.x+"px";this._container.style.top=""+W.position.y+"px";U.value=W.text;U.style.fontFamily=W.fontFamily;U.style.fontSize=""+V+"px";U.style.fontWeight=W.fontWeight;U.style.lineHeight=W.lineHeight;U.style.color=W.color.toRGBA();U.style.backgroundColor=W.backgroundColor.toRGBA();U.style.width=""+W.maxWidth+"px"}},{key:"_onListItemClick",value:function F(V){var T=arguments[1]===undefined?true:arguments[1];this._deactivateAllItems();var X=V.dataset;var U=X.name;var W=X.weight;this._settings.fontFamily=U;this._settings.fontWeight=W;this._applySettings();V.classList.add("imglykit-controls-item-active");if(T){this._highlightDoneButton()}}},{key:"_deactivateAllItems",value:function z(){for(var T=0;T<this._listItems.length;T++){var U=this._listItems[T];U.classList.remove("imglykit-controls-item-active")}}},{key:"_addFonts",value:function E(){this.addFont("Helvetica","normal");this.addFont("Lucida Grande","normal");this.addFont("Times New Roman","normal")}},{key:"addFont",value:function B(T,U){this._fonts.push({name:T,weight:U})}},{key:"_onDone",value:function I(){var U=this._ui.canvas.size;var V=new e["default"](2,2);var T=this._settings.position.clone().add(V).divide(U);this._ui.canvas.setZoomLevel(this._initialZoomLevel,false);this._operation=this._ui.getOrCreateOperation("text");this._operation.set({fontSize:this._settings.fontSize,fontFamily:this._settings.fontFamily,fontWeight:this._settings.fontWeight,color:this._settings.color,backgroundColor:this._settings.backgroundColor,position:T,text:this._settings.text,maxWidth:this._settings.maxWidth/U.x});this._ui.canvas.render();this._ui.addHistory(this,{fontFamily:this._initialSettings.fontFamily,fontWeight:this._initialSettings.fontWeight,color:this._initialSettings.color.clone(),backgroundColor:this._initialSettings.backgroundColor.clone(),position:this._initialSettings.position.clone(),text:this._initialSettings.text,maxWidth:this._initialSettings.maxWidth},this._operationExistedBefore)}},{key:"_onBack",value:function M(){if(this._operationExistedBefore){this._operation=this._ui.getOrCreateOperation("text");this._operation.set(this._initialSettings)}else{this._ui.removeOperation("text")}this._ui.canvas.setZoomLevel(this._initialZoomLevel)}},{key:"context",get:function(){var T=b(Object.getPrototypeOf(P.prototype),"context",this);T.fonts=this._fonts;return T}}]);return P})(f["default"]);o.prototype.identifier="text";s["default"]=o;d.exports=s["default"]},function(d,s,e){Object.defineProperty(s,"__esModule",{value:true});var n=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var b=function q(A,z,y){var w=true;_function:while(w){var u=A,C=z,t=y;v=B=x=undefined;w=false;var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;y=t;w=true;continue _function}}else{if("value" in v){return v.value}else{var x=v.get;if(x===undefined){return undefined}return x.call(t)}}}};function c(t){return t&&t.__esModule?t:{"default":t}}function g(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function l(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){u.__proto__=t}}var i=e(99);var k=c(i);var o=e(73);var h=c(o);var p=e(80);var j=c(p);var f=e(59);var m=c(f);var r=(function(D){function O(Q,R,P){g(this,O);b(Object.getPrototypeOf(O.prototype),"constructor",this).call(this);this._kit=Q;this._ui=R;this._operation=P;this._helpers=new k["default"](this._kit,this._ui,this._ui.options);this._partialTemplates={doneButton:function(T){var S='<div class="imglykit-controls-button imglykit-controls-done"> <img src="'+(T.helpers.assetPath("ui/night/buttons/done.png"))+'" /> <div class="imglykit-controls-done-highlighted"> <img src="'+(T.helpers.assetPath("ui/night/buttons/done-highlighted.png"))+'" /> </div></div>';return S}};this._template=function(T){var S='<div class="imglykit-controls-'+(T.identifier)+'"> <div class="imglykit-controls-button imglykit-controls-back"> <img src="'+(T.helpers.assetPath("ui/night/buttons/back.png"))+'" /> </div> '+(T.partials.control)+"</div>";return S};this._active=false;this.init()}l(O,D);n(O,[{key:"setContainers",value:function N(Q,P){this._controlsContainer=Q;this._canvasControlsContainer=P}},{key:"init",value:function G(){}},{key:"_renderAllControls",value:function t(){this._renderControls();this._renderCanvasControls();this._initScrollbar()}},{key:"_renderControls",value:function B(){if(typeof this._controlsTemplate==="undefined"){throw new Error("Control#_renderOverviewControls: Control needs to define this._controlsTemplate.")}var P=this._template(this._context);if(typeof this._controls!=="undefined"&&this._controls.parentNode!==null){this._controls.parentNode.removeChild(this._controls)}this._controls=document.createElement("div");this._controls.innerHTML=P;this._controlsContainer.appendChild(this._controls)}},{key:"_renderCanvasControls",value:function w(){if(typeof this._canvasControlsTemplate==="undefined"){return}var P=this._canvasControlsTemplate(this._context);this._canvasControls=document.createElement("div");this._canvasControls.innerHTML=P;this._canvasControlsContainer.appendChild(this._canvasControls)}},{key:"_initScrollbar",value:function A(){var P=this._controls.querySelector(".imglykit-controls-list");if(P){this._scrollbar=new j["default"](P.parentNode)}}},{key:"_removeControls",value:function u(){this._controls.parentNode.removeChild(this._controls);if(this._canvasControls){this._canvasControls.parentNode.removeChild(this._canvasControls)}if(this._scrollbar){this._scrollbar.remove()}}},{key:"_handleBackAndDoneButtons",value:function z(){this._backButton=this._controls.querySelector(".imglykit-controls-back");if(this._backButton){this._backButton.addEventListener("click",this._onBackButtonClick.bind(this))}this._doneButton=this._controls.querySelector(".imglykit-controls-done");if(this._doneButton){this._doneButton.addEventListener("click",this._onDoneButtonClick.bind(this))}}},{key:"_onBackButtonClick",value:function E(){this._onBack();this.emit("back")}},{key:"_onDoneButtonClick",value:function L(){this._onDone();this.emit("back")}},{key:"_highlightDoneButton",value:function v(){this._doneButton.classList.add("highlighted")}},{key:"enter",value:function J(){this._active=true;this._ui.hideZoom();this._renderAllControls();this._handleBackAndDoneButtons();this._enableCanvasControls();this._onEnter()}},{key:"leave",value:function x(){this._active=false;this._ui.showZoom();this._removeControls();this._disableCanvasControls();this._onLeave()}},{key:"_enableCanvasControls",value:function I(){this._canvasControlsContainer.classList.remove("imglykit-canvas-controls-disabled")}},{key:"_disableCanvasControls",value:function M(){this._canvasControlsContainer.classList.add("imglykit-canvas-controls-disabled")}},{key:"_onEnter",value:function K(){}},{key:"_onLeave",value:function y(){}},{key:"_onBack",value:function H(){}},{key:"_onDone",value:function C(){}},{key:"onZoom",value:function F(){}},{key:"_context",get:function(){var Q=this.context;Q=_.extend(Q,{helpers:this._helpers,identifier:this.identifier});Q.partials={};for(var P in this._partialTemplates){var S=this._partialTemplates[P];var R=_.extend({},Q,S.additionalContext||{});Q.partials[P]=S(R)}Q.partials.control=this._controlsTemplate(Q);return Q}},{key:"context",get:function(){return{}}}]);return O})(h["default"]);r.prototype.identifier=null;r.extend=m["default"];s["default"]=r;d.exports=s["default"]},function(c,b,d){c.exports=function(e){if(!e.webpackPolyfill){e.deprecate=function(){};e.paths=[];e.children=[];e.webpackPolyfill=1}return e}},function(d,c,g){Object.defineProperty(c,"__esModule",{value:true});var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";c["default"]={encode:function e(k){var h="",r=undefined,p=undefined,n="",q=undefined,o=undefined,m=undefined,l="",j=0;do{r=k[j++];p=k[j++];n=k[j++];q=r>>2;o=(r&3)<<4|p>>4;m=(p&15)<<2|n>>6;l=n&63;if(isNaN(p)){m=l=64}else{if(isNaN(n)){l=64}}h=h+b.charAt(q)+b.charAt(o)+b.charAt(m)+b.charAt(l);r=p=n="";q=o=m=l=""}while(j<k.length);return h},decode:function f(l){var s=undefined,q=undefined,o="",r=undefined,p=undefined,n=undefined,m="",k=0,j=[];var h=/[^A-Za-z0-9\+\/\=]/g;if(h.exec(l)){throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.")}l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{r=b.indexOf(l.charAt(k++));p=b.indexOf(l.charAt(k++));n=b.indexOf(l.charAt(k++));m=b.indexOf(l.charAt(k++));s=r<<2|p>>4;q=(p&15)<<4|n>>2;o=(n&3)<<6|m;j.push(s);if(n!==64){j.push(q)}if(m!==64){j.push(o)}s=q=o="";r=p=n=m=""}while(k<l.length);return j}};d.exports=c["default"]},function(d,i,c){Object.defineProperty(i,"__esModule",{value:true});var f=(function(){function p(t,r){for(var q=0;q<r.length;q++){var s=r[q];s.enumerable=s.enumerable||false;s.configurable=true;if("value" in s){s.writable=true}Object.defineProperty(t,s.key,s)}}return function(s,q,r){if(q){p(s.prototype,q)}if(r){p(s,r)}return s}})();var k=function e(w,v,s){var t=true;_function:while(t){var q=w,y=v,p=s;r=x=u=undefined;t=false;var r=Object.getOwnPropertyDescriptor(q,y);if(r===undefined){var x=Object.getPrototypeOf(q);if(x===null){return undefined}else{w=x;v=y;s=p;t=true;continue _function}}else{if("value" in r){return r.value}else{var u=r.get;if(u===undefined){return undefined}return u.call(p)}}}};function o(p){return p&&p.__esModule?p:{"default":p}}function j(p,q){if(!(p instanceof q)){throw new TypeError("Cannot call a class as a function")}}function n(q,p){if(typeof p!=="function"&&p!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof p)}q.prototype=Object.create(p&&p.prototype,{constructor:{value:q,enumerable:false,writable:true,configurable:true}});if(p){q.__proto__=p}}var h=c(50);var l=o(h);var b=c(73);var m=o(b);var g=(function(p){function v(H,G){j(this,v);k(Object.getPrototypeOf(v.prototype),"constructor",this).call(this);this._canvas=G||this.createCanvas();if(!G){this.setSize(H)}this._context=this._getContext();this._cache={}}n(v,p);f(v,[{key:"cache",value:function q(G){}},{key:"drawCached",value:function D(G){}},{key:"createCanvas",value:function y(K,H){var J=typeof window!=="undefined";var I;if(J){I=document.createElement("canvas")}else{var G=c(53);I=new G()}if(typeof K!=="undefined"){I.width=K}if(typeof H!=="undefined"){I.height=H}return I}},{key:"getSize",value:function F(){return new l["default"](this._canvas.width,this._canvas.height)}},{key:"setSize",value:function x(G){this._canvas.width=G.x;this._canvas.height=G.y}},{key:"_getContext",value:function r(){throw new Error("Renderer#_getContext is abstract and not implemented in inherited class.")}},{key:"resizeTo",value:function w(G){throw new Error("Renderer#resizeTo is abstract and not implemented in inherited class.")}},{key:"drawImage",value:function u(G){throw new Error("Renderer#drawImage is abstract and not implemented in inherited class.")}},{key:"renderFinal",value:function t(){}},{key:"getCanvas",value:function A(){return this._canvas}},{key:"getContext",value:function C(){return this._context}},{key:"setCanvas",value:function E(G){this._canvas=G;this._context=this._getContext();this.emit("new-canvas",this._canvas)}},{key:"setContext",value:function B(G){this._context=G}},{key:"reset",value:function z(){var G=arguments[0]===undefined?false:arguments[0]}},{key:"identifier",get:function(){return null}}],[{key:"isSupported",value:function s(){throw new Error("Renderer#isSupported is abstract and not implemented in inherited class.")}}]);return v})(m["default"]);i["default"]=g;d.exports=i["default"]},function(e,c,g){Object.defineProperty(c,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var b=(function(){function h(l){f(this,h);l=l||{};this._glslPrograms={};this._options=l}d(h,[{key:"render",value:function j(l){if(l.identifier==="webgl"){this.renderWebGL(l)}else{this.renderCanvas(l)}}},{key:"renderWebGL",value:function k(l){throw new Error("Primitive#renderWebGL is abstract and not implemented in inherited class.")}},{key:"renderCanvas",value:function i(l){throw new Error("Primitive#renderCanvas is abstract and not implemented in inherited class.")}},{key:"options",get:function(){return this._options}}]);return h})();c["default"]=b;e.exports=c["default"]},function(c,b,d){var e;(function(h,g){
/*!
	 * Native Promise Only
	 * v0.8.0-a (c) Kyle Simpson
	 * MIT License: http://getify.mit-license.org
	 * @license
	 */
"use strict";(function i(j,l,k){l[j]=l[j]||k();if(typeof c!="undefined"&&c.exports){c.exports=l[j]}else{if(true){!(e=function m(){return l[j]}.call(b,d,b,c),e!==undefined&&(c.exports=e))}}})("Promise",typeof h!="undefined"?h:undefined,function f(){var o,s,E,t=Object.prototype.toString,q=typeof g!="undefined"?function q(F){return g(F)}:setTimeout;try{Object.defineProperty({},"x",{});o=function o(H,G,I,F){return Object.defineProperty(H,G,{value:I,writable:true,configurable:F!==false})}}catch(n){o=function o(G,F,H){G[F]=H;return G}}E=(function C(){var K,I,H;function G(M,L){this.fn=M;this.self=L;this.next=void 0}return{add:function J(M,L){H=new G(M,L);if(I){I.next=H}else{K=H}I=H;H=void 0},drain:function F(){var L=K;K=I=s=void 0;while(L){L.fn.call(L.self);L=L.next}}}})();function A(G,F){E.add(G,F);if(!s){s=q(E.drain)}}function D(H){var G,F=typeof H;if(H!=null&&(F=="object"||F=="function")){G=H.then}return typeof G=="function"?G:false}function r(){for(var F=0;F<this.chain.length;F++){j(this,this.state===1?this.chain[F].success:this.chain[F].failure,this.chain[F])}this.chain.length=0}function j(G,F,I){var H,K;try{if(F===false){I.reject(G.msg)}else{if(F===true){H=G.msg}else{H=F.call(void 0,G.msg)}if(H===I.promise){I.reject(TypeError("Promise-chain cycle"))}else{if(K=D(H)){K.call(H,I.resolve,I.reject)}else{I.resolve(H)}}}}catch(J){I.reject(J)}}function w(I){var H,F=this;if(F.triggered){return}F.triggered=true;if(F.def){F=F.def}try{if(H=D(I)){A(function(){var K=new p(F);try{H.call(I,function M(){w.apply(K,arguments)},function J(){m.apply(K,arguments)})}catch(L){m.call(K,L)}})}else{F.msg=I;F.state=1;if(F.chain.length>0){A(r,F)}}}catch(G){m.call(new p(F),G)}}function m(G){var F=this;if(F.triggered){return}F.triggered=true;if(F.def){F=F.def}F.msg=G;F.state=2;if(F.chain.length>0){A(r,F)}}function u(J,G,I,H){for(var F=0;F<G.length;F++){(function K(L){J.resolve(G[L]).then(function M(N){I(L,N)},H)})(F)}}function p(F){this.def=F;this.triggered=false}function x(F){this.promise=F;this.state=0;this.triggered=false;this.chain=[];this.msg=void 0}function l(L){if(typeof L!="function"){throw TypeError("Not a function")}if(this.__NPO__!==0){throw TypeError("Not a promise")}this.__NPO__=1;var J=new x(this);this["then"]=function K(P,M){var O={success:typeof P=="function"?P:true,failure:typeof M=="function"?M:false};O.promise=new this.constructor(function N(R,Q){if(typeof R!="function"||typeof Q!="function"){throw TypeError("Not a function")}O.resolve=R;O.reject=Q});J.chain.push(O);if(J.state!==0){A(r,J)}return O.promise};this["catch"]=function G(M){return this.then(void 0,M)};try{L.call(void 0,function I(M){w.call(J,M)},function F(M){m.call(J,M)})}catch(H){m.call(J,H)}}var k=o({},"constructor",l,false);l.prototype=k;o(k,"__NPO__",0,false);o(l,"resolve",function z(G){var F=this;if(G&&typeof G=="object"&&G.__NPO__===1){return G}return new F(function H(J,I){if(typeof J!="function"||typeof I!="function"){throw TypeError("Not a function")}J(G)})});o(l,"reject",function B(F){return new this(function G(I,H){if(typeof I!="function"||typeof H!="function"){throw TypeError("Not a function")}H(F)})});o(l,"all",function v(F){var G=this;if(t.call(F)!="[object Array]"){return G.reject(TypeError("Not an array"))}if(F.length===0){return G.resolve([])}return new G(function H(M,L){if(typeof M!="function"||typeof L!="function"){throw TypeError("Not a function")}var I=F.length,K=Array(I),J=0;u(G,F,function N(O,P){K[O]=P;if(++J===I){M(K)}},L)})});o(l,"race",function y(F){var G=this;if(t.call(F)!="[object Array]"){return G.reject(TypeError("Not an array"))}return new G(function H(J,I){if(typeof J!="function"||typeof I!="function"){throw TypeError("Not a function")}u(G,F,function K(L,M){J(M)},I)})});return l})}.call(b,(function(){return this}()),d(103).setImmediate))},function(e,b,g){Object.defineProperty(b,"__esModule",{value:true});var d=(function(){function h(m,k){for(var j=0;j<k.length;j++){var l=k[j];l.enumerable=l.enumerable||false;l.configurable=true;if("value" in l){l.writable=true}Object.defineProperty(m,l.key,l)}}return function(k,i,j){if(i){h(k.prototype,i)}if(j){h(k,j)}return k}})();function f(h,i){if(!(h instanceof i)){throw new TypeError("Cannot call a class as a function")}}var c=(function(){function i(k,l,j){f(this,i);this._kit=k;this._ui=l;this._options=j}d(i,[{key:"assetPath",value:function h(j){var l=this._options.assetsUrl+"/"+j;var k=this._ui.options.ui.assetPathResolver;if(typeof k!=="undefined"){l=k(l)}return l}}]);return i})();b["default"]=c;e.exports=b["default"]},function(d,s,f){Object.defineProperty(s,"__esModule",{value:true});var o=(function(){function t(x,v){for(var u=0;u<v.length;u++){var w=v[u];w.enumerable=w.enumerable||false;w.configurable=true;if("value" in w){w.writable=true}Object.defineProperty(x,w.key,w)}}return function(w,u,v){if(u){t(w.prototype,u)}if(v){t(w,v)}return w}})();var b=function q(A,z,y){var w=true;_function:while(w){var u=A,C=z,t=y;v=B=x=undefined;w=false;var v=Object.getOwnPropertyDescriptor(u,C);if(v===undefined){var B=Object.getPrototypeOf(u);if(B===null){return undefined}else{A=B;z=C;y=t;w=true;continue _function}}else{if("value" in v){return v.value}else{var x=v.get;if(x===undefined){return undefined}return x.call(t)}}}};function c(t){return t&&t.__esModule?t:{"default":t}}function g(t,u){if(!(t instanceof u)){throw new TypeError("Cannot call a class as a function")}}function l(u,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}u.prototype=Object.create(t&&t.prototype,{constructor:{value:u,enumerable:false,writable:true,configurable:true}});if(t){u.__proto__=t}}var p=f(73);var h=c(p);var r=f(6);var n=c(r);var i=f(50);var e=c(i);var k=f(1);var m=c(k);var j=(function(t){function x(F,E){g(this,x);b(Object.getPrototypeOf(x.prototype),"constructor",this).call(this);this._element=F;this._options=m["default"].defaults(E,{minValue:0,maxValue:1,defaultValue:0});this._value=this._options.defaultValue;this._sliderElement=this._element.querySelector(".imglykit-slider-slider");this._dotElement=this._element.querySelector(".imglykit-slider-dot");this._centerDotElement=this._element.querySelector(".imglykit-slider-center-dot");this._fillElement=this._element.querySelector(".imglykit-slider-fill");this._backgroundElement=this._element.querySelector(".imglykit-slider-background");this._onMouseDown=this._onMouseDown.bind(this);this._onMouseMove=this._onMouseMove.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onCenterDotClick=this._onCenterDotClick.bind(this);this._onBackgroundClick=this._onBackgroundClick.bind(this);this._backgroundElement.addEventListener("click",this._onBackgroundClick);this._fillElement.addEventListener("click",this._onBackgroundClick);this._handleDot()}l(x,t);o(x,[{key:"setValue",value:function v(I){this._value=I;var E=this._options;var K=E.maxValue;var H=E.minValue;var J=K-H;var F=(I-H)/J;var G=this._sliderElement.offsetWidth;this._setX(G*F)}},{key:"_setX",value:function z(E){this._xPosition=E;this._dotElement.style.left=""+E+"px";var F=this._sliderElement.offsetWidth/2;var G=E-F;this._fillElement.style.width=""+Math.abs(G)+"px";if(G<0){this._fillElement.style.left=F-Math.abs(G)+"px"}else{this._fillElement.style.left=F+"px"}}},{key:"_handleDot",value:function w(){this._dotElement.addEventListener("mousedown",this._onMouseDown);this._dotElement.addEventListener("touchstart",this._onMouseDown);if(this._centerDotElement){this._centerDotElement.addEventListener("click",this._onCenterDotClick)}}},{key:"_onCenterDotClick",value:function A(){this.setValue(this._options.defaultValue);this.emit("update",this._value)}},{key:"_onBackgroundClick",value:function D(H){var E=n["default"].getEventPosition(H);var G=this._sliderElement.getBoundingClientRect();G=new e["default"](G.left,G.y);var F=E.clone().subtract(G);this._setX(F.x);this._updateValue()}},{key:"_onMouseDown",value:function B(G){if(G.type==="mousedown"&&G.button!==0){return}G.preventDefault();var H=n["default"].getEventPosition(G);document.addEventListener("mousemove",this._onMouseMove);document.addEventListener("touchmove",this._onMouseMove);document.addEventListener("mouseup",this._onMouseUp);document.addEventListener("touchend",this._onMouseUp);var F=this._dotElement.getBoundingClientRect();var E=this._sliderElement.getBoundingClientRect();this._initialSliderX=F.left-E.left;this._initialMousePosition=H}},{key:"_onMouseMove",value:function u(H){H.preventDefault();var J=n["default"].getEventPosition(H);var I=J.subtract(this._initialMousePosition);var G=this._dotElement.offsetWidth*0.5;var E=this._initialSliderX+I.x+G;var F=this._sliderElement.offsetWidth;E=Math.max(0,Math.min(E,F));this._setX(E);this._updateValue()}},{key:"_updateValue",value:function C(){var G=this._sliderElement.offsetWidth;var F=this._options;var I=F.minValue;var J=F.maxValue;var E=this._xPosition/G;var H=I+(J-I)*E;this.emit("update",H)}},{key:"_onMouseUp",value:function y(){document.removeEventListener("mousemove",this._onMouseMove);document.removeEventListener("touchmove",this._onMouseMove);document.removeEventListener("mouseup",this._onMouseUp);document.removeEventListener("touchend",this._onMouseUp)}}],[{key:"template",get:function(){return function(F){var E='<div class="imglykit-slider" id="'+((typeof F.id==="undefined"?"":F.id))+'"> <div class="imglykit-slider-minus"> <img src="'+(F.helpers.assetPath("ui/night/slider/minus.png"))+'" /> </div> <div class="imglykit-slider-slider"> <div class="imglykit-slider-content"> <div class="imglykit-slider-background"></div> <div class="imglykit-slider-fill"></div> <div class="imglykit-slider-center-dot"></div> <div class="imglykit-slider-dot"></div> </div> </div> <div class="imglykit-slider-plus"> <img src="'+(F.helpers.assetPath("ui/night/slider/plus.png"))+'" /> </div></div>';return E}}}]);return x})(h["default"]);s["default"]=j;d.exports=s["default"]},function(c,e,b){Object.defineProperty(e,"__esModule",{value:true});var d=(function(){function l(p,n){for(var m=0;m<n.length;m++){var o=n[m];o.enumerable=o.enumerable||false;o.configurable=true;if("value" in o){o.writable=true}Object.defineProperty(p,o.key,o)}}return function(o,m,n){if(m){l(o.prototype,m)}if(n){l(o,n)}return o}})();function k(l){return l&&l.__esModule?l:{"default":l}}function f(l,m){if(!(l instanceof m)){throw new TypeError("Cannot call a class as a function")}}function i(m,l){if(typeof l!=="function"&&l!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof l)}m.prototype=Object.create(l&&l.prototype,{constructor:{value:m,enumerable:false,writable:true,configurable:true}});if(l){m.__proto__=l}}var h=b(100);var g=k(h);var j=(function(n){function l(){f(this,l);if(n!=null){n.apply(this,arguments)}}i(l,n);d(l,[{key:"_setX",value:function m(o){this._xPosition=o;this._dotElement.style.left=""+o+"px";this._fillElement.style.width=""+o+"px"}}],[{key:"template",get:function(){return function(p){var o='<div class="imglykit-slider" id="'+((typeof p.id==="undefined"?"":p.id))+'"> <div class="imglykit-slider-minus"> <img src="'+(p.helpers.assetPath("ui/night/slider/minus.png"))+'" /> </div> <div class="imglykit-slider-slider"> <div class="imglykit-slider-content"> <div class="imglykit-slider-background"></div> <div class="imglykit-slider-fill"></div> <div class="imglykit-slider-dot"></div> </div> </div> <div class="imglykit-slider-plus"> <img src="'+(p.helpers.assetPath("ui/night/slider/plus.png"))+'" /> </div></div>';return o}}}]);return l})(g["default"]);e["default"]=j;c.exports=e["default"]},function(e,t,g){Object.defineProperty(t,"__esModule",{value:true});var o=(function(){function u(y,w){for(var v=0;v<w.length;v++){var x=w[v];x.enumerable=x.enumerable||false;x.configurable=true;if("value" in x){x.writable=true}Object.defineProperty(y,x.key,x)}}return function(x,v,w){if(v){u(x.prototype,v)}if(w){u(x,w)}return x}})();var c=function r(B,A,z){var x=true;_function:while(x){var v=B,D=A,u=z;w=C=y=undefined;x=false;var w=Object.getOwnPropertyDescriptor(v,D);if(w===undefined){var C=Object.getPrototypeOf(v);if(C===null){return undefined}else{B=C;A=D;z=u;x=true;continue _function}}else{if("value" in w){return w.value}else{var y=w.get;if(y===undefined){return undefined}return y.call(u)}}}};function d(u){return u&&u.__esModule?u:{"default":u}}function h(y,x){if(Array.isArray(y)){return y}else{if(Symbol.iterator in Object(y)){var B=[];var u=true;var A=false;var z=undefined;try{for(var w=y[Symbol.iterator](),C;!(u=(C=w.next()).done);u=true){B.push(C.value);if(x&&B.length===x){break}}}catch(v){A=true;z=v}finally{try{if(!u&&w["return"]){w["return"]()}}finally{if(A){throw z}}}return B}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}function j(u,v){if(!(u instanceof v)){throw new TypeError("Cannot call a class as a function")}}function m(v,u){if(typeof u!=="function"&&u!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof u)}v.prototype=Object.create(u&&u.prototype,{constructor:{value:v,enumerable:false,writable:true,configurable:true}});if(u){v.__proto__=u}}var p=g(73);var k=d(p);var s=g(6);var n=d(s);var q=g(7);var i=d(q);var l=g(50);var f=d(l);var b=(function(T){function u(Z,Y){j(this,u);c(Object.getPrototypeOf(u.prototype),"constructor",this).call(this);this._ui=Z;this._element=Y;this._visible=false;this._loaded=false;this._overlay=this._element.querySelector(".imglykit-color-picker-overlay");this._currentColorCanvas=this._element.querySelector(".imglykit-color-picker-color");this._alphaCanvas=this._element.querySelector("canvas.imglykit-color-picker-alpha");this._alphaKnob=this._element.querySelector(".imglykit-color-picker-alpha-container .imglykit-transparent-knob");this._hueCanvas=this._element.querySelector("canvas.imglykit-color-picker-hue");this._hueKnob=this._element.querySelector(".imglykit-color-picker-hue-container .imglykit-transparent-knob");this._saturationCanvas=this._element.querySelector("canvas.imglykit-color-picker-saturation");this._saturationKnob=this._element.querySelector(".imglykit-color-picker-saturation-container .imglykit-transparent-knob");this._transparencyImage=new Image();this._transparencyImage.src=Z.helpers.assetPath("ui/night/transparency.png");this._transparencyImage.addEventListener("load",this._onTransparencyImageLoad.bind(this));this._onAlphaCanvasDown=this._onAlphaCanvasDown.bind(this);this._onAlphaCanvasDrag=this._onAlphaCanvasDrag.bind(this);this._onAlphaCanvasUp=this._onAlphaCanvasUp.bind(this);this._onHueCanvasDown=this._onHueCanvasDown.bind(this);this._onHueCanvasDrag=this._onHueCanvasDrag.bind(this);this._onHueCanvasUp=this._onHueCanvasUp.bind(this);this._onSaturationCanvasDown=this._onSaturationCanvasDown.bind(this);this._onSaturationCanvasDrag=this._onSaturationCanvasDrag.bind(this);this._onSaturationCanvasUp=this._onSaturationCanvasUp.bind(this);this._onElementClick=this._onElementClick.bind(this);this._handleToggle();this._handleAlphaKnob();this._handleHueKnob();this._handleSaturationKnob()}m(u,T);o(u,[{key:"_onTransparencyImageLoad",value:function X(){this._loaded=true;this._render()}},{key:"_handleToggle",value:function z(){this._element.addEventListener("click",this._onElementClick)}},{key:"_onElementClick",value:function U(Y){if(Y.target===this._element||Y.target===this._currentColorCanvas){if(this._visible){this.hide();this.emit("hide")}else{this.show();this.emit("show")}}}},{key:"hide",value:function M(){this._overlay.classList.remove("imglykit-visible");this._visible=false}},{key:"show",value:function W(){this._overlay.classList.add("imglykit-visible");this._visible=true}},{key:"setValue",value:function A(ad){this._value=ad.clone();var ab=this._value.toHSV();var ac=h(ab,3);var aa=ac[0];var Z=ac[1];var Y=ac[2];this._hsvColor={h:aa,s:Z,v:Y};this._positionKnobs();this._render()}},{key:"_positionKnobs",value:function y(){this._positionAlphaKnob();this._positionHueKnob();this._positionSaturationKnob()}},{key:"_positionAlphaKnob",value:function I(){var Z=this._alphaCanvas;var Y=new f["default"](Z.width,Z.height);var aa=this._value.a*Y.x;this._alphaKnob.style.left=""+aa+"px"}},{key:"_positionHueKnob",value:function J(){var Z=this._hueCanvas;var Y=new f["default"](Z.width,Z.height);var aa=this._hsvColor.h*Y.y;this._hueKnob.style.top=""+aa+"px"}},{key:"_positionSaturationKnob",value:function D(){var Z=this._saturationCanvas;var Y=new f["default"](Z.width,Z.height);var ab=this._hsvColor.s*Y.x;this._saturationKnob.style.left=""+ab+"px";var aa=(1-this._hsvColor.v)*Y.y;this._saturationKnob.style.top=""+aa+"px"}},{key:"_render",value:function F(){if(!this._loaded){return}this._renderCurrentColor();this._renderAlpha();this._renderHue();this._renderSaturation()}},{key:"_renderCurrentColor",value:function G(){var Y=this._currentColorCanvas;var Z=Y.getContext("2d");var aa=Z.createPattern(this._transparencyImage,"repeat");Z.rect(0,0,Y.width,Y.height);Z.fillStyle=aa;Z.fill();Z.fillStyle=this._value.toRGBA();Z.fill()}},{key:"_renderAlpha",value:function H(){var Z=this._alphaCanvas;var aa=Z.getContext("2d");var ab=aa.createPattern(this._transparencyImage,"repeat");aa.rect(0,0,Z.width,Z.height);aa.fillStyle=ab;aa.fill();var ac=aa.createLinearGradient(0,0,Z.width,Z.height);var Y=this._value.clone();Y.a=0;ac.addColorStop(0,Y.toRGBA());ac.addColorStop(1,this._value.toHex());aa.fillStyle=ac;aa.fill()}},{key:"_renderHue",value:function w(){var Z=this._hueCanvas;var aa=Z.getContext("2d");var Y=new i["default"]();for(var ac=0;ac<Z.height;ac++){var ab=ac/Z.height;Y.fromHSV(ab,1,1);aa.strokeStyle=Y.toRGBA();aa.beginPath();aa.moveTo(0,ac);aa.lineTo(Z.width,ac);aa.stroke()}}},{key:"_renderSaturation",value:function x(){var ab=this._saturationCanvas;var aa=ab.getContext("2d");var Z=aa.getImageData(0,0,ab.width,ab.height);var ac=new i["default"](1,0,0,1);for(var ah=0;ah<ab.height;ah++){var ak=(ab.height-ah)/ab.height;for(var aj=0;aj<ab.width;aj++){var ad=aj/ab.width;ac.fromHSV(this._hsvColor.h,ad,ak);var Y=ac.r;var ae=ac.g;var ag=ac.b;var ai=ac.a;var af=(ah*ab.width+aj)*4;Z.data[af]=Y*255;Z.data[af+1]=ae*255;Z.data[af+2]=ag*255;Z.data[af+3]=ai*255}}aa.putImageData(Z,0,0)}},{key:"_handleAlphaKnob",value:function C(){this._alphaCanvas.addEventListener("mousedown",this._onAlphaCanvasDown);this._alphaCanvas.addEventListener("touchstart",this._onAlphaCanvasDown)}},{key:"_onAlphaCanvasDown",value:function S(Y){Y.preventDefault();this._onAlphaCanvasDrag(Y);document.addEventListener("mousemove",this._onAlphaCanvasDrag);document.addEventListener("touchmove",this._onAlphaCanvasDrag);document.addEventListener("mouseup",this._onAlphaCanvasUp);document.addEventListener("touchend",this._onAlphaCanvasUp)}},{key:"_onAlphaCanvasDrag",value:function v(ac){ac.preventDefault();var Z=this._alphaCanvas;var af=new f["default"](Z.width,Z.height);var ae=n["default"].getEventPosition(ac);var ag=Z.getBoundingClientRect();var aa=ag.left;var ad=ag.top;var ab=new f["default"](aa,ad);var Y=ae.subtract(ab);Y.clamp(new f["default"](0,0),af);this._alphaKnob.style.left=""+Y.x+"px";this._value.a=Y.x/af.x;this._updateColor()}},{key:"_onAlphaCanvasUp",value:function O(){document.removeEventListener("mousemove",this._onAlphaCanvasDrag);document.removeEventListener("touchmove",this._onAlphaCanvasDrag);document.removeEventListener("mouseup",this._onAlphaCanvasUp);document.removeEventListener("touchend",this._onAlphaCanvasUp)}},{key:"_handleHueKnob",value:function N(){this._hueCanvas.addEventListener("mousedown",this._onHueCanvasDown);this._hueCanvas.addEventListener("touchstart",this._onHueCanvasDown)}},{key:"_onHueCanvasDown",value:function E(Y){Y.preventDefault();this._onHueCanvasDrag(Y);document.addEventListener("mousemove",this._onHueCanvasDrag);document.addEventListener("touchmove",this._onHueCanvasDrag);document.addEventListener("mouseup",this._onHueCanvasUp);document.addEventListener("touchend",this._onHueCanvasUp)}},{key:"_onHueCanvasDrag",value:function Q(ad){ad.preventDefault();var Z=this._hueCanvas;var ag=new f["default"](Z.width,Z.height);var af=n["default"].getEventPosition(ad);var ab=Z.getBoundingClientRect();var aa=ab.left;var ae=ab.top;var ac=new f["default"](aa,ae);var Y=af.subtract(ac);Y.clamp(new f["default"](0,0),ag);this._hueKnob.style.top=""+Y.y+"px";Y.divide(ag);this._hsvColor.h=Y.y;this._updateColor()}},{key:"_onHueCanvasUp",value:function L(){document.removeEventListener("mousemove",this._onHueCanvasDrag);document.removeEventListener("touchmove",this._onHueCanvasDrag);document.removeEventListener("mouseup",this._onHueCanvasUp);document.removeEventListener("touchend",this._onHueCanvasUp)}},{key:"_handleSaturationKnob",value:function V(){this._saturationCanvas.addEventListener("mousedown",this._onSaturationCanvasDown);this._saturationCanvas.addEventListener("touchstart",this._onSaturationCanvasDown)}},{key:"_onSaturationCanvasDown",value:function B(Y){Y.preventDefault();this._onSaturationCanvasDrag(Y);document.addEventListener("mousemove",this._onSaturationCanvasDrag);document.addEventListener("touchmove",this._onSaturationCanvasDrag);document.addEventListener("mouseup",this._onSaturationCanvasUp);document.addEventListener("touchend",this._onSaturationCanvasUp)}},{key:"_onSaturationCanvasDrag",value:function P(ad){ad.preventDefault();var Z=this._saturationCanvas;var ag=new f["default"](Z.width,Z.height);var af=n["default"].getEventPosition(ad);var ab=Z.getBoundingClientRect();var aa=ab.left;var ae=ab.top;var ac=new f["default"](aa,ae);var Y=af.subtract(ac);Y.clamp(0,Z.width);this._saturationKnob.style.left=""+Y.x+"px";this._saturationKnob.style.top=""+Y.y+"px";Y.divide(ag);this._hsvColor.s=Y.x;this._hsvColor.v=1-Y.y;this._updateColor()}},{key:"_onSaturationCanvasUp",value:function R(){document.removeEventListener("mousemove",this._onSaturationCanvasDrag);document.removeEventListener("touchmove",this._onSaturationCanvasDrag);document.removeEventListener("mouseup",this._onSaturationCanvasUp);document.removeEventListener("touchend",this._onSaturationCanvasUp)}},{key:"_updateColor",value:function K(){this._value.fromHSV(this._hsvColor.h,this._hsvColor.s,this._hsvColor.v);this.emit("update",this._value);this._render()}}],[{key:"template",get:function(){return function(Z){var Y='<div class="imglykit-color-picker" id="'+((typeof Z.id==="undefined"?"":Z.id))+'"> <canvas class="imglykit-color-picker-color" width="34" height="34"></canvas> <div class="imglykit-controls-item-label">'+((typeof Z.label==="undefined"?"":Z.label))+'</div> <div class="imglykit-color-picker-overlay"> <div class="imglykit-color-picker-alpha-container"> <canvas class="imglykit-color-picker-alpha" width="200" height="30"></canvas> <div class="imglykit-transparent-knob"></div> </div> <div class="imglykit-color-picker-saturation-container"> <canvas class="imglykit-color-picker-saturation" width="160" height="160"></canvas> <div class="imglykit-transparent-knob"></div> </div> <div class="imglykit-color-picker-hue-container"> <canvas class="imglykit-color-picker-hue" width="30" height="160"></canvas> <div class="imglykit-transparent-knob"></div> </div> </div></div>';return Y}}}]);return u})(k["default"]);t["default"]=b;e.exports=t["default"]},function(c,b,d){(function(h,i){var k=d(104).nextTick;var e=Function.prototype.apply;var j=Array.prototype.slice;var l={};var f=0;b.setTimeout=function(){return new g(e.call(setTimeout,window,arguments),clearTimeout)};b.setInterval=function(){return new g(e.call(setInterval,window,arguments),clearInterval)};b.clearTimeout=b.clearInterval=function(m){m.close()};function g(n,m){this._id=n;this._clearFn=m}g.prototype.unref=g.prototype.ref=function(){};g.prototype.close=function(){this._clearFn.call(window,this._id)};b.enroll=function(m,n){clearTimeout(m._idleTimeoutId);m._idleTimeout=n};b.unenroll=function(m){clearTimeout(m._idleTimeoutId);m._idleTimeout=-1};b._unrefActive=b.active=function(m){clearTimeout(m._idleTimeoutId);var o=m._idleTimeout;if(o>=0){m._idleTimeoutId=setTimeout(function n(){if(m._onTimeout){m._onTimeout()}},o)}};b.setImmediate=typeof h==="function"?h:function(o){var p=f++;var n=arguments.length<2?false:j.call(arguments,1);l[p]=true;k(function m(){if(l[p]){if(n){o.apply(null,n)}else{o.call(null)}b.clearImmediate(p)}});return p};b.clearImmediate=typeof i==="function"?i:function(m){delete l[m]}}.call(b,d(103).setImmediate,d(103).clearImmediate))},function(d,f,c){var b=d.exports={};var g=[];var k=false;var h;var i=-1;function j(){k=false;if(h.length){g=h.concat(g)}else{i=-1}if(g.length){m()}}function m(){if(k){return}var o=setTimeout(j);k=true;var n=g.length;while(n){h=g;g=[];while(++i<n){h[i].run()}i=-1;n=g.length}h=null;k=false;clearTimeout(o)}b.nextTick=function(n){var o=new Array(arguments.length-1);if(arguments.length>1){for(var p=1;p<arguments.length;p++){o[p-1]=arguments[p]}}g.push(new e(n,o));if(g.length===1&&!k){setTimeout(m,0)}};function e(n,o){this.fun=n;this.array=o}e.prototype.run=function(){this.fun.apply(null,this.array)};b.title="browser";b.browser=true;b.env={};b.argv=[];b.version="";b.versions={};function l(){}b.on=l;b.addListener=l;b.once=l;b.off=l;b.removeListener=l;b.removeAllListeners=l;b.emit=l;b.binding=function(n){throw new Error("process.binding is not supported")};b.cwd=function(){return"/"};b.chdir=function(n){throw new Error("process.chdir is not supported")};b.umask=function(){return 0}}])});